#
namespace = human_fallen_empires_discovery


@tier1materialreward = 6
@tier1materialmin = 100
@tier1materialmax = 500
@tier2materialreward = 12
@tier2materialmin = 150
@tier2materialmax = 1000
@tier3materialreward = 18
@tier3materialmin = 250
@tier3materialmax = 1500
@tier4materialreward = 24
@tier4materialmin = 350
@tier4materialmax = 2000

@tier1influencereward = 6
@tier1influencemin = 40
@tier1influencemax = 100
@tier2influencereward = 12
@tier2influencemin = 80
@tier2influencemax = 175
@tier3influencereward = 18
@tier3influencemin = 125
@tier3influencemax = 250
@tier4influencereward = 24
@tier4influencemin = 150
@tier4influencemax = 300

@tier1researchreward = 6
@tier1researchmin = 60
@tier1researchmax = 150
@tier2researchreward = 12
@tier2researchmin = 90
@tier2researchmax = 250
@tier3researchreward = 18
@tier3researchmin = 120
@tier3researchmax = 350
@tier4researchreward = 24
@tier4researchmin = 150
@tier4researchmax = 500

# discovery
@human_fallen_empires_discovery_docking_update_minerals_cost = 300
@human_fallen_empires_discovery_docking_update_energy_cost = 300
@human_fallen_empires_discovery_docking_update_minerals_cost_minus = -300
@human_fallen_empires_discovery_docking_update_energy_cost_minus = -300
@human_fallen_empires_discovery_docking_update_minerals_dock_owner = 150
@human_fallen_empires_discovery_docking_update_energy_dock_owner = 150
@human_fallen_empires_discovery_contract_pirate_hunt_reward = 500
@human_fallen_empires_discovery_contract_pirate_hunt_reward_minus = -500
@human_fallen_empires_discovery_contract_embassy_reward = 100
@human_fallen_empires_discovery_contract_embassy_reward_minus = -100
@human_fallen_empires_discovery_kill_t0 = 50
@human_fallen_empires_discovery_kill_t1 = 100
@human_fallen_empires_discovery_kill_t2 = 150
@human_fallen_empires_discovery_kill_t3 = 200
@human_fallen_empires_discovery_kill_t4 = 1000
@human_fallen_empires_discovery_kill_energy = 75
@human_fallen_empires_discovery_kill_reward = 50
@human_fallen_empires_discovery_kill_reward_minus = -50


# discovery section
# install
country_event = {
	id = human_fallen_empires_discovery.0
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		has_country_flag = human_fallen_empires_discovery
	}

	immediate = {
		#set_country_type = human_fallen_empires_discovery
		set_country_flag = Story7
		modify_species = {
			species = this
			remove_trait = trait_pc_nuked_preference
			add_trait = trait_pc_continental_preference
			# ideal_planet_class = root
		}
		# change_dominant_species = last_created_species
		every_owned_fleet = {
			limit = {
				exists = leader
			}
			leader = {
				unassign_leader = this
			}
			destroy_fleet = this
		}
		capital_scope = {
			save_event_target_as = human_fallen_empires_discovery_start_location
			destroy_colony = yes
		}
		set_custom_capital_location = event_target:human_fallen_empires_discovery_start_location
		create_leader = {
			type = scientist
			species = this
			name = random
			skill = 0
		}
		# create_ship_design = {
		# 	design = Prototype
		# 	ftl = warp
		# }
		create_fleet = {
			name = "Science Ship"
			effect = {
				set_owner = prev
				create_ship = {
					name = random
					random_existing_design = science
				}
				assign_leader = last_created_leader
				set_location = event_target:human_fallen_empires_discovery_start_location
			}
		}
		create_leader = {
			type = admiral
			species = this
			name = random
			skill = 0
		}
		create_fleet = {
			name = Discovery
			effect = {
				set_owner = prev
				create_ship = {
					name = Discovery
					design = Deepvoid
				}
				last_created_ship = {
					set_ship_flag = human_fallen_empires_discovery_ship
				}
				assign_leader = last_created_leader
				set_location = event_target:human_fallen_empires_discovery_start_location
			}
		}
		#	create_ship_design = {
		#		design = Constructor
		#		ftl = warp
		#	}
		#	create_fleet = {
		#		name = Constructor
		#		effect = {
		#			set_owner = prevprev
		#			create_ship = {
		#				name = random
		#				design = last_created_design
		#			}
		#			set_location = prev
		#		}
		#	}
		every_owned_ship = {
			repair_ship = yes
			add_modifier = {
				modifier = human_fallen_empires_unkeep
				days = -1
			}
		}
		add_minerals = 500
		add_energy = 500
	}
}

# kill leaders for new agandas
country_event = {
	id = human_fallen_empires_discovery.1
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		has_country_flag = human_fallen_empires_discovery
	}

	immediate = {
		set_country_type = human_fallen_empires_discovery
		every_owned_leader = {
			#limit = {
			#	not = {
			#		leader_class = ruler
			#	}
			#}
			kill_leader = { show_notification = no }
		}
		#kill_leader = { type = ruler show_notification = no }
		while = {
			count = 4
			create_leader = {
				type = scientist
				species = this
				name = random
				skill = 0
			}
			assign_leader = last_created_leader
		}
	}
}

# discovery contact
country_event = {
	id = human_fallen_empires_discovery.50
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		# mods stuff auto contact with vanilla stuff
		or = {
			is_country_type = human_fallen_empires_discovery
			has_country_flag = human_fallen_empires_discovery
			is_country_type = human_fallen_empires_pirate
		}
		from = {
			or = {
				is_guardian_country = yes
				is_country_type = default
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
				is_country_type = nomad
				is_country_type = enclave
				# is_country_type = primitive
				# has own contact rule for default empires
				is_country_type = human_fallen_empire
				# pirates will know pirates, why not
				is_country_type = human_fallen_empires_pirate
			}
		}
	}

	immediate = {
		establish_communications = from
	}
}

# if discovery destroyed = end game
# This = owner of ship 1 (destroyed)
# From = owner of ship 2 (combatant)
# FromFrom = ship 1
# FromFromFrom = ship 2
country_event = {
	id = human_fallen_empires_discovery.51
	title = human_fallen_empires_discovery.51.name
	desc = human_fallen_empires_discovery.51.desc
	picture = GFX_evt_star_chart
	location = fromfrom
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		fromfrom = {
			has_ship_flag = human_fallen_empires_discovery_ship
		}
	}

	option = {
		name = human_fallen_empires_discovery.51.0
		hidden_effect = {
			destroy_country = yes
		}
	}
}

# creatures contact for discovery
country_event = {
	id = human_fallen_empires_discovery.52
	title = action.10.name
	desc = action.15.desc
	picture = GFX_evt_star_chart
	location = FROMFROMFROM
	is_triggered_only = yes

	trigger = {
		or = {
			is_country_type = human_fallen_empires_discovery
			has_country_flag = human_fallen_empires_discovery
		}
		from = {
			OR = {
				and = {
					is_country_type = amoeba
					not = {
						root = {
							has_country_flag = amoeba_encountered
						}
					}
				}
				and = {
					is_country_type = crystal
					not = {
						root = {
							has_country_flag = crystal_encountered
						}
					}
				}
				and = {
					is_country_type = drone
					not = {
						root = {
							has_country_flag = drone_encountered
						}
					}
				}
				and = {
					is_country_type = cloud
					not = {
						root = {
							has_country_flag = cloud_encountered
						}
					}
				}
				and = {
					is_country_type = tianki
					not = {
						root = {
							has_country_flag = cloud_encountered
						}
					}
				}
				and = {
					is_country_type = pirate
					not = {
						root = {
							has_country_flag = pirate_encountered
						}
					}
				}
			}
		}
	}

	immediate = {
		establish_communications = from # временное решение
		# придумать свои взаимодействия
	}

	option = {
		name = action.10.a
	}
}

# clear discovery war target flag after war end
country_event = {
	id = human_fallen_empires_discovery.53
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		has_country_flag = human_fallen_empires_discovery_war_target
	}

	immediate = {
		remove_country_flag = human_fallen_empires_discovery_war_target
		fromfrom = {
			random_war_participant = {
				limit = {
					is_country_type = human_fallen_empires_discovery
				}
				save_event_target_as = human_fallen_empires_discovery_country
			}
			every_war_participant = {
				limit = {
					has_country_flag = human_fallen_empires_discovery_war_target
					not = {
						is_at_war_with = event_target:human_fallen_empires_discovery_country
					}
				}
				remove_country_flag = human_fallen_empires_discovery_war_target
			}
		}
	}
}

# make default country if have planets, kill desovery ship
country_event = {
	id = human_fallen_empires_discovery.54
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		#	has_country_flag = human_fallen_empires_discovery
		is_country_type = human_fallen_empires_discovery
		num_owned_planets > 0
		num_pops > 0
	}

	immediate = {
		set_country_type = default
		random_owned_ship = {
			limit = {
				has_ship_flag = human_fallen_empires_discovery_ship
			}

		}
	}
}

# on_ship_destroyed_perp
# This = owner of ship 1 (combatant)
# From = owner of ship 2 (destroyed)
# FromFrom = ship 1
# FromFromFrom = ship 2

# harvest from frags for on_ship_destroyed_perp
country_event = {
	id = human_fallen_empires_discovery.100
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		exists = from
		exists = fromfrom
		exists = fromfromfrom
		fromfrom = {
			has_ship_flag = human_fallen_empires_discovery_ship
		}
	}

	immediate = {
		if = {
			limit = {
				not = {
					has_event_chain = human_fallen_empires_discovery_kill_count
				}
			}
			begin_event_chain = {
				event_chain = human_fallen_empires_discovery_kill_count
				target = root
			}
		}
		if = {
			limit = {
				fromfromfrom = {
					or = {
						is_ship_size = destroyer
						is_ship_size = military_station_small
						is_ship_size = small_ship_fallen_empire
						is_ship_size = nomad_destroyer
						is_ship_size = pirate_destroyer
						is_ship_size = military_station_small_ai
						is_ship_size = ancient_destroyer
						is_ship_size = crystal_ship_small_blue
						is_ship_size = crystal_ship_small_green
						is_ship_size = crystal_ship_small_yellow
						is_ship_size = crystal_ship_small_red
						is_ship_size = crystal_ship_small_blue_elite
						is_ship_size = crystal_ship_small_green_elite
						is_ship_size = crystal_ship_small_yellow_elite
						is_ship_size = crystal_ship_small_red_elite
					}
				}
			}
			add_minerals = @human_fallen_empires_discovery_kill_t1
			add_event_chain_counter = {
				event_chain = human_fallen_empires_discovery_kill_count
				counter = human_fallen_empires_discovery_kill_count_t1
				amount = 1
			}
			else = {
				if = {
					limit = {
						fromfromfrom = {
							or = {
								is_ship_size = cruiser
								is_ship_size = military_station_medium
								is_ship_size = military_station_small_fallen_empire
								is_ship_size = pirate_cruiser
								is_ship_size = pirate_station
								is_ship_size = space_amoeba_mother
								is_ship_size = crystal_ship_medium_blue
								is_ship_size = crystal_ship_medium_green
								is_ship_size = crystal_ship_medium_yellow
								is_ship_size = crystal_ship_medium_red
								is_ship_size = crystal_ship_medium_blue_elite
								is_ship_size = crystal_ship_medium_green_elite
								is_ship_size = crystal_ship_medium_yellow_elite
								is_ship_size = crystal_ship_medium_red_elite
							}
						}
					}
					add_minerals = @human_fallen_empires_discovery_kill_t2
					add_event_chain_counter = {
						event_chain = human_fallen_empires_discovery_kill_count
						counter = human_fallen_empires_discovery_kill_count_t2
						amount = 1
					}
					else = {
						if = {
							limit = {
								fromfromfrom = {
									or = {
										is_ship_size = battleship
										is_ship_size = military_station_large
										is_ship_size = large_ship_fallen_empire
										is_ship_size = military_station_large_fallen_empire
										is_ship_size = large_ship_ai
										is_ship_size = military_station_large_ai
										is_ship_size = crystal_ship_large_blue
										is_ship_size = crystal_ship_large_green
										is_ship_size = crystal_ship_large_yellow
										is_ship_size = crystal_ship_large_red
										is_ship_size = crystal_ship_large_blue_elite
										is_ship_size = crystal_ship_large_green_elite
										is_ship_size = crystal_ship_large_yellow_elite
										is_ship_size = crystal_ship_large_red_elite
										is_ship_size = orbital_station
									}
								}
							}
							add_minerals = @human_fallen_empires_discovery_kill_t3
							add_event_chain_counter = {
								event_chain = human_fallen_empires_discovery_kill_count
								counter = human_fallen_empires_discovery_kill_count_t3
								amount = 1
							}
							else = {
								if = {
									limit = {
										fromfromfrom = {
											or = {
												is_ship_size = massive_ship_fallen_empire
												is_ship_size = core_ai
												is_ship_size = crystal_station_large
												is_ship_size = asteroid
											}
										}
									}
									add_minerals = @human_fallen_empires_discovery_kill_t4
									add_event_chain_counter = {
										event_chain = human_fallen_empires_discovery_kill_count
										counter = human_fallen_empires_discovery_kill_count_t4
										amount = 1
									}
									else = {
										add_minerals = @human_fallen_empires_discovery_kill_t0
										add_event_chain_counter = {
											event_chain = human_fallen_empires_discovery_kill_count
											counter = human_fallen_empires_discovery_kill_count_t0
											amount = 1
										}
									}
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				from = {
					has_country_flag = human_fallen_empires_discovery_war_target
				}
				any_country = {
					is_at_war_with = from
					energy > 10
				}
			}
			if = {
				limit = {
					fromfromfrom = {
						is_ship_size = corvette
					}
				}
				random_country = {
					limit = {
						is_at_war_with = from
						energy > 10
					}
					add_energy = -10
					root = {
						add_energy = 10
						add_event_chain_counter = {
							event_chain = human_fallen_empires_discovery_kill_count
							counter = human_fallen_empires_discovery_kill_count_reward
							amount = 1
						}
					}
				}
				if = {
					limit = {
						fromfromfrom = {
							or = {
								is_ship_size = destroyer
								is_ship_size = military_station_small
								is_ship_size = small_ship_fallen_empire
							}
						}
					}
					random_country = {
						limit = {
							is_at_war_with = from
							energy > 100
						}
						add_energy = -100
						root = {
							add_energy = 100
							add_event_chain_counter = {
								event_chain = human_fallen_empires_discovery_kill_count
								counter = human_fallen_empires_discovery_kill_count_reward
								amount = 1
							}
						}
					}
					else = {
						if = {
							limit = {
								fromfromfrom = {
									or = {
										is_ship_size = cruiser
										is_ship_size = military_station_medium
										is_ship_size = military_station_small_fallen_empire
									}
								}
							}
							random_country = {
								limit = {
									is_at_war_with = from
									energy > 150
								}
								add_energy = -150
								root = {
									add_energy = 150
									add_event_chain_counter = {
										event_chain = human_fallen_empires_discovery_kill_count
										counter = human_fallen_empires_discovery_kill_count_reward
										amount = 1
									}
								}
							}
							else = {
								if = {
									limit = {
										fromfromfrom = {
											or = {
												is_ship_size = battleship
												is_ship_size = military_station_large
												is_ship_size = orbital_station
												is_ship_size = large_ship_fallen_empire
												is_ship_size = military_station_large_fallen_empire
											}
										}
									}
									random_country = {
										limit = {
											is_at_war_with = from
											energy > 200
										}
										add_energy = -200
										root = {
											add_energy = 200
											add_event_chain_counter = {
												event_chain = human_fallen_empires_discovery_kill_count
												counter = human_fallen_empires_discovery_kill_count_reward
												amount = 1
											}
										}
									}
									else = {
										if = {
											limit = {
												fromfromfrom = {
													is_ship_size = massive_ship_fallen_empire
												}
											}
											random_country = {
												limit = {
													is_at_war_with = from
													energy > 1000
												}
												add_energy = -1000
												root = {
													add_energy = 1000
													add_event_chain_counter = {
														event_chain = human_fallen_empires_discovery_kill_count
														counter = human_fallen_empires_discovery_kill_count_reward
														amount = 1
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				from = {
					or = {
						is_country_type = cloud
						is_country_type = extradimensional
						is_country_type = extradimensional_2
						is_country_type = extradimensional_3
					}
				}
			}
			add_energy = @human_fallen_empires_discovery_kill_energy
			add_event_chain_counter = {
				event_chain = human_fallen_empires_discovery_kill_count
				counter = human_fallen_empires_discovery_kill_count_energy
				amount = 1
			}
		}
		fromfrom = {
			solar_system = {
				if = {
					limit = {
						exists = space_owner
						exists = from
						space_owner = {
							energy > @human_fallen_empires_discovery_kill_reward
							nor = {
								is_country = root
								is_hostile = root
								is_country = from
							}
							is_hostile = from
						}
					}
					space_owner = {
						add_opinion_modifier = {
							who = root
							modifier = human_fallen_empires_option_discovery_kill_enemy
						}
						add_energy = @human_fallen_empires_discovery_kill_reward
						root = {
							add_energy = @human_fallen_empires_discovery_kill_reward
							add_event_chain_counter = {
								event_chain = human_fallen_empires_discovery_kill_count
								counter = human_fallen_empires_discovery_kill_count_reward
								amount = 1
							}
						}
					}
				}
			}
		}
	}
}

# kill check for contract pirate hunt for on_ship_destroyed_perp
country_event = {
	id = human_fallen_empires_discovery.101
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		has_event_chain = human_fallen_empires_discovery_contract_pirate_hunt
		exists = fromfromfrom
		fromfromfrom = {
			is_ship_size = orbital_station
			fleet = {
				has_fleet_flag = human_fallen_empires_discovery_pirate_hunt_target
			}
		}
	}

	immediate = {
		end_event_chain = human_fallen_empires_discovery_contract_pirate_hunt
		random_country = {
			limit = {
				has_relation_flag = {
					who = root
					flag = human_fallen_empires_discovery_contract_pirate_hunt_hirer
				}
			}
			add_energy = @human_fallen_empires_discovery_contract_pirate_hunt_reward_minus
			log = "321"
		}
		add_energy = @human_fallen_empires_discovery_contract_pirate_hunt_reward
	}
}

# kill check for contract clear system for on_ship_destroyed_perp
country_event = {
	id = human_fallen_empires_discovery.102
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		has_event_chain = human_fallen_empires_discovery_contract_clear_system
		exists = fromfromfrom
		fromfromfrom = {
			solar_system = {
				has_star_flag = human_fallen_empires_discovery_contract_clear_system_target
				not = {
					any_ship_in_system = {
						exists = owner
						owner = {
							is_hostile = root
						}
					}
				}
			}
		}
	}

	immediate = {
		end_event_chain = human_fallen_empires_discovery_contract_clear_system
		fromfromfrom = {
			solar_system = {
				remove_star_flag = human_fallen_empires_discovery_contract_clear_system_target
			}
		}
	}
}

# check enemys in target system, for on_entering_system
ship_event = {
	id = human_fallen_empires_discovery.103
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_discovery
			has_event_chain = human_fallen_empires_discovery_contract_clear_system
		}
		exists = from
		from = {
			has_star_flag = human_fallen_empires_discovery_contract_clear_system_target
			not = {
				any_ship_in_system = {
					exists = owner
					owner = {
						is_hostile = root.owner
					}
				}
			}
		}
	}

	immediate = {
		owner = {
			end_event_chain = human_fallen_empires_discovery_contract_clear_system
		}
		from = {
			remove_star_flag = human_fallen_empires_discovery_contract_clear_system_target
		}
	}
}

# trade and update on planet
# from = docking planet
fleet_event = {
	id = human_fallen_empires_discovery.150
	show_sound = event_airlock
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_ship_size = human_fallen_empires_deepvoid
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_discovery
		}
		from = {
			exists = owner
			has_spaceport = yes
			owner = {
				is_country_type = default
				not = {
					is_hostile = root.owner
				}
			}
		}
	}

	immediate = {
		from = {
			save_event_target_as = human_fallen_empires_discovery_docking_planet
			owner = {
				save_event_target_as = human_fallen_empires_discovery_docking_planet_owner
			}
		}
		random_owned_ship = {
			limit = {
				has_ship_flag = human_fallen_empires_discovery_ship
			}
			save_event_target_as = human_fallen_empires_discovery_docking_ship
		}
		if = {
			limit = {
				from = {
					has_planet_flag = human_fallen_empires_discovery_contract_embassy_target
				}
				owner = {
					has_event_chain = human_fallen_empires_discovery_contract_embassy
				}
			}
			from = {
				remove_planet_flag = human_fallen_empires_discovery_contract_embassy_target
			}
			owner = {
				random_country = {
					limit = {
						has_relation_flag = {
							who = root.owner
							flag = human_fallen_empires_discovery_contract_embassy_hirer
						}
					}
					save_event_target_as = human_fallen_empires_discovery_contract_embassy_hirer
					add_energy = @human_fallen_empires_discovery_contract_embassy_reward_minus
					log = "embassy reward minus"
				}
				random_list = {
					1 = {
						set_timed_country_flag = { flag = human_fallen_empires_discovery_contract_embassy_success days = 1 }
						event_target:human_fallen_empires_discovery_contract_embassy_hirer = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_docking_planet_owner
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_success
							}
						}
						event_target:human_fallen_empires_discovery_docking_planet_owner = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_contract_embassy_hirer
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_success
							}
						}
					}
					1 = {
						set_timed_country_flag = { flag = human_fallen_empires_discovery_contract_embassy_fail days = 1 }
						event_target:human_fallen_empires_discovery_contract_embassy_hirer = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_docking_planet_owner
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_fail
							}
						}
						event_target:human_fallen_empires_discovery_docking_planet_owner = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_contract_embassy_hirer
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_fail
							}
						}
					}
				}
				end_event_chain = human_fallen_empires_discovery_contract_embassy
				add_energy = @human_fallen_empires_discovery_contract_embassy_reward
			}
		}
		owner = {
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
}

# discovery docking menu
country_event = {
	id = human_fallen_empires_discovery.151
	title = human_fallen_empires_discovery.151.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires_discovery.151.desc.0.0
				#	text = human_fallen_empires_discovery.151.desc.0.1
				human_fallen_empires_trigger_discovery_docking_any_menu = no
			}
			success_text = {
				text = human_fallen_empires_discovery.151.weapon_menu.desc.0
				has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			}
			success_text = {
				text = human_fallen_empires_discovery.151.defense_menu.desc.0
				has_country_flag = human_fallen_empires_discovery.151.defense_menu
			}
			success_text = {
				text = human_fallen_empires_discovery.151.engine_menu.desc.0
				has_country_flag = human_fallen_empires_discovery.151.engine_menu
			}
			success_text = {
				text = human_fallen_empires_discovery.151.other_menu.desc.0
				has_country_flag = human_fallen_empires_discovery.151.other_menu
			}
			success_text = {
				text = human_fallen_empires_discovery.151.crew_menu.desc.0
				has_country_flag = human_fallen_empires_discovery.151.crew_menu
			}
			success_text = {
				text = human_fallen_empires_discovery.151.contract_menu.desc.0
				has_country_flag = human_fallen_empires_discovery.151.contract_menu
			}
			# quests
			# no quest
			success_text = {
				text = human_fallen_empires_discovery.151.1.0
				human_fallen_empires_trigger_discovery_docking_any_menu = no
				human_fallen_empires_trigger_discovery_docking_any_quest = no
			}
			# embassy
			# embassy success
			success_text = {
				text = human_fallen_empires_discovery.151.contract_menu.desc.1.0
				human_fallen_empires_trigger_discovery_docking_any_menu = no
				has_country_flag = human_fallen_empires_discovery_contract_embassy_success
			}
			# embassy fail
			success_text = {
				text = human_fallen_empires_discovery.151.contract_menu.desc.1.1
				human_fallen_empires_trigger_discovery_docking_any_menu = no
				has_country_flag = human_fallen_empires_discovery_contract_embassy_fail
			}
		}
	}
	location = root
	is_triggered_only = yes
	diplomatic = yes
	#force_open = yes что это значит?

	picture_event_data = {
		room = human_fallen_empires_docking_room
	}

	# update weapons menu
	option = {
		name = human_fallen_empires_discovery.151.0
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires_discovery.151.weapon_menu
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
	# damage lvl 1
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.0.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = 300
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 2
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.0.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 3
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.0.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 4
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.0.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 5
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.0.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 6
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.0.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.0.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 1
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.1.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.1.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 2
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.1.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.1.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 3
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.1.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.1.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 4
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.1.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.1.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 5
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.1.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.1.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 6
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.1.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.1.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 1
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.2.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.2.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 2
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.2.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.2.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 3
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.2.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.2.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 4
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.2.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.2.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 5
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.2.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.2.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 6
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.2.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.2.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 1
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.3.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.3.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 2
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.3.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.3.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 3
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.3.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.3.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 4
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.3.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.3.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 5
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.3.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.3.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 6
	option = {
		name = human_fallen_empires_discovery.151.weapon_menu.3.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.3.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# update defenses menu
	option = {
		name = human_fallen_empires_discovery.151.1
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires_discovery.151.defense_menu
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
	# hp lvl 1
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.0.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 2
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.0.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 3
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.0.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 4
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.0.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 5
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.0.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 6
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.0.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				custom_tooltip_fail = {
					text = human_fallen_empires_discovery.151.fail_already_installed
					event_target:human_fallen_empires_discovery_docking_ship = {
						not = {
							has_modifier = human_fallen_empires_discovery_hp_6
						}
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				custom_tooltip_fail = {
					text = human_fallen_empires_discovery.151.fail_already_installed
					event_target:human_fallen_empires_discovery_docking_ship = {
						not = {
							has_modifier = human_fallen_empires_discovery_hp_6
						}
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.0.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 1
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.1.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.1.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 2
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.1.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.1.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 3
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.1.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.1.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 4
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.1.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.1.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 5
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.1.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.1.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 6
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.1.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.1.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 1
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.2.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.2.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 2
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.2.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.2.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 3
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.2.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.2.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 4
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.2.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.2.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 5
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.2.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.defense_menu.2.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 6
	option = {
		name = human_fallen_empires_discovery.151.defense_menu.2.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.weapon_menu.3.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# update engine menu
	option = {
		name = human_fallen_empires_discovery.151.2
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires_discovery.151.engine_menu
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
	# subspase speed lvl 1
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 2
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 3
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 4
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 5
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 6
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.0.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 1
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.1.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.1.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 2
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.1.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.1.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 3
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.1.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.1.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 4
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.1.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.1.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 5
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.1.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.1.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 6
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.1.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.1.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 1
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.2.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.2.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 2
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.2.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.2.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 3
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.2.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.2.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 4
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.2.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.2.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 5
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.2.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.2.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}

	# inerstellar speed lvl 6
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.2.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.2.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 1
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.3.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.3.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 2
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.3.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.3.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 3
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.3.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.3.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 4
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.3.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.3.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 5
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.3.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.3.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 6
	option = {
		name = human_fallen_empires_discovery.151.engine_menu.3.5
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.3.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# other menu
	option = {
		name = human_fallen_empires_discovery.151.3
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires_discovery.151.other_menu
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
	option = {
		name = human_fallen_empires_discovery.151.other_menu.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.other_menu
		}
		allow = {
			minerals > 100
			energy > 100
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.other_menu.0.response

		add_minerals = -100
		add_energy = -100
		create_ship_design = {
			design = Prototype
			ftl = warp
		}
		create_fleet = {
			name = "Science Ship"
			effect = {
				set_owner = event_target:human_fallen_empires_discovery_docking_ship.owner
				create_ship = {
					name = random
					design = last_created_design
				}
				set_location = event_target:human_fallen_empires_discovery_docking_ship
			}
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# crew menu
	option = {
		name = human_fallen_empires_discovery.151.crew_menu
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.other_menu
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_discovery.151.other_menu
			set_country_flag = human_fallen_empires_discovery.151.crew_menu
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
	# crew lvl 1
	option = {
		name = human_fallen_empires_discovery.151.crew_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.crew_menu
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_1
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 200
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_1
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.1.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_1
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew lvl 2
	option = {
		name = human_fallen_empires_discovery.151.crew_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.crew_menu
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 200
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.2.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_2
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew lvl 3
	option = {
		name = human_fallen_empires_discovery.151.crew_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.crew_menu
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 200
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.3.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_3
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew lvl 4
	option = {
		name = human_fallen_empires_discovery.151.crew_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.crew_menu
			not = {
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 100
			not = {
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.4.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_4
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew freeze
	option = {
		name = human_fallen_empires_discovery.151.crew_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.crew_menu
		}
		allow = {
			energy > 100
			or = {
				has_modifier = human_fallen_empires_discovery_crew_1
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.engine_menu.0.4.response

		add_energy = -200
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_1
			}
			remove_modifier = human_fallen_empires_discovery_crew_1
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_2
			}
			remove_modifier = human_fallen_empires_discovery_crew_2
			add_modifier = {
				modifier = human_fallen_empires_discovery_crew_1
				days = -1
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_3
			}
			remove_modifier = human_fallen_empires_discovery_crew_3
			add_modifier = {
				modifier = human_fallen_empires_discovery_crew_2
				days = -1
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_4
			}
			remove_modifier = human_fallen_empires_discovery_crew_4
			add_modifier = {
				modifier = human_fallen_empires_discovery_crew_3
				days = -1
			}
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# contract menu
	option = {
		name = human_fallen_empires_discovery.151.contract_menu
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires_discovery.151.contract_menu
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
	# pirate hunt contract
	option = {
		name = human_fallen_empires_discovery.151.contract_menu.0
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.contract_menu
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				has_country_flag = human_fallen_empires_attacked_by_pirate
			}
		}
		allow = {
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_has_contract_pirate_hunt
				not = {
					has_event_chain = human_fallen_empires_discovery_contract_pirate_hunt
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.contract_menu.0.response

		begin_event_chain = {
			event_chain = human_fallen_empires_discovery_contract_pirate_hunt
			target = root
		}
		hidden_effect = {
			event_target:human_fallen_empires_discovery_docking_planet = {
				owner = {
					save_event_target_as = human_fallen_empires_discovery_pirate_hunt_hirer
					set_relation_flag = {
						who = root
						flag = human_fallen_empires_discovery_contract_pirate_hunt_hirer
					}
				}
				closest_system = {
					limit = {
						any_planet = {
							exists = owner
							owner = {
								is_country_type = human_fallen_empires_pirate
							}
						}
					}
					every_fleet_in_system = {
						limit = {
							is_ship_size = orbital_station
						}
						set_fleet_flag = human_fallen_empires_discovery_pirate_hunt_target
					}
					random_system_planet = {
						limit = {
							exists = owner
							owner = {
								is_country_type = human_fallen_empires_pirate
							}
						}
						save_event_target_as = human_fallen_empires_discovery_pirate_hunt_target
					}
				}
			}
			create_point_of_interest = {
				id = human_fallen_empires_discovery_pirate_hunt_point.0
				name = human_fallen_empires_discovery_contract_pirate_hunt.name
				desc = human_fallen_empires_discovery_contract_pirate_hunt.desc
				event_chain = human_fallen_empires_discovery_contract_pirate_hunt
				location = event_target:human_fallen_empires_discovery_pirate_hunt_target
			}
		}
	}
	# contract embassy mission
	option = {
		name = human_fallen_empires_discovery.151.contract_menu.1
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.contract_menu
			any_country = {
				or = {
					is_hostile_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_dismissive_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_angry_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_unfriendly_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_rival = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_disloyal_to = event_target:human_fallen_empires_discovery_docking_planet_owner
				}
				nor = {
					is_hostile = root
					has_closed_borders = root
				}
			}
		}
		allow = {
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_has_contract_embassy
				not = {
					has_event_chain = human_fallen_empires_discovery_contract_embassy
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.contract_menu.1.response

		begin_event_chain = {
			event_chain = human_fallen_empires_discovery_contract_embassy
			target = root
		}
		hidden_effect = {
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				set_relation_flag = {
					who = root
					flag = human_fallen_empires_discovery_contract_embassy_hirer
				}
			}
			random_country = {
				limit = {
					or = {
						is_hostile_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_dismissive_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_angry_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_unfriendly_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_rival = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_disloyal_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					}
					nor = {
						is_hostile = root
						has_closed_borders = root
					}
				}
				#	save_event_target_as = human_fallen_empires_discovery_embassy_target_country
				capital_scope = {
					set_planet_flag = human_fallen_empires_discovery_contract_embassy_target
					save_event_target_as = human_fallen_empires_discovery_embassy_target
				}
			}
			create_point_of_interest = {
				id = human_fallen_empires_discovery_contract_embassy_point.0
				name = human_fallen_empires_discovery_contract_embassy.name
				desc = human_fallen_empires_discovery_contract_embassy.desc
				event_chain = human_fallen_empires_discovery_contract_embassy
				location = event_target:human_fallen_empires_discovery_embassy_target
			}
		}
	}
	# contract clear system
	option = {
		name = human_fallen_empires_discovery.151.contract_menu.2
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.contract_menu
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				any_system_within_border = {
					any_ship_in_system = {
						exists = owner
						owner = {
							is_hostile = root
							is_hostile = event_target:human_fallen_empires_discovery_docking_planet_owner
						}
					}
				}
			}
		}
		allow = {
			custom_tooltip_fail = {
				text = human_fallen_empires_discovery.151.fail_has_contract_clear_system
				not = {
					has_event_chain = human_fallen_empires_discovery_contract_clear_system
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.contract_menu.2.response

		begin_event_chain = {
			event_chain = human_fallen_empires_discovery_contract_clear_system
			target = root
		}
		hidden_effect = {
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				set_relation_flag = {
					who = root
					flag = human_fallen_empires_discovery_contract_clear_system_hirer
				}
				random_system_within_border = {
					limit = {
						any_ship_in_system = {
							exists = owner
							owner = {
								is_hostile = root
								is_hostile = event_target:human_fallen_empires_discovery_docking_planet_owner
							}
						}
					}
					save_event_target_as = human_fallen_empires_discovery_clear_system_target
				}
			}
			create_point_of_interest = {
				id = human_fallen_empires_discovery_contract_clear_system_point.0
				name = human_fallen_empires_discovery_contract_clear_system.name
				desc = human_fallen_empires_discovery_contract_clear_system.desc
				event_chain = human_fallen_empires_discovery_contract_clear_system
				location = event_target:human_fallen_empires_discovery_clear_system_target
			}
		}
	}
	# contract join war
	option = {
		name = human_fallen_empires_discovery.151.contract_menu.3
		trigger = {
			has_country_flag = human_fallen_empires_discovery.151.contract_menu
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				is_at_war = yes
			}
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		allow = {
			is_at_war = no
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				energy > 100
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires_discovery.151.contract_menu.3

		add_energy = 100
		join_war = event_target:human_fallen_empires_discovery_docking_planet_owner
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = -100
		}
		hidden_effect = {
			every_country = {
				limit = {
					is_at_war_with = root
				}
				set_country_flag = human_fallen_empires_discovery_war_target
			}
		}
	}
	# return
	option = {
		name =  modmenu_return
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = yes
		}
		hidden_effect = {
			human_fallen_empires_effect_discovery_diplomacy_remove_flags = yes
			country_event = { id = human_fallen_empires_discovery.151 }
		}
	}
	# exit
	option = {
		name =  human_fallen_empires_discovery.151.exit
		hidden_effect = {
			human_fallen_empires_effect_discovery_diplomacy_remove_flags = yes
		}
	}
}
