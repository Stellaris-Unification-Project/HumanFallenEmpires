#
namespace = human_fallen_empires_plague

# start plague
country_event = {
	id = human_fallen_empires_plague.0
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		nor = {
			has_global_flag = human_fallen_empires_disable_plague
			has_global_flag = human_fallen_empires_plague_srarted
		}
		or = {
			and = {
				years_passed > 80
				is_difficulty = 2
			}
			and = {
				years_passed > 90
				is_difficulty = 1
			}
			years_passed > 100
		}
	}

	immediate = {
		random_list = {
			30 = {
				break = yes
			}
			10 = {
				modifier = {
					factor = 2
					years_passed > 120
				}
				modifier = {
					factor = 2
					years_passed > 110
				}
				modifier = {
					factor = 2
					years_passed > 100
					or = {
						is_difficulty = 1
						is_difficulty = 2
					}
				}
				modifier = {
					factor = 2
					years_passed > 90
					is_difficulty = 2
				}
			}
		}
		set_global_flag = human_fallen_empires_plague_srarted
		every_country = {
			begin_event_chain = {
				event_chain = human_fallen_empires_plague_count
				target = this
			}
		}
		if = {
			limit = {
				exists = event_target:human_fallen_empires_plague_count
			}
			event_target:human_fallen_empires_plague_count = {
				set_variable = {
					which = human_fallen_empires_plague_planet_num
					value = 0
				}
			}
			else = {
				random_planet = {
					save_global_event_target_as = human_fallen_empires_plague_count
				}
			}
		}
		# сделать зависимость от уровня сложности
		while = {
			count = 10
			random_planet = {
				limit = {
					exists = owner
					owner = {
						is_country_type = default
					}
					num_pops > 0
					not = {
						has_planet_flag = human_fallen_empires_plague_planet
					}
					is_under_colonization = no
					any_owned_pop = {
						nor = {
							has_trait = human_fallen_empires_trait_immune
							has_trait = trait_mechanical
						}
					}
				}
				planet_event = { id = human_fallen_empires_plague.1 days = 1 random = 365}
			}
		}
		every_country = {
			limit = {
				is_ai = no
			}
			country_event = { id = human_fallen_empires_plague.50 days = 1 random = 15 }
		}
		create_species = {
		 	name = "Zombies"
		 	class = random
		 	portrait = random
		 	traits = random
		}
		create_country = {
			name = "Zombies"
			species = last_created_species
			type = human_fallen_empires_plague_zombie
			effect = {
				save_global_event_target_as = human_fallen_empires_plague_zombie_country
			}
		}
	}
}

# start on planet
planet_event = {
	id = human_fallen_empires_plague.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		nor = {
			has_global_flag = human_fallen_empires_disable_plague
			has_planet_flag = human_fallen_empires_plague_planet
		}
		any_owned_pop = {
			nor = {
				has_trait = human_fallen_empires_trait_immune
				has_trait = trait_mechanical
			}
		}
	}

	immediate = {
		set_timed_planet_flag = { flag = human_fallen_empires_plague_planet days = 3650 }
		every_owned_pop = {
			limit = {
				nor = {
					has_trait = human_fallen_empires_trait_immune
					has_trait = trait_mechanical
				}
			}
			set_timed_pop_flag = { flag = human_fallen_empires_plague_pop days = 3650 }
		}
		every_country = {
			limit = {
				has_event_chain = human_fallen_empires_plague_count
			}
			add_event_chain_counter = {
				event_chain = human_fallen_empires_plague_count
				counter = human_fallen_empires_plague_infested_planet_total
				amount = 1
			}
		}
		log = "Plague start on planet [Root.GetName] owner: [Root.Owner.GetName]"
		# set modifier and inform
		if = {
			limit = {
				has_global_flag = human_fallen_empires_plague_lvl_3
			}
			add_modifier = {
				modifier = human_fallen_empires_plague_lvl_3
				days = 3650
			}
			owner = {
				country_event = { id = human_fallen_empires_plague.55 days = 1 random = 15 }
			}
			else = {
				if = {
					limit = {
						has_global_flag = human_fallen_empires_plague_lvl_2
					}
					add_modifier = {
						modifier = human_fallen_empires_plague_lvl_2
						days = 3650
					}
					owner = {
						country_event = { id = human_fallen_empires_plague.54 days = 1 random = 15 }
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_plague_lvl_1
							days = 3650
						}
						owner = {
							country_event = { id = human_fallen_empires_plague.53 days = 1 random = 15 }
						}
					}
				}
			}
		}
		# lvl up plague
		event_target:human_fallen_empires_plague_count = {
			change_variable = {
				which = human_fallen_empires_plague_planet_num
				value = 1
			}
		}
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_plague_lvl_2
				}
				event_target:human_fallen_empires_plague_count = {
					check_variable = {
						which = human_fallen_empires_plague_planet_num
						value > 30
					}
				}
			}
			set_global_flag = human_fallen_empires_plague_lvl_2
			every_country = {
				add_research_option = tech_human_fallen_empires_plague_study
				country_event = { id = human_fallen_empires_plague.51 days = 1 }
			}
		}
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_plague_lvl_3
				}
				event_target:human_fallen_empires_plague_count = {
					check_variable = {
						which = human_fallen_empires_plague_planet_num
						value > 60
					}
				}
			}
			set_global_flag = human_fallen_empires_plague_lvl_3
			every_country = {
				country_event = { id = human_fallen_empires_plague.52 days = 1 }
			}
		}
		# pulse event
		planet_event = { id = human_fallen_empires_plague.2 }
		owner = {
			save_event_target_as = human_fallen_empires_plague_planet_owner
			if = {
				limit = {
					has_event_chain = human_fallen_empires_plague_count
				}
				add_event_chain_counter = {
					event_chain = human_fallen_empires_plague_count
					counter = human_fallen_empires_plague_infested_planet
					amount = 1
				}
			}
		}
		# check planet after 10 years
		planet_event = { id = human_fallen_empires_plague.4 days = 3651 }
	}
}

# planet pulse
planet_event = {
	id = human_fallen_empires_plague.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_disable_plague
		}
		exists = owner
		has_planet_flag = human_fallen_empires_plague_planet
		any_owned_pop = {
			nor = {
				has_trait = human_fallen_empires_trait_immune
				has_trait = trait_mechanical
			}
		}
	}

	immediate = {
		planet_event = { id = human_fallen_empires_plague.2 days = 180 random = 180 }
		#	log = "Plague pulse on planet [Root.GetName] owner: [Root.Owner.GetName]"
		if = {
			limit = {
				has_global_flag = human_fallen_empires_plague_lvl_2
			}
			random_list = {
				# die
				90 = {
					owner = {
						country_event = { id = human_fallen_empires_plague.56 days = 1 }
						if = {
							limit = {
								has_event_chain = human_fallen_empires_plague_count
							}
							add_event_chain_counter = {
								event_chain = human_fallen_empires_plague_count
								counter = human_fallen_empires_plague_kill_pop_count
								amount = 1
							}
						}
					}
					every_country = {
						limit = {
							has_event_chain = human_fallen_empires_plague_count
						}
						add_event_chain_counter = {
							event_chain = human_fallen_empires_plague_count
							counter = human_fallen_empires_plague_kill_pop_count_total
							amount = 1
						}
						if = {
							limit = {
								has_global_flag = human_fallen_empires_plague_lvl_3
							}
							add_event_chain_counter = {
								event_chain = human_fallen_empires_plague_count
								counter = human_fallen_empires_plague_zombie_count_total
								amount = 1
							}
						}
					}
					create_army = {
					 	name = Zombies
					 	owner = event_target:human_fallen_empires_plague_zombie_country
					 	type = human_fallen_empires_plague_zombie_army
					}
					random_owned_pop = {
						limit = {
							nor = {
								has_trait = human_fallen_empires_trait_immune
								has_trait = trait_mechanical
							}
						}
						kill_pop = yes
					}
				}
				# get immune
				1 = {
					modifier = {
						factor = 4
						owner = {
							is_ai = yes
						}
					}
					owner = {
						country_event = { id = human_fallen_empires_plague.58 days = 1 }
					}
					random_owned_pop = {
						limit = {
							nor = {
								has_trait = human_fallen_empires_trait_immune
								has_trait = trait_mechanical
							}
						}
						modify_species = {
							species = this
							add_trait = human_fallen_empires_trait_immune
						}
					}
				}
				# nothing
				9 = {
					modifier = {
						factor = 1.2
						has_building = building_clinic

					}
					modifier = {
						factor = 1.4
						has_building = building_hospital

					}
				}
			}
		}
		# if = {
		# 	limit = {
		# 		has_planet_flag = human_fallen_empires_plague_planet_pop_killed
		# 	}
		# 	create_army = {
		# 		name = Zombies
		# 		owner = event_target:human_fallen_empires_plague_zombie_country
		# 		type = human_fallen_empires_plague_zombie_army
		# 	}
		# }
		# send plague
		random_system = {
			limit = {
				distance = {
					source = root
					max_distance = 40
					min_distance = 0
				}
				any_planet = {
					exists = owner
					owner = {
						or = {
							is_country_type = default
							is_country_type = awakened_fallen_empire
						}
					}
					is_under_colonization = no
					num_pops > 0
					nor = {
						has_planet_flag = human_fallen_empires_plague_planet
						controller = {
							is_country_type = human_fallen_empires_plague_zombie
						}
					}
					any_owned_pop = {
						nor = {
							has_trait = human_fallen_empires_trait_immune
							has_trait = trait_mechanical
						}
					}
				}
			}
			random_planet = {
				limit = {
					exists = owner
					owner = {
						or = {
							is_country_type = default
							is_country_type = awakened_fallen_empire
						}
					}
					is_under_colonization = no
					num_pops > 0
					nor = {
						has_planet_flag = human_fallen_empires_plague_planet
						controller = {
							is_country_type = human_fallen_empires_plague_zombie
						}
					}
					any_owned_pop = {
						nor = {
							has_trait = human_fallen_empires_trait_immune
							has_trait = trait_mechanical
						}
					}
				}
				random_list = {
					# nothing
					20 = {
						modifier = {
							factor = 1.1
							has_building = building_clinic
						}
						modifier = {
							factor = 1.2
							has_building = building_hospital
						}
						modifier = {
							factor = 1.2
							or = {
								is_planet_class = pc_habitat
								is_planet_class = pc_ringworld_habitable
							}
						}
						modifier = {
							factor = 2
							has_global_flag = human_fallen_empires_plague_lvl_2
						}
						modifier = {
							factor = 1.5
							owner = {
								or = {
									has_country_flag = human_fallen_empires_egypt
									has_country_flag = human_fallen_empires_future
									is_country_type = awakened_fallen_empire
								}
							}
						}
						modifier = {
							factor = 1.2
							owner = {
								has_country_edict = human_fallen_empires_plague_quarantine
							}
						}
						modifier = {
							factor = 1.2
							owner = {
								not = {
									is_country = root.owner
								}
								has_closed_borders = root.owner
							}
						}
						log = "not send plague"
					}
					# send plague
					10 = {
						modifier = {
							factor = 1.2
							num_pops > 10
						}
						modifier = {
							factor = 1.4
							num_pops > 20
						}
						planet_event = { id = human_fallen_empires_plague.1 days = 180 random = 180 }
						log = "send plague"
					}
				}
			}
		}
	}
}

# start by migration
pop_event = {
	id = human_fallen_empires_plague.3
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_pop_flag = human_fallen_empires_plague_pop
		exists = planet
	}

	immediate = {
		planet = {
			planet_event = { id = human_fallen_empires_plague.1 }
			log = "Plague migration on planet [This.GetName] owner: [Root.Owner.GetName]"
		}
	}
}

# reduce the counter after 10 years
planet_event = {
	id = human_fallen_empires_plague.4
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_country = {
			limit = {
				has_event_chain = human_fallen_empires_plague_count
			}
			add_event_chain_counter = {
				event_chain = human_fallen_empires_plague_count
				counter = human_fallen_empires_plague_infested_planet_total
				amount = -1
			}
		}
		if = {
			limit = {
				exists = owner
			}
			owner = {
				if = {
					limit = {
						has_event_chain = human_fallen_empires_plague_count
					}
					add_event_chain_counter = {
						event_chain = human_fallen_empires_plague_count
						counter = human_fallen_empires_plague_infested_planet
						amount = -1
					}
				}
			}
			else = {
				every_country = {
					limit = {
						has_event_chain = human_fallen_empires_plague_count
					}
					add_event_chain_counter = {
						event_chain = human_fallen_empires_plague_count
						counter = human_fallen_empires_plague_kill_planet_count_total
						amount = 1
					}
				}
				event_target:human_fallen_empires_plague_planet_owner = {
					country_event = { id = human_fallen_empires_plague.61 }
					if = {
						limit = {
							has_event_chain = human_fallen_empires_plague_count
						}
						add_event_chain_counter = {
							event_chain = human_fallen_empires_plague_count
							counter = human_fallen_empires_plague_kill_planet_count
							amount = 1
						}
					}
					if = {
						limit = {
							has_event_chain = human_fallen_empires_plague_count
						}
						add_event_chain_counter = {
							event_chain = human_fallen_empires_plague_count
							counter = human_fallen_empires_plague_infested_planet
							amount = -1
						}
					}
				}
			}
		}
	}
}

# zombies take planet for on_planet_occupied
planet_event = {
	id = human_fallen_empires_plague.5
	title = human_fallen_empires_plague.5.name
	desc = human_fallen_empires_plague.5.desc
	picture = GFX_evt_human_fallen_empires_zombie
	show_sound = event_ghost_town
	is_triggered_only = yes
	location = root

	trigger = {
		exists = fromfrom
		fromfrom = {
			is_country_type = human_fallen_empires_plague_zombie
		}
	}

	immediate = {
		fromfrom = {
			every_owned_fleet = {
				destroy_fleet = this
			}
		}
		every_planet_army = {
			limit = {
				not = {
					army_type = human_fallen_empires_plague_zombie_army
				}
			}
			remove_army = yes
		}
		purge = yes
		log = "Plague zombies take planet [This.GetName] owner: [From.GetName]"
	}

	option = {
		name = human_fallen_empires_plague.5.0
	}
}

# set owner zombie then purge done
planet_event = {
	id = human_fallen_empires_plague.6
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		num_pops = 0
		exists = controller
		controller = {
			is_country_type = human_fallen_empires_plague_zombie
		}
	}

	immediate = {
		log = "zombie take planet [This.GetName]"
		every_country = {
			limit = {
				has_event_chain = human_fallen_empires_plague_count
			}
			add_event_chain_counter = {
				event_chain = human_fallen_empires_plague_count
				counter = human_fallen_empires_plague_kill_planet_count_total
				amount = 1
			}
		}
		owner = {
			country_event = { id = human_fallen_empires_plague.61 }
			if = {
				limit = {
					has_event_chain = human_fallen_empires_plague_count
				}
				add_event_chain_counter = {
					event_chain = human_fallen_empires_plague_count
					counter = human_fallen_empires_plague_kill_planet_count
					amount = 1
				}
			}
		}
		set_owner = controller
		owner = {
			every_owned_fleet = {
				destroy_fleet = this
			}
		}
	}
}

# retake zombie planet for on_planet_occupied
planet_event = {
	id = human_fallen_empires_plague.7
	title = human_fallen_empires_plague.7.name
	desc = human_fallen_empires_plague.7.desc
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	is_triggered_only = yes
	location = root

	trigger = {
		exists = from
		from = {
			is_country_type = human_fallen_empires_plague_zombie
		}
		exists = fromfrom
		fromfrom = {
			not = {
				is_country_type = human_fallen_empires_plague_zombie
			}
		}
	}

	immediate = {
		every_planet_army = {
			limit = {
				army_type = human_fallen_empires_plague_zombie_army
			}
			remove_army = yes
		}
		set_owner = fromfrom
		log = "Take planet[This.GetName] from zombies new owner: [Root.Owner.GetName]"
	}

	option = {
		name = human_fallen_empires_plague.7.0
	}
}

# remove purge then planet returned
country_event = {
	id = human_fallen_empires_plague.8
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = fromfrom
		fromfrom = {
			controller = {
				is_country_type = human_fallen_empires_plague_zombie
			}
		}
	}

	immediate = {
		fromfrom = {
			every_planet_army = {
				limit = {
					army_type = human_fallen_empires_plague_zombie_army
				}
				remove_army = yes
			}
			every_owned_pop = {
				purge = no
			}
		}
	}
}

# report event after lvl 2 for on_tech_increased
country_event = {
	id = human_fallen_empires_plague.9
	title = human_fallen_empires_plague.9.name
	desc = {
		trigger = {
			text = human_fallen_empires_plague.9.desc.0
			success_text = {
				text = human_fallen_empires_plague.9.desc.1
				any_owned_planet = {
					or = {
						is_planet_class = pc_habitat
						is_planet_class = pc_ringworld_habitable
					}
				}
			}
			text = human_fallen_empires_plague.9.desc.2
		}
	}
	show_sound = event_laboratory_sound
	is_triggered_only = yes
	diplomatic = yes

	trigger = {
		last_increased_tech = tech_human_fallen_empires_plague_study
	}

	immediate = {
		random_owned_leader = {
			limit = {
				leader_class = scientist
			}
			save_event_target_as = human_fallen_empires_plague_scientist_portrait
		}
	}

	picture_event_data = {
		portrait = event_target:human_fallen_empires_plague_scientist_portrait
		room = human_fallen_empires_lab_room
	}

	option = {
		name = human_fallen_empires_plague.9.0
		custom_tooltip = human_fallen_empires_plague.9.0.tooltip
		hidden_effect = {
			country_event = { id = human_fallen_empires_plague.10 days = 2 }
		}
	}
}

# second diplo event
country_event = {
	id = human_fallen_empires_plague.10
	title = human_fallen_empires_plague.10.name
	desc = {
		trigger = {
			text = human_fallen_empires_plague.10.desc.0.0
			fail_text = {
				text = human_fallen_empires_plague.10.desc.1.0
				has_policy_flag = refugees_not_allowed
			}
			success_text = {
				text = human_fallen_empires_plague.10.desc.2.0
				allows_purge = yes
			}
		}
	}
	show_sound = event_celebration
	is_triggered_only = yes
	diplomatic = yes

	immediate = {
		random_owned_leader = {
			limit = {
				leader_class = ruler
			}
			save_event_target_as = human_fallen_empires_plague_ruler_portrait
		}
	}

	picture_event_data = {
		portrait = event_target:human_fallen_empires_plague_ruler_portrait
		room = ethic_spaceship_room
		# planet_background = root
		# graphical_culture = root
		# city_level = root
		# room = root
	}

	option = {
		name = human_fallen_empires_plague.10.0
		add_modifier = {
			modifier = human_fallen_empires_unity
			days = 365
		}
	}
}

# bombarding infected planet after project finished
ship_event = {
	id = human_fallen_empires_plague.11
	title = human_fallen_empires_plague.11.name
	desc = human_fallen_empires_plague.11.desc
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	is_triggered_only = yes
	location = root

	immediate = {
		event_target:human_fallen_empires_plague_bombardment_planet = {
			log = "Bombard plague planet [This.GetName] owner [Owner.GetName]"
			set_timed_planet_flag = { flag = human_fallen_empires_plague_bombardment_planet days = 3650 }
			if = {
				limit = {
					num_pops > 0
				}
				random_owned_pop = {
					save_event_target_as = purged_species
				}
				owner = {
					every_relation = {
						limit = {
							not = {
								is_same_species = event_target:purged_species
							}
							allows_purge = no
							or = {
								is_country_type = default
								has_ai_personality = awakened_fallen_empire_xenophile
							}
						}
						add_opinion_modifier = { who = root.owner modifier = opinion_genocidal }
					}
					every_relation = {
						limit = {
							is_same_species = event_target:purged_species
							allows_purge = no
						}
						add_opinion_modifier = { who = root.owner modifier = opinion_genocidal_our_species }
					}
				}
			}
			human_fallen_empires_effect_plague_planet_clean = yes
			destroy_colony = yes
			add_modifier = {
				modifier = human_fallen_empires_plague_bombardment_planet
				days = 10000
			}
		}
		# добавить эвенты адмирала
	}
	option = {
		name = human_fallen_empires_plague.11.0
	}
}

# check if planet still has owner
ship_event = {
	id = human_fallen_empires_plague.12
	title = human_fallen_empires_plague.12.name
	desc = human_fallen_empires_plague.12.desc
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	is_triggered_only = yes
	location = root

	trigger = {
		event_target:human_fallen_empires_plague_bombardment_planet = {
			not = {
				exists = owner
			}
		}
	}

	immediate = {
		owner = {
			abort_special_project = {
				type = human_fallen_empires_plague_bombardment
				location = event_target:human_fallen_empires_plague_bombardment_planet
			}
		}
	}

	option = {
		name = human_fallen_empires_plague.11.1
	}
}

# admiral events




# inform events 50 - 100

# plague start inform
country_event = {
	id = human_fallen_empires_plague.50
	title = human_fallen_empires_plague.50.name
	desc = human_fallen_empires_plague.50.desc
	picture = GFX_evt_news_room
	show_sound = event_laboratory_sound
	is_triggered_only = yes

	trigger = {
		is_ai = no
	}

	option = {
		name = INTERESTING
	}
}

# plague lvl 2 inform
country_event = {
	id = human_fallen_empires_plague.51
	title = human_fallen_empires_plague.51.name
	desc = human_fallen_empires_plague.51.desc
	picture = GFX_evt_news_room
	show_sound = event_laboratory_sound
	is_triggered_only = yes

	trigger = {
		is_ai = no
	}

	option = {
		name = CURSES
		tooltip = {
			add_research_option = tech_human_fallen_empires_plague_study
		}
	}
}

# plague lvl 3 inform
country_event = {
	id = human_fallen_empires_plague.52
	title = human_fallen_empires_plague.52.name
	desc = human_fallen_empires_plague.52.desc
	picture = GFX_evt_news_room
	show_sound = event_laboratory_sound
	is_triggered_only = yes

	trigger = {
		is_ai = no
	}

	option = {
		name = DISCONCERTING
	}
}

# plague on our planet lvl 1
country_event = {
	id = human_fallen_empires_plague.53
	title = human_fallen_empires_plague.53.name
	desc = human_fallen_empires_plague.53.desc
	# {
	# 	trigger = {
	# 		fail_text = {
	# 			text = human_fallen_empires_plague.53.desc.0
	# 			has_global_flag = human_fallen_empires_plague_lvl_2
	# 		}
	# 		fail_text = {
	# 			text = human_fallen_empires_plague.53.desc.1
	# 			has_global_flag = human_fallen_empires_plague_lvl_3
	# 		}
	# 		success_text = {
	# 			text = human_fallen_empires_plague.53.desc.2
	# 			has_global_flag = human_fallen_empires_plague_lvl_23
	# 		}
	# 	}
	# }
	picture = GFX_evt_news_room
	show_sound = event_administrative_work
	is_triggered_only = yes
	location = from

	trigger = {
		is_ai = no
		not = {
			has_country_flag = human_fallen_empires_plague_block_planet
		}
	}

	option = {
		name = human_fallen_empires_plague.53.0
	}
	option = {
		name = human_fallen_empires_block
		custom_tooltip = human_fallen_empires_plague_block.tooltip
		hidden_effect = {
			set_country_flag = human_fallen_empires_plague_block_planet
		}
	}
}

# plague on our planet lvl 2
country_event = {
	id = human_fallen_empires_plague.54
	title = human_fallen_empires_plague.54.name
	desc = human_fallen_empires_plague.54.desc
	picture = GFX_evt_human_fallen_empires_plague
	show_sound = event_air_raid_siren
	is_triggered_only = yes
	location = from

	trigger = {
		is_ai = no
		not = {
			has_country_flag = human_fallen_empires_plague_block_planet
		}
	}

	option = {
		name = human_fallen_empires_plague.54.0
	}
	option = {
		name = human_fallen_empires_block
		custom_tooltip = human_fallen_empires_plague_block.tooltip
		hidden_effect = {
			set_country_flag = human_fallen_empires_plague_block_planet
		}
	}
}

# plague on our planet lvl 3
country_event = {
	id = human_fallen_empires_plague.55
	title = human_fallen_empires_plague.55.name
	desc = human_fallen_empires_plague.55.desc
	picture = GFX_evt_human_fallen_empires_zombie
	show_sound = event_air_raid_siren
	is_triggered_only = yes
	location = from

	trigger = {
		is_ai = no
		not = {
			has_country_flag = human_fallen_empires_plague_block_planet
		}
	}

	option = {
		name = human_fallen_empires_plague.55.0
	}
	option = {
		name = human_fallen_empires_block
		custom_tooltip = human_fallen_empires_plague_block.tooltip
		hidden_effect = {
			set_country_flag = human_fallen_empires_plague_block_planet
		}
	}
}

# plague on our planet pulse
country_event = {
	id = human_fallen_empires_plague.56
	title = human_fallen_empires_plague.56.name
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires_plague.56.desc.0
				has_global_flag = human_fallen_empires_plague_lvl_3
			}
			success_text = {
				text = human_fallen_empires_plague.56.desc.1
				has_global_flag = human_fallen_empires_plague_lvl_3
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_plague
	show_sound = event_air_raid_siren
	is_triggered_only = yes
	location = from

	trigger = {
		is_ai = no
		not = {
			has_country_flag = human_fallen_empires_plague_block_pulse
		}
	}

	option = {
		name = human_fallen_empires_plague.56.0
		trigger = {
			not = {
				has_global_flag = human_fallen_empires_plague_lvl_3
			}
		}
	}
	option = {
		name = human_fallen_empires_plague.56.1
		trigger = {
			has_global_flag = human_fallen_empires_plague_lvl_3
		}
	}
	option = {
		name = human_fallen_empires_block
		custom_tooltip = human_fallen_empires_plague_block.tooltip
		hidden_effect = {
			set_country_flag = human_fallen_empires_plague_block_pulse
		}
	}
}

# # plague on our planet lvl 3 pulse
# country_event = {
# 	id = human_fallen_empires_plague.57
# 	title = human_fallen_empires_plague.57.name
# 	desc = human_fallen_empires_plague.57.desc
# 	picture = GFX_evt_human_fallen_empires_zombie
# 	show_sound = event_air_raid_siren
# 	is_triggered_only = yes
# 	location = from

# 	trigger = {
# 		is_ai = no
# 		not = {
# 			has_country_flag = human_fallen_empires_plague_block_pulse
# 		}
# 	}

# 	option = {
# 		name = human_fallen_empires_plague.57.0
# 	}
# 	option = {
# 		name = human_fallen_empires_block
# 		custom_tooltip = human_fallen_empires_plague_block.tooltip
# 		hidden_effect = {
# 			set_country_flag = human_fallen_empires_plague_block_pulse
# 		}
# 	}
# }

# pop gain immune
country_event = {
	id = human_fallen_empires_plague.58
	title = human_fallen_empires_plague.58.name
	desc = human_fallen_empires_plague.58.desc
	picture = GFX_evt_human_fallen_empires_lab
	show_sound = event_celebration
	is_triggered_only = yes
	location = from

	trigger = {
		not = {
			has_technology = tech_human_fallen_empires_plague_immune
		}
	}

	option = {
		name = human_fallen_empires_plague.58.0
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_plague_know_immune
			}
		}
		add_research_option = tech_human_fallen_empires_plague_immune
		set_country_flag = human_fallen_empires_plague_know_immune
		log = "[Root.GetName] now know immune"
	}
	option = {
		name = human_fallen_empires_plague.58.1
		trigger = {
			has_country_flag = human_fallen_empires_plague_know_immune
		}
		add_tech_progress = {
			tech = tech_human_fallen_empires_plague_immune
			progress = 0.01
		}
	}
}

# everyone die on planet notification for owner
country_event = {
	id = human_fallen_empires_plague.61
	title = human_fallen_empires_plague.61.name
	desc = human_fallen_empires_plague.61.desc
	picture = GFX_evt_human_fallen_empires_ruins
	show_sound = event_ghost_town
	is_triggered_only = yes
	location = from

	trigger = {
		is_ai = no
		exists = from
		from = {
			not = {
				has_planet_flag = human_fallen_empires_plague_bombardment_planet
			}
		}
	}

	option = {
		name = human_fallen_empires_plague.61.0
	}
}

# events on first plague planet 100 - 150
planet_event = {
	id = human_fallen_empires_plague.100
	title = human_fallen_empires_plague.100.name
	desc = human_fallen_empires_plague.100.desc
	picture = GFX_evt_human_fallen_empires_plague
	show_sound = event_air_raid_siren
	is_triggered_only = yes
	location = root

	trigger = {
		exists = owner
		owner = {
			not = {
				has_country_flag = human_fallen_empires_plague_fist_time
			}
		}
	}

	immediate = {
		set_timed_planet_flag = { flag = human_fallen_empires_plague_fist_planet days = 3650 }
		owner = {
			set_country_flag = human_fallen_empires_plague_fist_time
		}
	}

	option = {
		name = human_fallen_empires_plague.100.0
	}
}

# bombardment event 150 - 200
