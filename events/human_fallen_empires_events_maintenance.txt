#
namespace = human_fallen_empires_maintenance

# This = Ship
# From = Disabler Ship
# kill starbases of drone on_ship_disabled
ship_event = {
	id = human_fallen_empires_maintenance.0
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = this
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_drone
		}
		is_ship_class = shipclass_starbase
	}

	immediate = {
		owner = {
			every_owned_planet = {
				limit = {
					solar_system = {
						is_same_value = root.solar_system
					}
				}
				human_fallen_empires_effect_convert_to_asteroid = yes
			}
		}
		log = "drone loss starbase on [root.solar_system.GetName] killer [root.from.owner.GetName]"
		fleet = {
			destroy_fleet = this
		}
	}
}

# log drone outpost
ship_event = {
	id = human_fallen_empires_maintenance.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			or = {
				is_country_type = human_fallen_empires_drone
				is_country_type = human_fallen_empires_pirate
			}
		}
	}

	immediate = {
		#log = "outpost build in [root.solar_system.GetName] by [root.owner.GetName]"
	}
}

#
planet_event = {
	id = human_fallen_empires_maintenance.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_drone
		}
	}

	immediate = {
		human_fallen_empires_effect_convert_to_asteroid = yes
	}
}
