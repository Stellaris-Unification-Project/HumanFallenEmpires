#
namespace = human_fallen_empires

# functional section 0 - 50

# functional events and features
# functional events for yearly pulse
event = {
	id = human_fallen_empires.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# leaders module
		every_country = {
			country_event = {
				id = human_fallen_empires_leaders.0
				days = 1
				random = 355
			}
		}
		# pirate module
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_disable_pirate
				}
			}
			# spawn pirate
			random_list = {
				2 = {
				}
				1 = {
					modifier = {
						factor = 2
						is_difficulty > 2
					}
					modifier = {
						factor = 2
						is_difficulty > 1
					}
					modifier = {
						factor = 2
						is_difficulty > 0
					}
					random_country = {
						limit = {
							not = {
								has_country_flag = human_fallen_empires_birth_of_piracy
							}
							is_country_type = default
							num_owned_planets > 2
							human_fallen_empires_trigger_is_human_fallen = no
							human_fallen_empires_trigger_is_hive = no
						}
						country_event = {
							id = human_fallen_empires_pirate.1
							days = 1
							random = 355
						}
					}
				}
			}
			# spawn pirate again
			if = {
				limit = {
					any_country = {
						is_country_type = default
						has_country_flag = human_fallen_empires_birth_of_piracy
						not = {
							has_country_flag = human_fallen_empires_pirate_spawned
						}
					}
				}
				every_country = {
					limit = {
						is_country_type = default
						not = {
							has_country_flag = human_fallen_empires_pirate_spawned
						}
						has_country_flag = human_fallen_empires_birth_of_piracy
					}
					random_list = {
						98 = {
						}
						2 = {
							modifier = {
								factor = 2
								is_difficulty > 2
							}
							modifier = {
								factor = 2
								is_difficulty > 1
							}
							modifier = {
								factor = 2
								is_difficulty > 0
							}
							modifier = {
								factor = 2
								is_at_war = yes
							}
							modifier = {
								factor = 2
								any_owned_planet = {
									not = {
										is_controlled_by = owner
									}
								}
							}
							modifier = {
								factor = 2
								any_owned_planet = {
									is_capital = yes
									not = {
										is_controlled_by = owner
									}
								}
							}
							# modifier = {
							# 	factor = 2
							# 	or = {
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			defender_war_exhaustion > 20
							# 		}
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			attacker_war_exhaustion > 20
							# 		}
							# 	}
							# }
							# modifier = {
							# 	factor = 2
							# 	or = {
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			defender_war_exhaustion > 40
							# 		}
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			attacker_war_exhaustion > 40
							# 		}
							# 	}
							# }
							# modifier = {
							# 	factor = 2
							# 	or = {
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			defender_war_exhaustion > 60
							# 		}
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			attacker_war_exhaustion > 60
							# 		}
							# 	}
							# }
							# modifier = {
							# 	factor = 2
							# 	or = {
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			defender_war_exhaustion > 80
							# 		}
							# 		any_war = {
							# 			any_defender = {
							# 				is_country = prev
							# 			}
							# 			attacker_war_exhaustion > 80
							# 		}
							# 	}
							# }
							country_event = {
								id = human_fallen_empires_pirate.6
								days = 1
								random = 355
							}
						}
					}
				}
			}
			# pirate life
			every_country = {
				limit = {
					is_country_type = human_fallen_empires_pirate
				}
				country_event = {
					id = human_fallen_empires_pirate.2
				}
			}
		}
	}
}

# functional events for bi yearly pulse
event = {
	id = human_fallen_empires.2
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# change main species
		every_country = {
			country_event = {
				id = human_fallen_empires_population.50
				days = 1
				random = 700
			}
		}
		# make discovery default country
		if = {
			limit = {
				any_country = {
					is_country_type = human_fallen_empires_discovery
					num_owned_planets > 0
				}
			}
			random_country = {
				limit = {
					is_country_type = human_fallen_empires_discovery
					num_owned_planets > 0
				}
				set_country_type = default
			}
		}
		# assimilation event for coalition
		random_country = {
			limit = {
				has_country_flag = human_fallen_empires_coalition_leader
			}
			country_event = {
				id = human_fallen_empires.5020
			}
		}
		# varelse mahanicus event
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_varelse_mehanicus
				}
			}
			random_planet = {
				limit = {
					has_planet_flag = human_fallen_empires_varelse_colony
					has_observation_outpost = yes
					exists = owner
					owner = {
						is_country_type = primitive
					}
				}
				planet_event = {
					id = human_fallen_empires.101
					days = 1
					random = 355
				}
			}
		}
		# copernicus observation event
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_has_event.362
				}
			}
			random_planet = {
				limit = {
					has_planet_flag = human_fallen_empires_copernicus.0
					has_observation_outpost = yes
					exists = owner
					owner = {
						is_country_type = primitive
					}
					not = {
						has_planet_flag = human_fallen_empires_has_event.362
					}
				}
				planet_event = {
					id = human_fallen_empires.361
					days = 1
					random = 355
				}
			}
		}
		# fallen emp drain resurces from vassals
		# need to test
		if = {
			limit = {
				has_global_flag = human_fallen_empires_war_in_heaven_started
				any_country = {
					is_country_type = awakened_fallen_empire
					is_at_war = yes
					is_war_leader = yes
					or = {
						any_war = {
							any_defender = {
								is_country = prev
							}
							defender_war_exhaustion > 20
						}
						any_war = {
							any_defender = {
								is_country = prev
							}
							attacker_war_exhaustion > 20
						}
					}
				}
			}
			random_country = {
				limit = {
					is_country_type = awakened_fallen_empire
					is_at_war = yes
					is_war_leader = yes
					or = {
						any_war = {
							any_defender = {
								is_country = prevprev
							}
							defender_war_exhaustion > 20
						}
						any_war = {
							any_defender = {
								is_country = prevprev
							}
							attacker_war_exhaustion > 20
						}
					}
				}
				every_subject = {
					limit = {
						not = {
							has_modifier = human_fallen_empires_fallen_resurces_drain
						}
					}
					country_event = {
						id = human_fallen_empires_total_war.50
					}
				}
			}
		}
	}
}

# functional events for decade pulse
event = {
	id = human_fallen_empires.3
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# planet decay feature
		if = {
			limit = {
				years_passed > 200
				not = {
					has_global_flag = human_fallen_empires_disable_planet_decay
				}
			}
			every_country = {
				limit = {
					is_country_type = default
				}
				every_owned_planet = {
					planet_event = {
						id = human_fallen_empires_decay.0
						days = 1
						random = 3600
					}
				}
			}
			every_planet = {
				planet_event = {
					id = human_fallen_empires_decay.5
					days = 1
					random = 3600
				}
			}
		}
		# kad republic buy robots dialog
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_future_take_robot
				}
				exists = event_target:human_fallen_empires_future_country
				event_target:human_fallen_empires_future_country = {
					any_owned_planet = {
						free_pop_tiles > 0
					}
				}
				any_country = {
					is_ai = no
					any_owned_pop = {
						has_trait = trait_mechanical
					}
					not = {
						has_country_flag = human_fallen_empires_future_try_take_robot
					}
					event_target:human_fallen_empires_future_country = {
						has_communications = prev
					}
				}
			}
			random_list = {
				2 = {
				}
				1 = {
					random_country = {
						limit = {
							is_ai = no
							any_owned_pop = {
								has_trait = trait_mechanical
							}
							not = {
								has_country_flag = human_fallen_empires_future_try_take_robot
							}
						}
						country_event = {
							id = human_fallen_empires.5100
							days = 1
							random = 3600
						}
					}
				}
			}
		}
		# future is in expansion
		if = {
			limit = {
				exists = event_target:human_fallen_empires_future_country
			}
			event_target:human_fallen_empires_future_country = {
				country_event = {
					id = human_fallen_empires.5010
					days = 1
					random = 3600
				}
			}
		}
		# egypt is in expansion
		if = {
			limit = {
				exists = event_target:human_fallen_empires_egypt_country
			}
			event_target:human_fallen_empires_egypt_country = {
				country_event = {
					id = human_fallen_empires.48
					days = 1
					random = 3600
				}
			}
		}
		random_country = {
			# plague start
			country_event = {
				id = human_fallen_empires_plague.0
				days = 1
				random = 3600
			}
			# awake fallen
			country_event = {
				id = human_fallen_empires_total_war.1000
				days = 1
				random = 3600
			}
			# war in heavens trigger
			country_event = {
				id = human_fallen_empires_total_war.1010
				days = 1
				random = 3600
			}
		}
	}
}

# fix psi traits
country_event = {
	id = human_fallen_empires.10
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_owned_pop = {
			limit = {
				has_trait = trait_latent_psionic
				has_trait = trait_psionic
			}
			modify_species = {
				species = this
				remove_trait = trait_latent_psionic
			}
		}
	}
}

# contact with egypt 46 - 47
country_event = {
	id = human_fallen_empires.46
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		from = {
			has_country_flag = human_fallen_empires_egypt
			is_country_type = human_fallen_empire
		}
	}

	immediate = {
		establish_communications = from
		set_country_flag = human_fallen_empires_egypt_contacted
		if = {
			limit = {
				is_ai = no
			}
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
}

# meeting dialog egypt
country_event = {
	id = human_fallen_empires.47
	title = TRANSMISSION
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				human_fallen_empires_egypt_wormhole = {
					text = human_fallen_empires.47.desc.0
				}
				default = {
					text = human_fallen_empires.47.desc.1
				}
				human_fallen_empires.47.step1 = {
					text = human_fallen_empires.47.desc.2
				}
				human_fallen_empires.47.step2 = {
					text = human_fallen_empires.47.desc.3
				}
				human_fallen_empires.47.step3 = {
					text = human_fallen_empires.47.desc.4
				}
				human_fallen_empires.47.step4 = {
					text = human_fallen_empires.47.desc.5
				}
				human_fallen_empires.47.stepbadend = {
					text = human_fallen_empires.47.desc.6
				}
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_country
		room = human_fallen_empires_egypt_room
	}

	# step 0
	option = {
		name = human_fallen_empires.47.0.0
		response_text = human_fallen_empires.47.desc.6
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.47.step1
				has_country_flag = human_fallen_empires.47.step2
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step4
				has_country_flag = human_fallen_empires_marked_as_human
			}
			has_ethic = ethic_fanatic_xenophobe
		}
		human_fallen_empires_effect_xenophobe_attraction_high = yes
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.stepbadend
			remove_country_flag = human_fallen_empires_egypt_wormhole
		}
	}
	option = {
		name = human_fallen_empires.47.0.1
		trigger = {
			any_relation = {
				has_country_flag = human_fallen_empires_future
			}
			nor = {
				has_country_flag = human_fallen_empires.47.step1
				has_country_flag = human_fallen_empires.47.step2
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step4
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.0.2
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.47.step1
				has_country_flag = human_fallen_empires.47.step2
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step4
			}
			# is_xenophobe = no
			has_country_flag = human_fallen_empires_marked_as_human
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.0.3
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.47.step1
				has_country_flag = human_fallen_empires.47.step2
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step4
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.0.4
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.47.step1
				has_country_flag = human_fallen_empires.47.step2
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step4
			}
			has_ethic = ethic_fanatic_spiritualist
		}
		human_fallen_empires_effect_spiritualist_attraction_high = yes
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.47
			}
		}
		# добавить плюс к отношениям
	}
	option = {
		name = human_fallen_empires.47.0.5
		response_text = human_fallen_empires.47.desc.6
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.47.step1
				has_country_flag = human_fallen_empires.47.step2
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step4
			}
			has_ethic = ethic_fanatic_militarist
			fleet_power > 40000
		}
		human_fallen_empires_effect_militarist_attraction_high = yes
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.stepbadend
			remove_country_flag = human_fallen_empires_egypt_wormhole
		}
	}
	option = {
		name = human_fallen_empires.47.0.6
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.47.step1
				has_country_flag = human_fallen_empires.47.step2
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step4
				has_country_flag = human_fallen_empires_marked_as_human
			}
			any_relation = {
				or = {
					has_country_flag = human_fallen_empires_future
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.47.1.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.1.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.1.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.1.3
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.1.4
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.1.5
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.1.6
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.1.7
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step1
			set_country_flag = human_fallen_empires.47.step2
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	# step 2
	option = {
		name = human_fallen_empires.47.2.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			or = {
				has_country_flag = human_1
				and = {
					has_country_flag = human_fallen_empires_marked_as_human
					any_system_within_border = {
						has_star_flag = sol
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			has_country_flag = human_2
			not = {
				any_system = {
					has_star_flag = sol
					is_surveyed = {
						who = root
						status = yes
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			has_country_flag = human_2
			any_system = {
				has_star_flag = sol
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.3
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			has_country_flag = human_fallen_empires_marked_as_human
			nor = {
				has_country_flag = human_1
				has_country_flag = human_2
				any_system = {
					has_star_flag = sol
					is_surveyed = {
						who = root
						status = yes
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.4
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			any_relation = {
				is_country_type = default
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.5
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			nor = {
				has_country_flag = human_fallen_empires_marked_as_human
				any_system = {
					has_star_flag = sol
					is_surveyed = {
						who = root
						status = yes
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.6
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			any_system = {
				has_star_flag = sol
				has_star_flag = nuked_sol
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.7
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			any_system = {
				has_star_flag = sol
				has_star_flag = primitive_sol
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.8
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			or = {
				has_country_flag = human_fallen_empires_marked_as_human
				is_xenophile = yes
			}
			any_system = {
				has_star_flag = sol
				is_surveyed = {
					who = root
					status = no
				}
			}
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step2
			set_country_flag = human_fallen_empires.47.step3
			country_event = {
				id = human_fallen_empires.47
			}
			begin_event_chain = {
				event_chain = human_fallen_empires_chain_find_sol
				target = root
			}
			random_system = {
				limit = {
					has_star_flag = sol
				}
				save_event_target_as = human_fallen_empires_sol
				set_star_flag = human_fallen_empires_sol_target@root
			}
			create_point_of_interest = {
				id = human_fallen_empires_sol.1
				name = sol_1_poi
				desc = human_fallen_empires_chain_find_sol_desc.1
				event_chain = human_fallen_empires_chain_find_sol
				location = event_target:human_fallen_empires_sol
			}
		}
	}
	#step 3
	option = {
		name = human_fallen_empires.47.3.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.3.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.3.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.3.3
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.3.4
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.3.5
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.3.6
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	option = {
		name = human_fallen_empires.47.3.7
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step3
			set_country_flag = human_fallen_empires.47.step4
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
	#step 4
	option = {
		name = human_fallen_empires.47.4.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step4
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step4
		}
		#добавить бонус к счастью
	}
	option = {
		name = human_fallen_empires.47.4.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step4
			has_country_flag = human_fallen_empires_marked_as_human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step4
		}
	}
	option = {
		name = human_fallen_empires.47.4.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step4
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.47.step4
		}
	}
	#сделать бонусную ветку
}

# awake make egypt default country 48
country_event = {
	id = human_fallen_empires.48
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_egypt_in_expansion
		}
		or = {
			mid_game_years_passed > 50
			end_game_years_passed > 0
		}
		or = {
			has_global_flag = galactic_crisis_happened
			has_global_flag = human_fallen_empires_war_in_heaven_started
			recently_lost_war = yes
			and = {
				or = {
					years_passed > 140
					any_country = {
						is_country_type = default
						fleet_power > 100000
					}
				}
				is_difficulty = 0
			}
			and = {
				or = {
					years_passed > 130
					any_country = {
						is_country_type = default
						fleet_power > 90000
					}
				}
				is_difficulty > 0
			}
			and = {
				or = {
					years_passed > 120
					any_country = {
						is_country_type = default
						fleet_power > 80000
					}
				}
				is_difficulty > 1
			}
			and = {
				or = {
					years_passed > 110
					any_country = {
						is_country_type = default
						fleet_power > 70000
					}
				}
				is_difficulty > 2
			}
		}
	}

	immediate = {
		every_owned_ship = {
			repair_ship = yes
			add_modifier = {
				modifier = human_fallen_empires_unkeep
				days = -1
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_navy_size
			days = 3600
		}
		country_add_ethic = ethic_xenophobe
		set_country_type = default
		set_global_flag = human_fallen_empires_egypt_in_expansion
		every_country = {
			establish_communications_no_message = event_target:human_fallen_empires_egypt_country
			if = {
				limit = {
					is_ai = no
				}
				country_event = {
					id = human_fallen_empires.49
				}
				set_country_flag = human_fallen_empires_egypt_contacted
			}
		}
		random_country = {
			limit = {
				is_country_type = default
				fleet_power > 30000
				not = {
					is_country = root
				}
			}
			log = "egypt awekened by [This.GetName]"
		}
	}
}

# dialoge 49
country_event = {
	id = human_fallen_empires.49
	title = human_fallen_empires.49.name
	desc = human_fallen_empires.49.desc.0
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt.ruler
		room = human_fallen_empires_egypt_room
	}

	option = {
		name = human_fallen_empires.49.0
		default_hide_option = yes
	}
}

# anomalys and after survey on actions 50 - 100

# wormhole to ju ahet 50
ship_event = {
	id = human_fallen_empires.50
	title = human_fallen_empires.50.name
	desc = human_fallen_empires.50.desc
	picture = GFX_evt_human_fallen_empires_wormhole
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	immediate = {
		random_country = {
			limit = {
				has_country_flag = human_fallen_empires_egypt
			}
			random_owned_planet = {
				limit = {
					is_capital = yes
				}
				save_event_target_as = human_fallen_empires_ra_home
			}
		}
		owner = {
			set_country_flag = human_fallen_empires_egypt_wormhole
		}
	}

	option = {
		name = human_fallen_empires.50.0
		hidden_effect = {
			fleet = {
				set_location = {
					target = event_target:human_fallen_empires_ra_home
					distance = 5
					angle = random
				}
			}
			#	remove_country_flag = human_fallen_empires_egypt_wormhole
		}
	}
}

# varelse fleet in time trap 51-53
# start event
ship_event = {
	id = human_fallen_empires.51
	title = human_fallen_empires.51.name
	desc = human_fallen_empires.51.desc
	picture = GFX_evt_human_fallen_empires_station
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_varelse_fleet_location
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_has_event.51
		}
		exists = owner
		owner = {
			is_ai = no
		}
	}

	immediate = {
		set_global_flag = human_fallen_empires_has_event.51
		create_ambient_object = {
			type = ancient_battlefield_object
			location = solar_system
		}
		last_created_ambient_object = {
			save_event_target_as = human_fallen_empires_varelse_fleet_location
		}
		enable_special_project = {
			name = human_fallen_empires_project_varelse_fleet
			location = event_target:human_fallen_empires_varelse_fleet_location
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires.51.0
		trigger = {
			is_ship_size = science
		}
	}
	option = {
		name = human_fallen_empires.51.1
		trigger = {
			not = {
				is_ship_size = science
			}
		}
	}
}

# project complete
ship_event = {
	id = human_fallen_empires.52
	title = human_fallen_empires.52.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.52.desc.0
				owner = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
			text = human_fallen_empires.52.desc.1
		}
	}
	picture = GFX_evt_human_fallen_empires_wormhole
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	immediate = {
		create_country = {
			name = "Varelse Hegemony"
			type = faction
			effect = {
				establish_communications_no_message = root.owner
				set_faction_hostility = {
					set_hostile = no
				}
				create_leader = {
					type = admiral
					species = event_target:human_fallen_empires_varelse_species
					name = random
					skill = 500
				}
			}
		}
		create_fleet = {
			name = "11th Strike Force"
			effect = {
				set_owner = last_created_country
				while = {
					count = 10
					create_ship = {
						name = random
						design = Sunset
						graphical_culture = "reptilian_01"
					}
				}
				assign_leader = last_created_leader
				while = {
					count = 30
					create_ship = {
						name = random
						design = Farstar
						graphical_culture = "reptilian_01"
					}
				}
				owner = {
					every_owned_ship = {
						add_modifier = {
							modifier = human_fallen_empires_unkeep
							days = -1
						}
					}
				}
				set_location = root
				save_event_target_as = human_fallen_empires_varelse_fleet
			}
		}
		#	destroy_ambient_object = event_targe:human_fallen_empires_varelse_fleet_location
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		custom_tooltip = human_fallen_empires.53.0.tooltip
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.53
				}
				set_country_flag = human_fallen_empires.53.0
			}
		}
	}
}

# dialog with fleet
country_event = {
	id = human_fallen_empires.53
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.53.desc.0.0
				has_country_flag = human_fallen_empires.53.0
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.0
				has_country_flag = human_fallen_empires.53.0.0
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.1
				or = {
					has_country_flag = human_fallen_empires.53.0.1
					has_country_flag = human_fallen_empires.53.0.2
				}
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.2
				or = {
					has_country_flag = human_fallen_empires.53.0.3
					has_country_flag = human_fallen_empires.53.0.4
				}
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_varelse_species
		room = human_fallen_empires_varelse_room
	}

	option = {
		name = human_fallen_empires.53.0.0
		trigger = {
			has_country_flag = human_fallen_empires.53.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.0
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.1
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.1
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.2
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.2
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.3
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.3
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.4
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.4
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires_end_transmission
		default_hide_option = yes
		trigger = {
			or = {
				has_country_flag = human_fallen_empires.53.0.0
				has_country_flag = human_fallen_empires.53.0.1
				has_country_flag = human_fallen_empires.53.0.2
				has_country_flag = human_fallen_empires.53.0.3
				has_country_flag = human_fallen_empires.53.0.4
			}
		}
		hidden_effect = {
			# attack home of light
			if = {
				limit = {
					or = {
						has_country_flag = human_fallen_empires.53.0.0
						has_country_flag = human_fallen_empires.53.0.1
						has_country_flag = human_fallen_empires.53.0.2
					}
				}
				remove_country_flag = human_fallen_empires.53.0.0
				remove_country_flag = human_fallen_empires.53.0.1
				remove_country_flag = human_fallen_empires.53.0.2
				event_target:human_fallen_empires_varelse_fleet = {
					human_fallen_empires_effect_varelse_fleet_attack_home_of_light = yes
				}
			}
			# found new home
			if = {
				limit = {
					or = {
						has_country_flag = human_fallen_empires.53.0.3
						has_country_flag = human_fallen_empires.53.0.4
					}
				}
				remove_country_flag = human_fallen_empires.53.0.3
				remove_country_flag = human_fallen_empires.53.0.4
				event_target:human_fallen_empires_varelse_fleet = {
					human_fallen_empires_effect_varelse_fleet_find_new_home = yes
				}
			}
		}
	}
}

# varelse section 100 - 150
# varlse colony after curvey 100
ship_event = {
	id = human_fallen_empires.100
	title = human_fallen_empires.100.name
	desc = human_fallen_empires.100.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	location = root
	is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_ai = no
		}
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_varelse_colony
		}
		exists = from.owner
		from.owner = {
			is_country_type = primitive
		}
	}

	option = {
		name = human_fallen_empires.100.0
	}
}

# observation outpost events
# varelse mehanicus
# start event
planet_event = {
	id = human_fallen_empires.101
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_observation_outpost = yes
	}

	immediate = {
		set_global_flag = human_fallen_empires_varelse_mehanicus
		save_event_target_as = human_fallen_empires_varelse_colony
		observation_outpost_owner = {
			country_event = {
				id = human_fallen_empires.102
			}
		}
	}
}

# choice
country_event = {
	id = human_fallen_empires.102
	title = human_fallen_empires.102.name
	desc = human_fallen_empires.102.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	#lets go to artifact
	option = {
		name = human_fallen_empires.102.0
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.103 days = 12 random = 4
			}
		}
		custom_tooltip = human_fallen_empires.102.0.tooltip
	}
	# lets go to factory
	option = {
		name = human_fallen_empires.102.1
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.105 days = 10 random = 5
			}
		}
		custom_tooltip = human_fallen_empires.102.1.tooltip
	}
	# lets revolt (materialist)
	option = {
		name = human_fallen_empires.102.2
		trigger = {
			is_materialist = yes
		}
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.107 days = 100 random = 20
			}
		}
	}
	# lets infiltrat
	option = {
		name = human_fallen_empires.102.3
		trigger = {
			from = {
				observation_outpost = {
					has_mission = covert_infiltration
				}
			}
		}
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.108 days = 10 random = 20
			}
		}
	}
	option = {
		name = human_fallen_empires.102.4
	}
}

# lets go to artifact
country_event = {
	id = human_fallen_empires.103
	title = human_fallen_empires.103.name
	desc = human_fallen_empires.103.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	option = {
		name = human_fallen_empires_at_the_sreen
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.104
			}
		}
	}
}

# history of varelse
country_event = {
	id = human_fallen_empires.104
	title = human_fallen_empires.104.name
	desc = human_fallen_empires.104.desc
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		room = human_fallen_empires_varelse_room
	}

	option = {
		name = human_fallen_empires.104.0
		response_text = human_fallen_empires.104.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.104.1
		response_text = human_fallen_empires.104.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.104.2
		response_text = human_fallen_empires.104.2.response
		default_hide_option = yes
		human_fallen_empires_effect_add_physics_research.2 = yes
	}
}

# lets go to factory
country_event = {
	id = human_fallen_empires.105
	title = human_fallen_empires.105.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.105.desc.0
				is_xenophobe = no
			}
			success_text = {
				text = human_fallen_empires.105.desc.1
				is_xenophobe = yes
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_cityscape
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				is_xenophobe = yes
			}
			event_target:human_fallen_empires_varelse_colony = {
				owner = {
					human_fallen_empires_effect_primitive_down = yes
				}
				every_tile = {
					limit = {
						has_building = yes
					}
					set_ruined = yes
				}
				random_pop = {
					kill_pop = yes
				}
				random_pop = {
					kill_pop = yes
				}
			}
		}
	}

	option = {
		name = human_fallen_empires_good_job
		trigger = {
			is_xenophobe = no
		}
		human_fallen_empires_effect_add_engineering_research.2 = yes
	}
	option = {
		name = human_fallen_empires.105.1
		trigger = {
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_middle = yes
		human_fallen_empires_effect_add_engineering_research.2 = yes
		human_fallen_empires_effect_add_society_research.1 = yes
	}
}

# materialist result lets revolt
country_event = {
	id = human_fallen_empires.107
	title = human_fallen_empires.107.name
	desc = human_fallen_empires.107.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_planetary_riot
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_colony = {
			owner = {
				human_fallen_empires_effect_primitive_up = yes
				country_remove_ethic = ethic_spiritualist
				country_add_ethic = ethic_materialist
			}
		}
	}

	option = {
		name = human_fallen_empires.107.0
		trigger = {
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_high = yes
		human_fallen_empires_effect_add_society_research.1 = yes
	}
}

# lets infiltrate
country_event = {
	id = human_fallen_empires.108
	title = human_fallen_empires.108.name
	desc = human_fallen_empires.108.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_primitive_civilization
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_colony = {
			observation_outpost = {
				add_mission_progress = 0.3
			}
		}
	}

	option = {
		name = human_fallen_empires_good_job
	}
}

# memorial section 150 - 350
# pyramid events 150 - 200
# start
planet_event = {
	id = human_fallen_empires.150
	title = human_fallen_empires.150.name
	desc = human_fallen_empires.150.desc
	picture = GFX_evt_human_fallen_empires_building_thoth_temple_2
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		is_planet_class = pc_human_fallen_empires_memorial
		exists = owner
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_planet_pyramid
	}

	option = {
		name = human_fallen_empires.150.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_project_pyramid
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_project_pyramid
			location = root
			owner = root.owner
		}
	}
	option = {
		name = human_fallen_empires_not_interested
	}
}

# golocube
ship_event = {
	id = human_fallen_empires.151
	title = human_fallen_empires.151.name
	desc = human_fallen_empires.151.desc
	picture = GFX_evt_human_fallen_empires_building_thoth_temple_2
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	option = {
		name = human_fallen_empires.151.0
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.152
				}
				set_country_flag = human_fallen_empires_has_event.151
			}
		}
	}
}

# memorial story
country_event = {
	id = human_fallen_empires.152
	title = human_fallen_empires.152.name
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				human_fallen_empires.152.0 = {
					text = human_fallen_empires.152.desc.1
				}
				default = {
					text = human_fallen_empires.152.desc.0
				}
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_memorial_story_room
	}

	option = {
		name = human_fallen_empires.152.0
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.152.0
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.152.0
			country_event = {
				id = human_fallen_empires.152
			}
		}
	}
	option = {
		name = human_fallen_empires.152.1
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		default_hide_option = yes
		hidden_effect = {
			create_leader = {
				type = governor
				species = event_target:human_fallen_empires_egypt_species
				name = random
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
			}
		}
	}
	option = {
		name = human_fallen_empires.152.2
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = scientist
				species = event_target:human_fallen_empires_egypt_species
				name = random
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
			}
		}
	}
	option = {
		name = human_fallen_empires.152.3
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = admiral
				species = event_target:human_fallen_empires_egypt_species
				name = random
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
			}
		}
	}
	option = {
		name = human_fallen_empires.152.4
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = general
				species = event_target:human_fallen_empires_egypt_species
				name = random
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
			}
		}
	}
	#	option = {
	#		name = human_fallen_empires.152.5
	#		trigger = {
	#			has_country_flag = human_fallen_empires.152.0
	#		}
	#		hidden_effect = {
	#		# добавить технологию
	#		}
	#	}

	after = {
		remove_country_flag = human_fallen_empires.152
	}
}

# obelisk
ship_event = {
	id = human_fallen_empires.153
	title = human_fallen_empires.153.name
	desc = human_fallen_empires.153.desc
	picture = GFX_evt_human_fallen_empires_obelisk
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.153
		}
		event_target:human_fallen_empires_memorial_planet = {
			create_country = {
				name = "Gnosis"
				type = faction
				effect = {
					establish_communications_no_message = root.owner
				}
			}
			create_species = {
				name = "Gnosis"
				class = random_non_machine
				portrait = random
				traits = random
			}
			# запилить новый тип армии
			create_army = {
				name = "Gnosis"
				owner = last_created
				species = last_created
				type = "titanic_guardian_army"
			}
			create_army = {
				name = "Gnosis"
				owner = last_created
				species = last_created
				type = "titanic_assault_army"
			}
			create_army = {
				name = "Gnosis"
				owner = last_created
				species = last_created
				type = "titanic_assault_army"
			}
		}
	}

	option = {
		name = human_fallen_empires.153.0
	}
}

# mutant cloud
ship_event = {
	id = human_fallen_empires.154
	title = human_fallen_empires.154.name
	desc = human_fallen_empires.154.desc
	picture = GFX_evt_human_fallen_empires_city_cloud
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.154
		}
		event_target:human_fallen_empires_memorial_planet = {
			planet_event = {
				id = human_fallen_empires.155
				days = 15
			}
		}
	}

	option = {
		name = human_fallen_empires.155.0
	}
}

# lets mutate
planet_event = {
	id = human_fallen_empires.155
	title = human_fallen_empires.154.name
	desc = human_fallen_empires.155.desc
	picture = GFX_evt_human_fallen_empires_city_cloud
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		every_owned_pop = {
			limit = {
				#is_robot_pop = no
			}
			modify_species = {
		 		species = this
		 		add_trait = human_fallen_empires_species_trait_test
		 	}
		}
		random_owned_pop = {
			limit = {
				has_trait = human_fallen_empires_species_trait_test
			}
			species = {
				mutate_species = yes
			}
		}
		every_owned_pop = {
			limit = {
				has_trait = human_fallen_empires_species_trait_test
			}
			modify_species = {
		 		species = this
		 		remove_trait = human_fallen_empires_species_trait_test
		 	}
		}
	}

	option = {
		name = human_fallen_empires.155.0
		custom_tooltip = human_fallen_empires.155.tooltip
	}
}

# tomb
ship_event = {
	id = human_fallen_empires.156
	title = human_fallen_empires.156.name
	desc = human_fallen_empires.156.desc
	picture = GFX_evt_human_fallen_empires_strange_tech
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.156
		}
	}

	option = {
		name = human_fallen_empires.156.0
		hidden_effect = {
			event_target:human_fallen_empires_memorial_planet = {
				random_list = {
					30 = {
						add_modifier = {
							modifier = human_fallen_empires_tomb_happy
							days = 360
						}
					}
					70 = {
						add_modifier = {
							modifier = human_fallen_empires_tomb_unhappy
							days = 360
						}
					}
				}
			}
		}
	}
}

# military warehouse events 200 - 250
# start
planet_event = {
	id = human_fallen_empires.200
	title = human_fallen_empires.200.name
	desc = human_fallen_empires.200.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		is_planet_class = pc_human_fallen_empires_memorial
		exists = owner
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_military_warehouse_planet
	}

	option = {
		name = human_fallen_empires.200.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_project_military_warehouse
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_project_military_warehouse
			location = root
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires_not_interested
	}
}

# defense system
ship_event = {
	id = human_fallen_empires.201
	title = human_fallen_empires.201.name
	desc = human_fallen_empires.201.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.201
		}
	}

	option = {
		name = human_fallen_empires.201.0
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_army_planet_defense_damage_mult
				days = -1
			}
		}
	}
}

# abandoned armory
ship_event = {
	id = human_fallen_empires.202
	title = human_fallen_empires.202.name
	desc = human_fallen_empires.202.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.202
		}
	}

	option = {
		name = human_fallen_empires.202.0
		owner = {
			add_modifier = {
				modifier = human_fallen_empires_army_attack_damage_mult
				days = -1
			}
		}
	}
}

# abandoned librariy
ship_event = {
	id = human_fallen_empires.203
	title = human_fallen_empires.203.name
	desc = human_fallen_empires.203.desc
	picture = GFX_evt_human_fallen_empires_library_old
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.203
		}
	}

	option = {
		name = human_fallen_empires.203.0
		owner = {
			add_modifier = {
				modifier = human_fallen_empires_army_defense_damage_mult
				days = -1
			}
		}
	}
}

# abandoned military academy
ship_event = {
	id = human_fallen_empires.204
	title = human_fallen_empires.204.name
	desc = human_fallen_empires.204.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.204
		}
	}

	option = {
		name = human_fallen_empires.204.0
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_army_academy
				days = -1
			}
		}
	}
}

# explosion of the warehouse
country_event = {
	id = human_fallen_empires.205
	title = human_fallen_empires.205.name
	desc = {
		trigger = {
			# scientist survived
			success_text = {
				text = human_fallen_empires.205.desc.0
				has_country_flag = human_fallen_empires.205.0
			}
			# scientist wounded
			success_text = {
				text = human_fallen_empires.205.desc.1
				has_country_flag = human_fallen_empires.205.1
			}
			# scientist recovered
			success_text = {
				text = human_fallen_empires.205.desc.2
				has_country_flag = human_fallen_empires.205.2
			}
			# scientist dead
			success_text = {
				text = human_fallen_empires.205.desc.3
				has_country_flag = human_fallen_empires.205.3
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_explosion
	show_sound = event_ship_explosion
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		set_country_flag = human_fallen_empires_has_event.205
		if = {
			limit = {
				has_country_flag = human_fallen_empires.205.1
			}
			event_target:human_fallen_empires_ship = {
				fleet = {
					exile_leader_as = human_fallen_empires_scientist_wounded
				}
			}
		}
		if = {
			limit = {
				has_country_flag = human_fallen_empires.205.2
			}
			if = {
				limit = {
					exists = event_target:human_fallen_empires_ship
				}
				event_target:human_fallen_empires_ship = {
					fleet = {
						set_leader = human_fallen_empires_scientist_wounded
						leader = {
							save_event_target_as = human_fallen_empires_205_scientist
						}
					}
				}
				else = {
					create_fleet = {
						name = "Science Ship"
						effect = {
							set_owner = root
							create_ship = {
								name = random
								random_existing_design = science
							}
							set_location = root.capital_scope
							set_leader = human_fallen_empires_scientist_wounded
							leader = {
								save_event_target_as = human_fallen_empires_205_scientist
								unassign_leader = this
							}
							delete_fleet = this
						}
					}
				}
			}
		}
		if = {
			limit = {
				has_country_flag = human_fallen_empires.205.3
			}
			event_target:human_fallen_empires_ship = {
				fleet = {
					kill_leader = {
						type = scientist
						show_notification = no
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.205.0
		trigger = {
			has_country_flag = human_fallen_empires.205.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.0
		}
	}
	option = {
		name = human_fallen_empires.205.1
		trigger = {
			has_country_flag = human_fallen_empires.205.1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.1
			set_country_flag = human_fallen_empires.205.2
			country_event = {
				id = human_fallen_empires.205
				days = 60
				random = 120
			}
		}
	}
	option = {
		name = human_fallen_empires.205.2
		trigger = {
			has_country_flag = human_fallen_empires.205.2
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.2
		}
	}
	option = {
		name = human_fallen_empires.205.3
		trigger = {
			has_country_flag = human_fallen_empires.205.3
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.3
		}
	}
}

# scientific bonus of the warehouse
ship_event = {
	id = human_fallen_empires.206
	title = human_fallen_empires.206.name
	desc = human_fallen_empires.206.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.206
		}
	}

	option = {
		name = human_fallen_empires.206.0
		owner = {
			human_fallen_empires_effect_add_engineering_research.3 = yes
			set_country_flag = human_fallen_empires_military_warehouse_events_6
		}
	}
}

# dr moro
ship_event = {
	id = human_fallen_empires.207
	title = human_fallen_empires.207.name
	desc = human_fallen_empires.207.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_alien_nature
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.207
		}
	}

	option = {
		name = human_fallen_empires.207.0
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_tomb_unhappy
				days = 360
			}
		}
	}
}

# found cruiser 250 - 300
# start
planet_event = {
	id = human_fallen_empires.250
	title = human_fallen_empires.250.name
	desc = human_fallen_empires.250.desc
	picture = GFX_evt_human_fallen_empires_ship_old
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		is_planet_class = pc_human_fallen_empires_memorial
		exists = owner
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_found_cruiser_planet
	}

	option = {
		name = human_fallen_empires.250.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_project_found_cruiser_planet
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_project_found_cruiser
			location = root
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires_not_interested
	}
}

# rotten skeleton
ship_event = {
	id = human_fallen_empires.251
	title = human_fallen_empires.251.name
	desc = human_fallen_empires.251.desc
	picture = GFX_evt_human_fallen_empires_ship_old
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.251
		}
	}

	option = {
		name = human_fallen_empires.251.0
		owner = {
			human_fallen_empires_effect_add_minerals.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.251.1
		owner = {
			human_fallen_empires_effect_add_energy.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.251.2
		owner = {
			human_fallen_empires_effect_add_physics_research.2 = yes
		}
	}
}

# explosion on the cruiser scientist dead
ship_event = {
	id = human_fallen_empires.252
	title = human_fallen_empires.252.name
	desc = human_fallen_empires.252.desc
	picture = GFX_evt_archaeological_dig
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.252
		}
	}

	option = {
		name = human_fallen_empires.252.0
		hidden_effect = {
			kill_leader = {
				type = scientist show_notification = no
			}
		}
	}
}

# runaway cruiser
ship_event = {
	id = human_fallen_empires.253
	title = human_fallen_empires.253.name
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.253.desc.0
				owner = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
			success_text = {
				text = human_fallen_empires.253.desc.1
				owner = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ship
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.253
		}
	}

	immediate = {
		create_country = {
			name = "Cruiser"
			type = neutral_faction
			effect = {
				establish_communications_no_message = root.owner
				#		set_faction_hostility = {
				#			set_hostile = no
				#		}
			}
		}
		create_fleet = {
			name = "Cruiser"
			effect = {
				save_event_target_as = human_fallen_empires_cruiser # убрать, если работает owner
				set_owner = last_created_country
				create_ship = {
					name = random
					design = Set
					graphical_culture = "mammalian_01"
					prefix = no
				}
				set_location = root
				set_fleet_stance = aggressive
				queue_actions = {
					find_closest_system = {
						trigger = {
							id = human_fallen_empires.253.trigger.0
							any_planet = {
								has_planet_flag = human_fallen_empires_varelse_colony
							}
						}
						found_system = {
							move_to = this
						}
					}
					find_closest_planet = {
						trigger = {
							id = human_fallen_empires.253.trigger.1
							has_planet_flag = human_fallen_empires_varelse_colony
						}
						found_planet = {
							orbit_planet = this
							effect = {
								id = human_fallen_empires.253.effect.0
								owner = {
									set_faction_hostility = {
										set_hostile = yes
									}
								}
							}
							repeat = {
								wait = 100
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.253.0
	}
}

# cruiser became aggressive
ship_event = {
	id = human_fallen_empires.254
	title = human_fallen_empires.254.name
	desc = human_fallen_empires.254.desc
	picture = GFX_evt_human_fallen_empires_ship
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.254
		}
		create_country = {
			name = "Mad Cruiser"
			type = faction
			effect = {
				#		set_faction_hostility = {
				#			set_hostile = yes
				#		}
				establish_communications_no_message = root.owner
			}
		}
		create_fleet = {
			name = "Mad Cruiser"
			effect = {
				set_owner = last_created_country
				create_ship = {
					name = random
					design = Set
					graphical_culture = "mammalian_01"
					prefix = no
				}
				set_fleet_stance = aggressive
				set_location = root
				queue_actions = {
					repeat = {
						find_closest_system = {
							trigger = {
								id = human_fallen_empires.254.trigger.0
								any_planet = {
									has_orbital_station = yes
									exists = controller
									controller = {
										is_country = root.owner
									}
								}
							}
							found_system = {
								move_to = THIS
							}
						}
						find_closest_planet = {
							trigger = {
								id = human_fallen_empires.254.trigger.1
								has_orbital_station = yes
								exists = controller
								controller = {
									is_country = root.owner
								}
							}
							found_planet = {
								orbit_planet = THIS
								wait = {
									duration = 20
								}
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.254.0
	}
}

# love is
ship_event = {
	id = human_fallen_empires.255
	title = human_fallen_empires.255.name
	desc = human_fallen_empires.255.desc
	picture = GFX_evt_human_fallen_empires_ship_new
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.255
		}
		create_fleet = {
			name = "Marvin"
			effect = {
				set_owner = event_target:human_fallen_empires_egypt
				create_ship = {
					name = "Marvin"
					random_existing_design = battleship
				}
				last_created_ship = {
					add_modifier = {
						modifier = human_fallen_empires_marvin_ship
						days = -1
					}
				}
				set_owner = root.owner
				set_location = root
				set_fleet_stance = aggressive
			}
		}
	}

	option = {
		name = human_fallen_empires.255.0
	}
}


# sputnik 300 - 350
# start
planet_event = {
	id = human_fallen_empires.300
	title = human_fallen_empires.300.name
	desc = human_fallen_empires.300.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		is_planet_class = pc_human_fallen_empires_memorial
		exists = owner
		owner = {
			nand = {
				has_country_flag = human_fallen_empires_has_event.301
				has_country_flag = human_fallen_empires_has_event.302
				has_country_flag = human_fallen_empires_has_event.304
			}
		}
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_sputnik_planet
	}

	option = {
		name = human_fallen_empires.300.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_sputnik_project
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_sputnik_project
			location = root
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires_not_interested
	}
}

# bonus to the sensors
ship_event = {
	id = human_fallen_empires.301
	title = human_fallen_empires.301.name
	desc = human_fallen_empires.301.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.301
		}
	}

	option = {
		name = human_fallen_empires.301.0
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_planet_sensor_range_mult
				days = -1
			}
		}
	}
}

# go to another events
ship_event = {
	id = human_fallen_empires.302
	title = human_fallen_empires.302.name
	desc = human_fallen_empires.302.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.302
		}
	}

	option = {
		name = human_fallen_empires.302.0
		hidden_effect = {
			event_target:human_fallen_empires_memorial_planet = {
				random_list = {
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_planet_pyramid
						}
						planet_event = {
							id = human_fallen_empires.150 days = 1
						}
					}
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_military_warehouse_planet
						}
						planet_event = {
							id = human_fallen_empires.200 days = 1
						}
					}
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_found_cruiser_planet
						}
						planet_event = {
							id = human_fallen_empires.250 days = 1
						}
					}
					1 = {
						root = {
							ship_event = {
								id = human_fallen_empires.303 days = 15
							}
						}
					}
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.302.1
	}
}

# go to nothing
ship_event = {
	id = human_fallen_empires.303
	title = human_fallen_empires.303.name
	desc = human_fallen_empires.303.desc
	picture = GFX_evt_human_fallen_empires_satellite_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	option = {
		name = human_fallen_empires.303.0
		owner = {
			human_fallen_empires_effect_add_engineering_research.1 = yes
		}
	}
}

# engineering bonus
ship_event = {
	id = human_fallen_empires.304
	title = human_fallen_empires.304.name
	desc = human_fallen_empires.304.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.304
		}
	}

	option = {
		name = human_fallen_empires.304.0
		owner = {
			human_fallen_empires_effect_add_engineering_research.3 = yes
		}
	}
}

# find sol 350
ship_event = {
	id = human_fallen_empires.350
	title = human_fallen_empires.350.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.350.desc.0.0
				owner = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			fail_text = {
				text = human_fallen_empires.350.desc.0.1
				owner = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			success_text = {
				text = human_fallen_empires.350.desc.1.0
				from = {
					nor = {
						has_star_flag = nuked_sol
						any_planet = {
							exists = owner
							owner = {
								is_country_type = default
							}
						}
					}
				}
			}
			success_text = {
				text = human_fallen_empires.350.desc.1.1
				from = {
					has_star_flag = nuked_sol
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_sol_system
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_star_flag = human_fallen_empires_sol_target@root.owner
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_find_sol
		}
	}

	immediate = {
		from = {
			remove_star_flag = human_fallen_empires_sol_target@root.owner
		}
		owner = {
			end_event_chain = human_fallen_empires_chain_find_sol
		}
	}

	option = {
		name = human_fallen_empires.350.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			from = {
				not = {
					has_star_flag = nuked_sol
				}
			}
		}
		owner = {
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.350.1
		trigger = {
			from = {
				has_star_flag = nuked_sol
			}
		}
		owner = {
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.350.1
		trigger = {
			owner = {
				is_xenophile = yes
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			from = {
				not = {
					has_star_flag = nuked_sol
				}
			}
		}
		owner = {
			human_fallen_empires_effect_xenophile_attraction_low = yes
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.350.2
		trigger = {
			owner = {
				is_xenophile = yes
				human_fallen_empires_trigger_is_authoritarian = yes
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			from = {
				not = {
					has_star_flag = nuked_sol
				}
			}
		}
		owner = {
			human_fallen_empires_effect_xenophile_attraction_low = yes
			human_fallen_empires_effect_authoritarian_attraction_low = yes
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
}

# abort chain if contacted with sol owner 351, not enabled for now
country_event = {
	id = human_fallen_empires.351
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_event_chain = human_fallen_empires_chain_find_sol
		exists = from
		from = {

		}
	}

	immediate = {
		end_event_chain = human_fallen_empires_chain_find_sol
		random_system = {
			limit = {
				has_star_flag = human_fallen_empires_sol_target@root
			}
			remove_star_flag = human_fallen_empires_sol_target@root
		}
	}
}

# copernicus event 355 - 365
# enter system
ship_event = {
	id = human_fallen_empires.355
	title = human_fallen_empires.355.name
	desc = {
		trigger = {
			text = human_fallen_empires.355.desc.0
			fail_text = {
				text = human_fallen_empires.355.desc.1.0
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_owner
				}
			}
			success_text = {
				text = human_fallen_empires.355.desc.1.1
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_owner
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_star_flag = human_fallen_empires_copernicus
		}
	}

	immediate = {
		from = {
			save_global_event_target_as = human_fallen_empires_copernicus
			random_system_planet = {
				limit = {
					has_planet_flag = human_fallen_empires_copernicus.0
				}
				if = {
					limit = {
						exists = owner
						owner = {
							is_country_type = default
						}
					}
					save_event_target_as = human_fallen_empires_copernicus_owner
					# set flag if stop event chain
					root.owner = {
						set_country_flag = human_fallen_empires_copernicus_has_owner
					}
					else = {
						begin_event_chain = {
							event_chain = human_fallen_empires_chain_copernicus
							target = root.owner
						}
						if = {
							limit = {
								owner = {
									is_country_type = primitive
								}
							}
							owner = {
								#establish_communications_no_message = root.owner
								species = {
									save_global_event_target_as = human_fallen_empires_copernicus_species
								}
							}
							root.owner = {
								set_country_flag = human_fallen_empires_copernicus_has_primitive
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.355.0
		trigger = {
			owner = {
				has_event_chain = human_fallen_empires_chain_copernicus
			}
		}
		tooltip = {
			begin_event_chain = {
				event_chain = human_fallen_empires_chain_copernicus
				target = root.owner
			}
		}
	}
	option = {
		name = human_fallen_empires.355.1
		trigger = {
			owner = {
				not = {
					has_event_chain = human_fallen_empires_chain_copernicus
				}
			}
		}
		tooltip = {
			owner = {
				end_event_chain = human_fallen_empires_chain_copernicus
			}
		}
	}
}

# scan planet
ship_event = {
	id = human_fallen_empires.356
	title = human_fallen_empires.356.name
	desc = {
		trigger = {
			text = human_fallen_empires.356.desc.0
			success_text = {
				text = human_fallen_empires.356.desc.1
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_primitive
				}
			}
			success_text = {
				text = human_fallen_empires.356.desc.2
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_primitive
					has_completed_event_chain_counter = {
						event_chain = human_fallen_empires_chain_copernicus
						counter = human_fallen_empires_scans
					}
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_copernicus.0
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_copernicus
		}
	}

	immediate = {
		owner = {
			add_event_chain_counter = {
				event_chain = human_fallen_empires_chain_copernicus
				counter = human_fallen_empires_scans
				amount = 1
			}
		}
	}

	option = {
		name = INTERESTING
		hidden_effect = {
			owner = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = human_fallen_empires_chain_copernicus
							counter = human_fallen_empires_scans
						}
					}
					country_event = {
						id = human_fallen_empires.359
						days = 5
					}
				}
			}
		}
	}
}

# scan asteroid
ship_event = {
	id = human_fallen_empires.357
	title = human_fallen_empires.357.name
	desc = {
		trigger = {
			text = human_fallen_empires.357.desc.0
			success_text = {
				text = human_fallen_empires.357.desc.1
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_primitive
					has_completed_event_chain_counter = {
						event_chain = human_fallen_empires_chain_copernicus
						counter = human_fallen_empires_scans
					}
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_copernicus.1
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_copernicus
		}
	}

	immediate = {
		owner = {
			add_event_chain_counter = {
				event_chain = human_fallen_empires_chain_copernicus
				counter = human_fallen_empires_scans
				amount = 1
			}
		}
	}

	option = {
		name = CURIOUS
		hidden_effect = {
			owner = {
				remove_country_flag = human_fallen_empires_has_event.356
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = human_fallen_empires_chain_copernicus
							counter = human_fallen_empires_scans
						}
					}
					country_event = {
						id = human_fallen_empires.359
						days = 5
					}
				}
			}
		}
	}
}

# scan star
ship_event = {
	id = human_fallen_empires.358
	title = human_fallen_empires.358.name
	desc = human_fallen_empires.358.desc
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_copernicus.2
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_copernicus
		}
	}

	option = {
		name = ASTOUNDING
	}
}

# start project
country_event = {
	id = human_fallen_empires.359
	title = human_fallen_empires.359.name
	desc = human_fallen_empires.359.desc
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	is_triggered_only = yes

	trigger = {
		not = {
			has_special_project = human_fallen_empires_project_copernicus
		}
	}

	immediate = {
		enable_special_project = {
			name = human_fallen_empires_project_copernicus
			location = root.capital_scope
			owner = root
		}
	}


	option = {
		name = human_fallen_empires.359.0
		tooltip = {
			enable_special_project = {
				name = human_fallen_empires_project_copernicus
				location = root.capital_scope
				owner = root
			}
		}
	}
}

# project complete
country_event = {
	id = human_fallen_empires.360
	title = human_fallen_empires.360.name
	desc = {
		trigger = {
			text = human_fallen_empires.360.desc.0
			success_text = {
				text = human_fallen_empires.360.desc.1.0
				has_country_flag = human_fallen_empires_copernicus_has_primitive
			}
			fail_text = {
				text = human_fallen_empires.360.desc.1.1
				has_country_flag = human_fallen_empires_copernicus_has_primitive
			}
			success_text = {
				text = human_fallen_empires.360.desc.2.0
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			fail_text = {
				text = human_fallen_empires.360.desc.2.1
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			success_text = {
				text = human_fallen_empires.360.desc.3.0
				is_xenophile = yes
			}
			success_text = {
				text = human_fallen_empires.360.desc.3.1
				is_xenophobe = yes
			}
			success_text = {
				text = human_fallen_empires.360.desc.4
				has_country_flag = human_fallen_empires_copernicus_has_primitive
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	is_triggered_only = yes

	option = {
		name = AMAZING
		human_fallen_empires_effect_add_influence.2 = yes
		end_event_chain = human_fallen_empires_chain_copernicus
		hidden_effect = {
			remove_country_flag = human_fallen_empires_copernicus_has_primitive
		}
	}
}

# observation outpost event
# start
planet_event = {
	id = human_fallen_empires.361
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_observation_outpost = yes
		observation_outpost = {
			or = {
				has_mission = specimen_collection
				has_mission = passive_observation
				has_mission = technological_enlightenment_1
				has_mission = technological_enlightenment_2
				has_mission = technological_enlightenment_3
				has_mission = technological_enlightenment_4
				has_mission = technological_enlightenment_5
				has_mission = technological_enlightenment_6
				has_mission = technological_enlightenment_7
				has_mission = technological_enlightenment_8
				has_mission = technological_enlightenment_9
			}
		}
		not = {
			has_planet_flag = human_fallen_empires_has_event.362
		}
		observation_outpost_owner = {
			not = {
				has_country_flag = human_fallen_empires_has_event.362
			}
		}
	}

	immediate = {
		observation_outpost_owner = {
			country_event = {
				id = human_fallen_empires.362
			}
		}
	}
}

country_event = {
	id = human_fallen_empires.362
	title = human_fallen_empires.362.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.362.desc.0
				from = {
					observation_outpost = {
						has_mission = passive_observation
					}
				}
			}
			success_text = {
				text = human_fallen_empires.362.desc.1
				from = {
					observation_outpost = {
						has_mission = specimen_collection
					}
				}
			}
			success_text = {
				text = human_fallen_empires.362.desc.2
				from = {
					observation_outpost = {
						or = {
							has_mission = technological_enlightenment_1
							has_mission = technological_enlightenment_2
							has_mission = technological_enlightenment_3
							has_mission = technological_enlightenment_4
							has_mission = technological_enlightenment_5
							has_mission = technological_enlightenment_6
							has_mission = technological_enlightenment_7
							has_mission = technological_enlightenment_8
							has_mission = technological_enlightenment_9
						}
					}
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	is_triggered_only = yes

	immediate = {
		set_country_flag = human_fallen_empires_has_event.362
	}

	# return
	option = {
		name = human_fallen_empires.362.0
		trigger = {
			is_xenophobe = no
			from = {
				observation_outpost = {
					has_mission = passive_observation
				}
			}
		}
		human_fallen_empires_effect_xenophile_attraction_middle = yes
	}
	# use
	option = {
		name = human_fallen_empires.362.1
		trigger = {
			is_xenophile = no
			from = {
				observation_outpost = {
					has_mission = passive_observation
				}
			}
		}
		human_fallen_empires_effect_add_engineering_research.3 = yes
		hidden_effect = {
			from = {
				set_planet_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
	# good job
	option = {
		name = human_fallen_empires_good_job
		trigger = {
			from = {
				observation_outpost = {
					has_mission = specimen_collection
				}
			}
		}
		human_fallen_empires_effect_add_engineering_research.3 = yes
		hidden_effect = {
			from = {
				set_planet_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
	option = {
		name = human_fallen_empires_good_job
		trigger = {
			from = {
				observation_outpost = {
					or = {
						has_mission = technological_enlightenment_1
						has_mission = technological_enlightenment_2
						has_mission = technological_enlightenment_3
						has_mission = technological_enlightenment_4
						has_mission = technological_enlightenment_5
						has_mission = technological_enlightenment_6
						has_mission = technological_enlightenment_7
						has_mission = technological_enlightenment_8
						has_mission = technological_enlightenment_9
					}
				}
			}
		}
		human_fallen_empires_effect_add_engineering_research.3 = yes
		from = {
			observation_outpost = {
				add_mission_progress = 0.5
			}
		}
		hidden_effect = {
			from = {
				set_planet_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
}

# then gain planet
planet_event = {
	id = human_fallen_empires.363
	title = human_fallen_empires.362.name
	desc = human_fallen_empires.363.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	is_triggered_only = yes

	trigger = {
		has_planet_flag = human_fallen_empires_too_ideal_planet
		not = {
			has_planet_flag = human_fallen_empires_has_event.362
		}
		exists = owner
	}

	immediate = {
		set_planet_flag = human_fallen_empires_has_event.362
	}

	option = {
		name = human_fallen_empires_good_job
		owner = {
			human_fallen_empires_effect_add_engineering_research.3 = yes
			hidden_effect = {
				set_country_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
}

# ahet section 400 - 401
# ahet colonys after survey
# сolony 1 400
ship_event = {
	id = human_fallen_empires.400
	title = human_fallen_empires.400.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.400.desc.0
				has_country_flag = human_fallen_empires_ahet_found
			}
			fail_text = {
				text = human_fallen_empires.400.desc.1
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ship_old_jungle
	location = from

	is_triggered_only = yes

	trigger = {
		from = {
			has_planet_flag = human_fallen_empires_ahet_colony_0
		}
		from.owner = {
			is_country_type = primitive
		}
	}

	option = {
		name = human_fallen_empires.400.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	option = {
		name = human_fallen_empires.400.1
		trigger = {
			owner = {
				is_materialist = no
			}
		}
	}
	option = {
		name = human_fallen_empires.400.2
		trigger = {
			owner = {
				is_materialist = yes
			}
		}
		owner = {
			human_fallen_empires_effect_materialist_attraction_low = yes
		}
	}
	after = {
		owner = {
			set_country_flag = human_fallen_empires_ahet_found
		}
	}
}

# colony 2 401
ship_event = {
	id = human_fallen_empires.401
	title = human_fallen_empires.401.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.401.desc.0
				has_country_flag = human_fallen_empires_ahet_found
			}
			fail_text = {
				text = human_fallen_empires.401.desc.1
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ship_old_jungle_2
	location = from

	is_triggered_only = yes

	trigger = {
		from = {
			has_planet_flag = human_fallen_empires_ahet_colony_1
		}
		from.owner = {
			is_country_type = primitive
		}
	}

	option = {
		name = human_fallen_empires.401.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	option = {
		name = human_fallen_empires.401.1
		trigger = {
			owner = {
				is_xenophile = yes
			}
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
	}
	option = {
		name = human_fallen_empires.401.2
		trigger = {
			owner = {
				is_xenophobe = yes
			}
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
	}
	option = {
		name = human_fallen_empires.401.3
		trigger = {
			owner = {
				is_xenophile = no
				is_xenophobe = no
			}
		}
	}
	after = {
		owner = {
			set_country_flag = human_fallen_empires_ahet_found
		}
	}
}

# ahet home events 410 - 413
# enter system
ship_event = {
	id = human_fallen_empires.410
	title = human_fallen_empires.410.name
	desc = human_fallen_empires.410.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		from = {
			has_star_flag = human_fallen_empires_ahet_home
		}
		exists = owner
		owner = {
			is_ai = no
		}
	}

	immediate = {
		begin_event_chain = {
			event_chain = human_fallen_empires_chain_ahet_home
			target = root.owner
		}
	}

	option = {
		name = human_fallen_empires.410.0
	}
}

# explore planet
ship_event = {
	id = human_fallen_empires.411
	title = human_fallen_empires.411.name
	desc = human_fallen_empires.411.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		from = {
			has_planet_flag = human_fallen_empires_ahet_home
		}
		owner = {
			is_ai = no
		}
	}

	immediate = {
		from = {
			save_event_target_as = human_fallen_empires_target_ahet_home
		}
	}

	option = {
		name = human_fallen_empires.411.0
		enable_special_project = {
			name = human_fallen_empires_project_ahet_home
			location = from
			owner = root.owner
		}
	}
	option = {
		name = human_fallen_empires.411.1
		owner = {
			end_event_chain = human_fallen_empires_chain_ahet_home
		}
	}
}

# project complete remove scientist
ship_event = {
	id = human_fallen_empires.412
	title = human_fallen_empires.412.name
	desc = human_fallen_empires.412.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.412.0
		hidden_effect = {
			leader = {
				exile_leader_as = human_fallen_empires_412_scientist
			}
			owner = {
				country_event = {
					id = human_fallen_empires.413 days = 18250 random = 3600
				}
				#country_event = { id = human_fallen_empires.413 days = 1 }
			}
		}
	}
}

# scientist returns after 50 - 60 years
country_event = {
	id = human_fallen_empires.413
	title = human_fallen_empires.413.name
	desc = {
		trigger = {
			text = human_fallen_empires.413.desc.0
			success_text = {
				text = human_fallen_empires.413.desc.1.0
				or = {
					is_xenophobe = yes
					is_militarist = yes
					human_fallen_empires_trigger_is_authoritarian = yes
				}
			}
			fail_text = {
				text = human_fallen_empires.413.desc.1.1
				or = {
					is_xenophobe = yes
					is_militarist = yes
					human_fallen_empires_trigger_is_authoritarian = yes
				}
			}
			text = human_fallen_empires.413.desc.2
		}
	}
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = event_target:human_fallen_empires_target_ahet_home
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.413.0
		hidden_effect = {
			create_fleet = {
				name = "Science Ship"
				effect = {
					set_owner = root
					create_ship = {
						name = random
						random_existing_design = science
					}
					set_location = root.capital_scope
					set_leader = human_fallen_empires_412_scientist
					leader = {
						save_event_target_as = human_fallen_empires_413_scientist
						unassign_leader = this
					}
					delete_fleet = this
				}
			}
			event_target:human_fallen_empires_target_ahet_home = {
				set_planet_entity = {
					entity = shielded_planet_01_entity
				}
			}
		}
		if = {
			limit = {
				or = {
					is_xenophobe = yes
					is_militarist = yes
					human_fallen_empires_trigger_is_authoritarian = yes
				}
			}
			human_fallen_empires_effect_xenophobe_attraction_middle = yes
			else = {
				human_fallen_empires_effect_xenophile_attraction_middle = yes
			}
		}
		if = {
			limit = {
				is_materialist = no
				not = {
					has_technology = tech_psionic_theory
				}
			}
			if = {
				limit = {
					has_tech_option = tech_psionic_theory
				}
				add_tech_progress = {
					tech = tech_psionic_theory
					progress = 0.5
				}
				else = {
					add_research_option = tech_psionic_theory
				}
			}
			if = {
				limit = {
					is_spiritualist = no
					not = {
						has_technology = tech_sapient_ai
					}
				}
				if = {
					limit = {
						has_tech_option = tech_sapient_ai
					}
					add_tech_progress = {
						tech = tech_sapient_ai
						progress = 0.5
					}
					else = {
						add_research_option = tech_sapient_ai
					}
				}
				else = {
					if = {
						limit = {
							is_spiritualist = no
							not = {
								has_technology = tech_synthetic_workers
							}
						}
						if = {
							limit = {
								has_tech_option = tech_synthetic_workers
							}
							add_tech_progress = {
								tech = tech_synthetic_workers
								progress = 0.5
							}
							else = {
								add_research_option = tech_synthetic_workers
							}
						}
						else = {
							if = {
								limit = {
									not = {
										has_technology = tech_epigenetic_triggers
									}
								}
								if = {
									limit = {
										has_tech_option = tech_epigenetic_triggers
									}
									add_tech_progress = {
										tech = tech_epigenetic_triggers
										progress = 0.5
									}
									else = {
										add_research_option = tech_epigenetic_triggers
									}
								}
								else = {
									if = {
										limit = {
											not = {
												has_technology = tech_gene_tailoring
											}
										}
										if = {
											limit = {
												has_tech_option = tech_gene_tailoring
											}
											add_tech_progress = {
												tech = tech_gene_tailoring
												progress = 0.5
											}
											else = {
												add_research_option = tech_gene_tailoring
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		end_event_chain = human_fallen_empires_chain_ahet_home
	}
}

# Ra'ar story (then home of light captured) 500 - 501
# start event
planet_event = {
	id = human_fallen_empires.500
	title = human_fallen_empires.500.name
	desc = human_fallen_empires.500.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = root
	is_triggered_only = yes

	trigger = {
		has_planet_flag = human_fallen_empires_home_of_light
		exists = owner
		owner = {
			is_ai = no
		}
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		owner = {
			country_event = {
				id = human_fallen_empires.501
			}
		}
	}
}

# raar story
country_event = {
	id = human_fallen_empires.501
	title = human_fallen_empires.501.name
	desc = human_fallen_empires.501.desc
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_raar_room
	}

	option = {
		name = human_fallen_empires.501.0
		response_text = human_fallen_empires.501.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.1
		response_text = human_fallen_empires.501.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.2
		response_text = human_fallen_empires.501.2.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.3
		response_text = human_fallen_empires.501.3.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.4
		response_text = human_fallen_empires.501.4.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.5
		response_text = human_fallen_empires.501.5.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.6
		response_text = human_fallen_empires.501.6.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.7
		response_text = human_fallen_empires.501.7.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.8
		response_text = human_fallen_empires.501.8.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.9
		response_text = human_fallen_empires.501.9.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.10
		response_text = human_fallen_empires.501.10.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.11
		response_text = human_fallen_empires.501.11.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.12
		response_text = human_fallen_empires.501.12.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.13
		default_hide_option = yes
		custom_tooltip = human_fallen_empires.501.13.tooltip
	}
}

# terminator event part of memorial events 550 - 600
# человек. есть пустынная планета. столица одного из классов. есть дружественная империя
# start event nothing, complitly nothing
ship_event = {
	id = human_fallen_empires.550
	title = human_fallen_empires.550.name
	desc = human_fallen_empires.550.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = root #event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
		exists = leader
	}

	immediate = {
		leader = {
			save_event_target_as = human_fallen_empires_550_scientist
		}
		owner = {
			country_event = {
				id = human_fallen_empires.551
				#days = 50
				#random = 150
			}
		}
	}

	option = {
		name = human_fallen_empires.550.0
	}
}

# check scientist position
country_event = {
	id = human_fallen_empires.551
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = capital_scope
		any_owned_leader = {
			is_same_value = event_target:human_fallen_empires_550_scientist
		}
	}

	immediate = {
		random_owned_leader = {
			limit = {
				is_same_value = event_target:human_fallen_empires_550_scientist
			}
			if = {
				limit = {
					exists = fleet
				}
				# branch 1
				fleet = {
					random_list = {
						# kill ship
						10 = {
							fleet_event = {
								id = human_fallen_empires.552
							}
						}
						# disappeared, move to branch 2
						10 = {
							fleet_event = {
								id = human_fallen_empires.553
							}
						}
					}
				}
				else = {
					root = {
						# branch 2
						random_list = {
							# attempt failed
							10 = {
								country_event = {
									id = human_fallen_empires.554
								}
							}
							# main event
							10 = {
								capital_scope = {
									planet_event = {
										id = human_fallen_empires.555
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

# branch 1 ship
# kill ship
fleet_event = {
	id = human_fallen_empires.552
	title = human_fallen_empires.552.name
	desc = human_fallen_empires.552.desc
	show_sound = event_ship_explosion
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = root
	is_triggered_only = yes

	immediate = {
		kill_leader = {
			type = scientist
			show_notification = no
		}
		destroy_fleet = this
	}

	option = {
		name = human_fallen_empires.552.0
	}
}

# branch 2 planet
# disappeared, move to branch 2
fleet_event = {
	id = human_fallen_empires.553
	title = human_fallen_empires.553.name
	desc = human_fallen_empires.553.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_mystic_reveal
	is_triggered_only = yes

	trigger = {
		exists = owner
		exists = owner.capital_scope
		exists = leader
	}

	immediate = {
		leader = {
			exile_leader_as = human_fallen_empires_553_scientist
		}
		owner = {
			random_list = {
				# attempt failed
				10 = {
					country_event = {
						id = human_fallen_empires.554
						days = 80
						random = 100
					}
				}
				# main event
				10 = {
					capital_scope = {
						planet_event = {
							id = human_fallen_empires.555
							days = 180
							random = 100
						}
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.553.0
	}
}

# attempt failed
country_event = {
	id = human_fallen_empires.554
	title = human_fallen_empires.554.name
	desc = human_fallen_empires.554.desc
	show_sound = event_structural_collapse
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = capital_scope
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.554.0
	}
}

# main event planet desc
planet_event = {
	id = human_fallen_empires.555
	title = human_fallen_empires.555.name
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.555.desc.0.0
				or = {
					habitable_structure = yes
					solar_system = {
						any_planet = {
							is_star = yes
							is_planet_class = pc_black_hole
						}
					}
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.0.1
				or = {
					habitable_structure = yes
					solar_system = {
						any_planet = {
							is_star = yes
							is_planet_class = pc_black_hole
						}
					}
				}
			}
			text = newline
			success_text = {
				text = human_fallen_empires.555.desc.1.0
				or = {
					is_planet_class = pc_tropical
					is_planet_class = pc_continental
					is_planet_class = pc_ocean
					is_planet_class = pc_gaia
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.1
				or = {
					is_planet_class = pc_desert
					is_planet_class = pc_arid
					is_planet_class = pc_savannah
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.2
				or = {
					is_planet_class = pc_tundra
					is_planet_class = pc_arctic
					is_planet_class = pc_alpine
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.3
				habitable_structure = yes
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.4
				is_planet_class = pc_nuked
			}
			text = newline
			success_text = {
				text = human_fallen_empires.555.desc.2.0
				is_moon = no
				has_moon = yes
				not = {
					is_planet_class = pc_nuked
				}
				habitable_structure = no
			}
			success_text = {
				text = human_fallen_empires.555.desc.2.1
				is_moon = no
				num_moons < 1
				# has_moon = no seems broken
				not = {
					is_planet_class = pc_nuked
				}
				habitable_structure = no
			}
			success_text = {
				text = human_fallen_empires.555.desc.2.2
				is_moon = yes
				not = {
					is_planet_class = pc_nuked
				}
				habitable_structure = no
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = event_target:human_fallen_empires_555_room.ruler
	}

	immediate = {
		save_global_event_target_as = human_fallen_empires_555_planet
		create_country = {
			name = random
			type = human_fallen_empires_placeholder
			flag = random
			effect = {
				set_country_flag = human_fallen_empires_555_room
				save_event_target_as = human_fallen_empires_555_room
			}
		}
		solar_system = {
			random_system_planet = {
				limit = {
					any_moon = {
						is_planet = root
					}
				}
				save_event_target_as = human_fallen_empires_555_orbiting_planet
			}
		}
	}

	option = {
		name = human_fallen_empires_next
		default_hide_option = yes
		hidden_effect = {
			clear_global_event_target = human_fallen_empires_555_planet
			random_country = {
				limit = {
					has_country_flag = human_fallen_empires_555_room
				}
				destroy_country = yes
			}
		}
	}
}

# main event ruler desc

# terminator appeared: 3 branches

# branch 1 awake pekar and run

# succses

# fail

# branch 2 run

# succses

# fail

# branch 3 fight event 1

# succses

# fail


# drone country section 600
# contact event
country_event = {
	id = human_fallen_empires.604
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_drone
		exists = from
	}

	immediate = {
		establish_communications = from
		from = {
			if = {
				limit = {
					is_ai = no
				}
				country_event = {
					id = human_fallen_empires.605
				}
				set_country_flag = human_fallen_empires.605.step0
			}
		}
	}
}

# diplomatic contact event
country_event = {
	id = human_fallen_empires.605
	title = TRANSMISSION
	desc = {
		trigger = {
			# start
			fail_text = {
				text = human_fallen_empires.605.desc.0
				has_country_flag = human_fallen_empires.605.step3
			}
			success_text = {
				text = human_fallen_empires.605.desc.1
				has_country_flag = human_fallen_empires.605.step3
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	# step 0
	option = {
		name = human_fallen_empires.605.0.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step0
			set_country_flag = human_fallen_empires.605.step1
			country_event = {
				id = human_fallen_empires.605
			}
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.605.1.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step1
			set_country_flag = human_fallen_empires.605.step2
			country_event = {
				id = human_fallen_empires.605
			}
		}
	}
	# step 2
	option = {
		name = human_fallen_empires.605.2.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step2
			human_fallen_empires_trigger_is_clever_for_event = yes
		}
		human_fallen_empires_effect_materialist_attraction_middle = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step2
			set_country_flag = human_fallen_empires.605.step3
			country_event = {
				id = human_fallen_empires.605
			}
		}
	}
	# step 3
	option = {
		name = human_fallen_empires.605.3.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.0.response
	}
	option = {
		name = human_fallen_empires.605.3.1
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.1.response
	}
	option = {
		name = human_fallen_empires.605.3.2
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.2.response
	}
	option = {
		name = human_fallen_empires.605.3.3
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.3.response
	}
	option = {
		name = human_fallen_empires.605.3.4
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.4.response
	}
	option = {
		name = human_fallen_empires_end_transmission
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step0
			remove_country_flag = human_fallen_empires.605.step1
			remove_country_flag = human_fallen_empires.605.step2
			remove_country_flag = human_fallen_empires.605.step3
		}
	}
}

# drone bombardment event for on_monthly_orbital_bombardment
planet_event = {
	id = human_fallen_empires.606
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = owner
		exists = from
		from = {
			is_country_type = human_fallen_empires_drone
		}
		num_pops > 0
	}

	immediate = {
		random_owned_pop = {
			kill_pop = yes
		}
	}
}

# friendly ai vol 1 thoth
# start event, enable project
ship_event = {
	id = human_fallen_empires.700
	title = human_fallen_empires.700.name
	desc = human_fallen_empires.700.desc
	picture = GFX_evt_human_fallen_empires_thoth
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_has_event.700
		}
		exists = owner
		owner = {
			is_ai = no
			is_country_type = default
		}
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_thoth_contacted_first
		}
		set_global_flag = human_fallen_empires_has_event.700
		solar_system = {
			random_system_planet = {
				save_global_event_target_as = human_fallen_empires_thoth_location
			}
		}
		create_country = {
			name = "Station AI"
			type = human_fallen_empires_thoth
			flag = random
			effect = {
				set_name = human_fallen_empires_customization_notch_this_rename
				save_global_event_target_as = human_fallen_empires_thoth
				set_custom_capital_location = event_target:human_fallen_empires_thoth_location
				set_graphical_culture = mammalian_01
				set_country_flag = human_fallen_empires_thoth
				create_fleet = {
					name = "Station (possibly gigantic)"
					settings = {
						spawn_debris = no
					}
					effect = {
						set_owner = prev
						create_ship = {
							name = random
							design = "NAME_Artist_Enclave_Station"
							graphical_culture = prev
						}
						set_location = {
							target = event_target:human_fallen_empires_thoth_location
							distance = 10
						}
						set_fleet_flag = human_fallen_empires_thoth_station
					}
				}
			}
		}
		enable_special_project = {
			name = human_fallen_empires_project_thoth_contact
			location = event_target:human_fallen_empires_thoth_location
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires.700.0
		trigger = {
			is_ship_size = science
		}
		tooltip = {
			enable_special_project = {
				name = human_fallen_empires_project_thoth_contact
				location = event_target:human_fallen_empires_thoth_location
				owner = root.owner
			}
		}
	}
	option = {
		name = human_fallen_empires.700.1
		trigger = {
			not = {
				is_ship_size = science
			}
		}
		tooltip = {
			enable_special_project = {
				name = human_fallen_empires_project_thoth_contact
				location = event_target:human_fallen_empires_thoth_location
				owner = root.owner
			}
		}
	}
}

# project complete
ship_event = {
	id = human_fallen_empires.701
	title = human_fallen_empires.701.name
	desc = human_fallen_empires.701.desc
	picture = GFX_evt_human_fallen_empires_thoth
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	option = {
		name = human_fallen_empires_at_the_sreen
		hidden_effect = {
			owner = {
				establish_communications = event_target:human_fallen_empires_thoth
				set_country_flag = human_fallen_empires.702.0
				country_event = {
					id = human_fallen_empires.702
				}
			}
		}
	}
}

# dialog with station
country_event = {
	id = human_fallen_empires.702
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.702.desc.0
				has_country_flag = human_fallen_empires.702.0
			}
			success_text = {
				text = human_fallen_empires.702.desc.1
				has_country_flag = human_fallen_empires.702.1
			}
			success_text = {
				text = human_fallen_empires.702.desc.2
				has_country_flag = human_fallen_empires.702.2
			}
			success_text = {
				text = human_fallen_empires.702.desc.3
				has_country_flag = human_fallen_empires.702.3
			}
			success_text = {
				text = human_fallen_empires.702.desc.4
				has_country_flag = human_fallen_empires.702.4
			}
			success_text = {
				text = human_fallen_empires.702.desc.5
				has_country_flag = human_fallen_empires.702.5
			}
			success_text = {
				text = human_fallen_empires.702.desc.6
				has_country_flag = human_fallen_empires.702.6
			}
			success_text = {
				text = human_fallen_empires.702.desc.goodend
				has_country_flag = human_fallen_empires.703.goodend
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_thoth_room
	}

	# step 0
	option = {
		name = human_fallen_empires.702.0.0
		trigger = {
			has_country_flag = human_fallen_empires.702.0
			is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.0
			set_country_flag = human_fallen_empires.702.1
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.0.1
		trigger = {
			has_country_flag = human_fallen_empires.702.0
			is_xenophile = no
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.0
			set_country_flag = human_fallen_empires.702.1
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.0.2
		trigger = {
			has_country_flag = human_fallen_empires.702.0
			human_fallen_empires_trigger_is_hive = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.0
			set_country_flag = human_fallen_empires.702.1
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.702.1.0
		trigger = {
			has_country_flag = human_fallen_empires.702.1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.1
			set_country_flag = human_fallen_empires.702.2
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	# step 2
	option = {
		name = human_fallen_empires.702.2.0
		trigger = {
			has_country_flag = human_fallen_empires.702.2
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.2
			set_country_flag = human_fallen_empires.702.3
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	# step 3
	option = {
		name = human_fallen_empires.702.3.0
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			human_fallen_empires_trigger_is_hive = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.1
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.2
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.3
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.4
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.5
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.6
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.7
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.702.3.8
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.3
			set_country_flag = human_fallen_empires.702.4
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	# step 4
	option = {
		name = human_fallen_empires.702.4
		trigger = {
			has_country_flag = human_fallen_empires.702.4
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.4
			set_country_flag = human_fallen_empires.702.5
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	# step 5 ju ahet coming
	option = {
		name = human_fallen_empires.702.5.0
		trigger = {
			has_country_flag = human_fallen_empires.702.5
			any_country = {
				has_country_flag = human_fallen_empires_egypt
				any_owned_fleet = {
					fleet_power > 30000
				}
			}
		}
		hidden_effect = {
			random_country = {
				limit = {
					has_country_flag = human_fallen_empires_egypt
				}
				if = {
					limit = {
						not = {
							has_communications = root
						}
					}
					establish_communications_no_message = root
					root = {
						set_country_flag = human_fallen_empires_egypt_contacted
					}
				}
				random_owned_fleet = {
					limit = {
						fleet_power > 30000
					}
					set_location = {
						target = event_target:human_fallen_empires_thoth_location
						distance = 30
						angle = random
					}
				}
			}
			remove_country_flag = human_fallen_empires.702.5
			set_country_flag = human_fallen_empires.702.6
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	option = {
		name = human_fallen_empires.702.goodend
		trigger = {
			has_country_flag = human_fallen_empires.703.goodend
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.703.goodend
		}
	}
	# if haven't ju ahet
	option = {
		name = human_fallen_empires.702.5.1
		trigger = {
			has_country_flag = human_fallen_empires.702.5
			not = {
				any_country = {
					has_country_flag = human_fallen_empires_egypt
					any_owned_fleet = {
						fleet_power > 30000
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.5
			set_country_flag = human_fallen_empires.702.6
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	# step 6
	option = {
		name = human_fallen_empires.702.6.0
		response_text = human_fallen_empires.702.6.0.response
		trigger = {
			has_country_flag = human_fallen_empires.702.6
			has_country_flag = human_fallen_empires_egypt_contacted
			not = {
				any_country = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
		}
	}
	option = {
		name = human_fallen_empires.702.6.1
		response_text = human_fallen_empires.702.6.0.response
		trigger = {
			has_country_flag = human_fallen_empires.702.6
			has_country_flag = human_fallen_empires_egypt_contacted
			any_relation = {
				has_country_flag = human_fallen_empires_egypt
				not = {
					any_owned_fleet = {
						fleet_power > 20000
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
		}
	}
	option = {
		name = human_fallen_empires.702.6.2
		response_text = human_fallen_empires.702.6.0.response
		trigger = {
			has_country_flag = human_fallen_empires.702.6
			nand = {
				has_country_flag = human_fallen_empires_egypt_contacted
				any_country = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
		}
	}
}

# dialog with fleet
country_event = {
	id = human_fallen_empires.703
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.703.desc.6
				has_country_flag = human_fallen_empires.702.6
			}
			success_text = {
				text = human_fallen_empires.703.desc.7
				has_country_flag = human_fallen_empires.703.7
			}
			success_text = {
				text = human_fallen_empires.703.desc.goodend
				has_country_flag = human_fallen_empires.703.goodend
			}
			success_text = {
				text = human_fallen_empires.703.desc.badend.0
				has_country_flag = human_fallen_empires.703.badend
				not = {
					has_country_flag = human_fallen_empires.703.badend.0
				}
			}
			success_text = {
				text = human_fallen_empires.703.desc.badend.1
				has_country_flag = human_fallen_empires.703.badend
				has_country_flag = human_fallen_empires.703.badend.0
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_species
		room = human_fallen_empires_egypt_room
	}

	# step 6
	option = {
		name = human_fallen_empires.703.6.0
		trigger = {
			has_country_flag = human_fallen_empires.702.6
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
			set_country_flag = human_fallen_empires.703.7
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	option = {
		name = human_fallen_empires.703.6.1
		trigger = {
			has_country_flag = human_fallen_empires.702.6
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
			set_country_flag = human_fallen_empires.703.badend
			set_country_flag = human_fallen_empires.703.badend.0
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	# step 7
	option = {
		name = human_fallen_empires.703.7.0
		custom_tooltip = human_fallen_empires.703.7.high.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.703.7
			any_relation = {
				has_country_flag = human_fallen_empires_egypt
				or = {
					is_patronizing_to = root
					is_friendly_to = root
					is_cordial_to = root
					is_protective_to = root
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.703.7
			random_list = {
				9 = {
					set_country_flag = human_fallen_empires.703.goodend
				}
				1 = {
					set_country_flag = human_fallen_empires.703.badend
				}
			}
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	option = {
		name = human_fallen_empires.703.7.1
		custom_tooltip = human_fallen_empires.703.7.high.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.703.7
			relative_power = {
				who = event_target:human_fallen_empires_egypt_country
				category = fleet
				value > equivalent
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.703.7
			random_list = {
				9 = {
					set_country_flag = human_fallen_empires.703.goodend
				}
				1 = {
					set_country_flag = human_fallen_empires.703.badend
				}
			}
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	option = {
		name = human_fallen_empires.703.7.2
		custom_tooltip = human_fallen_empires.703.7.high.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.703.7
			has_trait = trait_charismatic
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.703.7
			random_list = {
				9 = {
					set_country_flag = human_fallen_empires.703.goodend
				}
				1 = {
					set_country_flag = human_fallen_empires.703.badend
				}
			}
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	option = {
		name = human_fallen_empires.703.7.3
		custom_tooltip = human_fallen_empires.703.7.midle.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.703.7
			is_militarist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.703.7
			random_list = {
				7 = {
					set_country_flag = human_fallen_empires.703.goodend
				}
				3 = {
					set_country_flag = human_fallen_empires.703.badend
				}
			}
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	option = {
		name = human_fallen_empires.703.7.4
		custom_tooltip = human_fallen_empires.703.7.low.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.703.7
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.703.7
			random_list = {
				5 = {
					set_country_flag = human_fallen_empires.703.goodend
				}
				5 = {
					set_country_flag = human_fallen_empires.703.badend
				}
			}
			country_event = {
				id = human_fallen_empires.703
			}
		}
	}
	# end
	option = {
		name = human_fallen_empires.703.goodend
		trigger = {
			has_country_flag = human_fallen_empires.703.goodend
		}
		hidden_effect = {
			#remove_country_flag = human_fallen_empires.703.goodend
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.703.badend
		custom_tooltip = human_fallen_empires.703.badend.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.703.badend
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.703.badend
			event_target:human_fallen_empires_thoth = {
				destroy_country = yes
			}
		}
	}
}

# not first contact
country_event = {
	id = human_fallen_empires.705
	title = TRANSMISSION
	desc = human_fallen_empires.705.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_thoth_room
	}

	trigger = {
		not = {
			has_country_flag = human_fallen_empires_thoth_contacted_first
		}
		from = {
			is_country_type = human_fallen_empires_thoth
		}
	}

	immediate = {
		establish_communications = from
		set_country_flag = human_fallen_empires_thoth_contacted
	}

	option = {
		name = human_fallen_empires.705.0
		default_hide_option = yes
	}
}

# start event diplomacy
country_event = {
	id = human_fallen_empires.710
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			is_country_type = human_fallen_empires_thoth
		}
		not = {
			has_country_flag = human_fallen_empires.711_block
		}
	}

	immediate = {
		random_list = {
			1 = {
				set_timed_country_flag = {
					flag = human_fallen_empires.711.0.0 days = 1
				}
			}
			1 = {
				set_timed_country_flag = {
					flag = human_fallen_empires.711.0.1 days = 1
				}
			}
			1 = {
				set_timed_country_flag = {
					flag = human_fallen_empires.711.0.2 days = 1
				}
			}
		}
		country_event = {
			id = human_fallen_empires.711
		}
		set_country_flag = human_fallen_empires.711_block
	}
}

# trade dialog
country_event = {
	id = human_fallen_empires.711
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.711.desc.0.0
				has_country_flag = human_fallen_empires.711.0.0
				nor = {
					has_country_flag = human_fallen_empires.711.4.1
					has_country_flag = human_fallen_empires.711.4.2
					has_country_flag = human_fallen_empires.711.4.3
					has_country_flag = human_fallen_empires.711.4.4
					has_country_flag = human_fallen_empires.711.4.5
				}
			}
			success_text = {
				text = human_fallen_empires.711.desc.0.1
				has_country_flag = human_fallen_empires.711.0.1
				nor = {
					has_country_flag = human_fallen_empires.711.4.1
					has_country_flag = human_fallen_empires.711.4.2
					has_country_flag = human_fallen_empires.711.4.3
					has_country_flag = human_fallen_empires.711.4.4
					has_country_flag = human_fallen_empires.711.4.5
				}
			}
			success_text = {
				text = human_fallen_empires.711.desc.0.2
				has_country_flag = human_fallen_empires.711.0.2
				nor = {
					has_country_flag = human_fallen_empires.711.4.1
					has_country_flag = human_fallen_empires.711.4.2
					has_country_flag = human_fallen_empires.711.4.3
					has_country_flag = human_fallen_empires.711.4.4
					has_country_flag = human_fallen_empires.711.4.5
				}
			}
			# dialog 0
			success_text = {
				text = human_fallen_empires.711.desc.4.1
				has_country_flag = human_fallen_empires.711.4.1
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.2
				has_country_flag = human_fallen_empires.711.4.2
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.3
				has_country_flag = human_fallen_empires.711.4.3
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.4
				has_country_flag = human_fallen_empires.711.4.4
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.5.0
				has_country_flag = human_fallen_empires.711.4.5
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.5.1
				has_country_flag = human_fallen_empires.711.4.5
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes
	force_open = yes

	picture_event_data = {
		room = human_fallen_empires_thoth_room
	}

	option = {
		name = human_fallen_empires.711.0
		allow = {
			energy > @human_fallen_empires_thoth_module_cost
			minerals > @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.0.response
		is_dialog_only = yes

		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.0.module_ordered
			country_event = {
				id = human_fallen_empires.712
				days = 365
			}
		}
	}
	option = {
		name = human_fallen_empires.711.1
		allow = {
			energy > @human_fallen_empires_thoth_module_cost
			minerals > @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.1.response
		is_dialog_only = yes

		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.1.module_ordered
			country_event = {
				id = human_fallen_empires.712
				days = 365
			}
		}
	}
	option = {
		name = human_fallen_empires.711.2
		allow = {
			energy > @human_fallen_empires_thoth_module_cost
			minerals > @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.2.response
		is_dialog_only = yes

		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.2.module_ordered
			country_event = {
				id = human_fallen_empires.712 days = 365
			}
		}
	}
	option = {
		name = human_fallen_empires.711.3
		allow = {
			energy > @human_fallen_empires_thoth_module_cost
			minerals > @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.3.response
		is_dialog_only = yes

		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.3.module_ordered
			country_event = {
				id = human_fallen_empires.712 days = 365
			}
		}
	}
	# dialog 0
	option = {
		name = human_fallen_empires.711.4.0
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.711.4.1
				has_country_flag = human_fallen_empires.711.4.2
				has_country_flag = human_fallen_empires.711.4.3
				has_country_flag = human_fallen_empires.711.4.4
				has_country_flag = human_fallen_empires.711.4.5
				has_country_flag = human_fallen_empires.711.4.6
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.4.1
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.711.4.1
		trigger = {
			has_country_flag = human_fallen_empires.711.4.1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.4.1
			set_country_flag = human_fallen_empires.711.4.2
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.711.4.2
		trigger = {
			has_country_flag = human_fallen_empires.711.4.2
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.4.2
			set_country_flag = human_fallen_empires.711.4.3
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.711.4.3
		trigger = {
			has_country_flag = human_fallen_empires.711.4.3
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.4.3
			set_country_flag = human_fallen_empires.711.4.4
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.711.4.4.0
		trigger = {
			has_country_flag = human_fallen_empires.711.4.4
			any_relation = {
				has_country_flag = human_fallen_empires_egypt
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.4.4.0
			set_country_flag = human_fallen_empires.711.4.5
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.711.4.4.1
		trigger = {
			has_country_flag = human_fallen_empires.711.4.4
			not = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.4.4
			set_country_flag = human_fallen_empires.711.4.5
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.711.4.5
		trigger = {
			has_country_flag = human_fallen_empires.711.4.5
		}
		response_text = human_fallen_empires.711.4.5.response
		is_dialog_only = yes
		allow = {
			hidden_trigger = {
				not = {
					has_country_flag = human_fallen_empires.711.dialog.0.complete
				}
			}
		}
		enable_special_project = {
			name = human_fallen_empires_project_thoth_memory
			location = event_target:human_fallen_empires_thoth_location
			owner = root
		}
		if = {
			limit = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
			enable_special_project = {
				name = human_fallen_empires_project_thoth_egypt_contact
				location = root.capital_scope
				owner = root
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.4.5
			set_country_flag = human_fallen_empires.711.dialog.0.complete
		}
	}
	option = {
		name = human_fallen_empires.711.5
		trigger = {
			has_country_flag = human_fallen_empires.711.dialog.0.complete
		}
		response_text = human_fallen_empires.711.5.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires_end_transmission
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711_block
		}
	}
}

# complete module
country_event = {
	id = human_fallen_empires.712
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.712.desc.0
				has_country_flag = human_fallen_empires.711.0.module_ordered
			}
			success_text = {
				text = human_fallen_empires.712.desc.1
				has_country_flag = human_fallen_empires.711.1.module_ordered
			}
			success_text = {
				text = human_fallen_empires.712.desc.2
				has_country_flag = human_fallen_empires.711.2.module_ordered
			}
			success_text = {
				text = human_fallen_empires.712.desc.3
				has_country_flag = human_fallen_empires.711.3.module_ordered
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes
	force_open = yes

	picture_event_data = {
		room = human_fallen_empires_thoth_room
	}

	immediate = {
		switch = {
			trigger = has_country_flag
			human_fallen_empires.711.0.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_energy
					value = 1
				}
			}
			human_fallen_empires.711.1.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_mineral
					value = 1
				}
			}
			human_fallen_empires.711.2.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_food
					value = 1
				}
			}
			human_fallen_empires.711.3.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_science
					value = 1
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.712.0
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.module_ordered
			remove_country_flag = human_fallen_empires.711.0.module_ordered
			remove_country_flag = human_fallen_empires.711.1.module_ordered
			remove_country_flag = human_fallen_empires.711.2.module_ordered
			remove_country_flag = human_fallen_empires.711.3.module_ordered
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.712.1
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.module_ordered
			remove_country_flag = human_fallen_empires.711.0.module_ordered
			remove_country_flag = human_fallen_empires.711.1.module_ordered
			remove_country_flag = human_fallen_empires.711.2.module_ordered
			remove_country_flag = human_fallen_empires.711.3.module_ordered
		}
	}
}

# memory installed
ship_event = {
	id = human_fallen_empires.720
	title = human_fallen_empires.720.name
	desc = human_fallen_empires.720.desc
	picture = GFX_evt_human_fallen_empires_thoth
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_thoth_memory_installed
		}
	}

	option = {
		name = human_fallen_empires.720.0
	}
	option = {
		name = human_fallen_empires.720.1
		hidden_effect = {
			random_list = {
				1 = {
					owner = {
						set_country_flag = human_fallen_empires_thoth_memory_installed_spy
					}
				}
				1 = {
					owner = {
						country_event = {
							id = human_fallen_empires.721
							days = 10
						}
					}
				}
			}
		}
	}
}

# fail
country_event = {
	id = human_fallen_empires.721
	title = TRANSMISSION
	desc = human_fallen_empires.721.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_thoth_room
	}

	option = {
		name = human_fallen_empires.721.0
		default_hide_option = yes
	}
}

# contact with ju ahet
country_event = {
	id = human_fallen_empires.725
	title = TRANSMISSION
	desc = human_fallen_empires.725.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_species
		room = human_fallen_empires_egypt_room
	}

	option = {
		name = human_fallen_empires.725.0
		response_text = human_fallen_empires.725.0.response
		default_hide_option = yes
	}
}

# joke event
country_event = {
	id = human_fallen_empires.4999
	diplomatic = yes
	is_triggered_only = yes
	title = TRANSMISSION
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.4999.desc.0
				has_country_flag = human_fallen_empires.4999.step0
			}
			success_text = {
				text = human_fallen_empires.4999.desc.1
				has_country_flag = human_fallen_empires.4999.step0
			}
		}
	}

	picture_event_data = {
		portrait = event_target:human_fallen_empires_4999_target
		planet_background = event_target:human_fallen_empires_4999_target
		graphical_culture = event_target:human_fallen_empires_4999_target
		city_level = event_target:human_fallen_empires_4999_target
		room = event_target:human_fallen_empires_4999_target
	}

	immediate = {
		if = {
			limit = {
				not = {
					exists = event_target:human_fallen_empires_4999_target
				}
			}
			if = {
				limit = {
					any_country = {
						is_species_class = HUM
					}
				}
				random_country = {
					limit = {
						is_species_class = HUM
					}
					save_event_target_as = human_fallen_empires_4999_target
				}
				else = {
					random_country = {
						save_event_target_as = human_fallen_empires_4999_target
					}
				}
			}
			establish_communications_no_message = event_target:human_fallen_empires_4999_target
		}
	}

	option = {
		name = human_fallen_empires.4999.0.0
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.4999.step0
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.4999.step0
			country_event = {
				id = human_fallen_empires.4999
			}
		}
	}
	option = {
		name = human_fallen_empires.4999.1.0
		trigger = {
			has_country_flag = human_fallen_empires.4999.step0
		}
	}
	option = {
		name = human_fallen_empires.4999.1.1
		trigger = {
			has_country_flag = human_fallen_empires.4999.step0
		}
	}
	option = {
		name = human_fallen_empires.4999.1.2
		custom_tooltip = human_fallen_empires.4999.1.2.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.4999.step0
		}
	}
}


### Kad Republic section

# 5000-10000

# functional on actions events 5000 - 5050

# contact dialoge with future 5000 - 5002
country_event = {
	id = human_fallen_empires.5000
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		exists = from
		from = {
			is_country_type = human_fallen_empire
			has_country_flag = human_fallen_empires_future
		}
	}

	immediate = {
		from = {
			establish_communications = root
			while = {
				limit = {
					nand = {
						any_owned_leader = {
							gender = female
						}
						any_owned_leader = {
							not = {
								gender = female
							}
						}
					}
				}
				create_leader = {
					type = admiral
					species = this
					name = random
					skill = 100
				}
			}
			random_owned_leader = {
				limit = {
					gender = female
				}
				save_event_target_as = human_fallen_empires_female_leader
			}
			random_owned_leader = {
				limit = {
					not = {
						gender = female
					}
					leader_class = admiral
				}
				save_event_target_as = human_fallen_empires_male_leader
			}
		}
		if = {
			limit = {
				is_ai = no
			}
			set_country_flag = human_fallen_empires.5001.step0
			country_event = {
				id = human_fallen_empires.5001
			}
		}
		set_country_flag = human_fallen_empires_future_contacted
	}
}

# main dialoge
country_event = {
	id = human_fallen_empires.5001
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.5001.desc.0
				has_country_flag = human_fallen_empires.5001.step0
			}
			success_text = {
				text = human_fallen_empires.5001.desc.1
				has_country_flag = human_fallen_empires.5001.step1
			}
			success_text = {
				text = human_fallen_empires.5001.desc.2
				has_country_flag = human_fallen_empires.5001.step2
			}
			success_text = {
				text = human_fallen_empires.5001.desc.3
				has_country_flag = human_fallen_empires.5001.step3
			}
			success_text = {
				text = human_fallen_empires.5001.desc.4
				has_country_flag = human_fallen_empires.5001.step4
			}
			success_text = {
				text = human_fallen_empires.5001.desc.5
				has_country_flag = human_fallen_empires.5001.step5
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_female_leader
		room = human_fallen_empires_future_room
	}

	# step 0
	option = {
		name = human_fallen_empires.5001.0.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			any_relation = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = yes
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.0.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			any_relation = {
				has_country_flag = human_fallen_empires_egypt
			}
			has_country_flag = human_fallen_empires_marked_as_human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.0.2
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.0.3
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.0.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.0.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.0.6
		trigger = {
			is_xenophobe = no
			is_xenophile = no
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.0.7
		trigger = {
			is_materialist = yes
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		add_energy = 500
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.5001.1.0
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			set_country_flag = human_fallen_empires.5001.step2.human
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.1.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.1.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.1.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = {
				id = human_fallen_empires.5001
			}

		}
	}
	option = {
		name = human_fallen_empires.5001.1.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			nor = {
				has_country_flag = human_fallen_empires_marked_as_human
				has_ethic = ethic_fanatic_xenophobe
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophile
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = {
				id = human_fallen_empires.5001
			}

		}
	}
	# step 2
	option = {
		name = human_fallen_empires.5001.2.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			has_country_flag = human_fallen_empires.5001.step2.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
			remove_country_flag = human_fallen_empires.5001.step2.human
			set_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step3.human
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.2.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			not = {
				has_country_flag = human_fallen_empires.5001.step2.human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
			set_country_flag = human_fallen_empires.5001.step3
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.2.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			is_xenophobe = yes
			not = {
				has_country_flag = human_fallen_empires.5001.step2.human
			}
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
		}
	}
	option = {
		name = human_fallen_empires.5001.2.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			is_xenophobe = no
			nor = {
				has_ethic = ethic_fanatic_xenophobe
				has_ethic = ethic_xenophobe
				has_country_flag = human_fallen_empires.5001.step2.human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
		}
	}
	# step 3
	option = {
		name = human_fallen_empires.5001.3.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			has_country_flag = human_fallen_empires.5001.step3.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			remove_country_flag = human_fallen_empires.5001.step3.human
			set_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step4.human
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.3.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	# step 4
	option = {
		name = human_fallen_empires.5001.4.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			has_country_flag = human_fallen_empires.5001.step4.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			remove_country_flag = human_fallen_empires.5001.step4.human
			set_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step5.human
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.4.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = {
				id = human_fallen_empires.5001
			}
		}
	}
	# step 5
	option = {
		name = human_fallen_empires.5001.5.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			has_country_flag = human_fallen_empires.5001.step5.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			remove_country_flag = human_fallen_empires.5001.step5.human
			set_country_flag = human_fallen_empires.5001.step6
			set_country_flag = human_fallen_empires.5001.step6.human
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.5.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
}

# part 2 for male portrait
country_event = {
	id = human_fallen_empires.5002
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.5001.desc.6.1
				has_country_flag = human_fallen_empires.5001.step6
				is_species_class = HUM
			}
			success_text = {
				text = human_fallen_empires.5001.desc.6.2
				has_country_flag = human_fallen_empires.5001.step6
				not = {
					is_species_class = HUM
				}
			}
			success_text = {
				text = human_fallen_empires.5001.desc.7
				has_country_flag = human_fallen_empires.5001.step7
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_male_leader
		room = human_fallen_empires_future_room
	}

	# step 6
	option = {
		name = human_fallen_empires.5001.6.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step6
			is_species_class = HUM
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step6
			set_country_flag = human_fallen_empires.5001.step7
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.6.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step6
			not = {
				is_species_class = HUM
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step6
			set_country_flag = human_fallen_empires.5001.step7
			country_event = {
				id = human_fallen_empires.5002
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.7.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step7
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step7
		}
	}
}

# awake make future default country, start expansion era 5010 - 5012
country_event = {
	id = human_fallen_empires.5010
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_future_in_expansion
		}
		or = {
			mid_game_years_passed > 50
			end_game_years_passed > 0
		}
		or = {
			has_global_flag = galactic_crisis_happened
			has_global_flag = human_fallen_empires_war_in_heaven_started
			recently_lost_war = yes
			and = {
				or = {
					years_passed > 150
					any_country = {
						is_country_type = default
						fleet_power > 100000
					}
				}
				is_difficulty = 0
			}
			and = {
				or = {
					years_passed > 140
					any_country = {
						is_country_type = default
						fleet_power > 90000
					}
				}
				is_difficulty > 0
			}
			and = {
				or = {
					years_passed > 130
					any_country = {
						is_country_type = default
						fleet_power > 80000
					}
				}
				is_difficulty > 1
			}
			and = {
				or = {
					years_passed > 120
					any_country = {
						is_country_type = default
						fleet_power > 70000
					}
				}
				is_difficulty > 2
			}
		}
	}

	immediate = {
		every_owned_ship = {
			repair_ship = yes
			add_modifier = {
				modifier = human_fallen_empires_unkeep
				days = -1
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_navy_size
			days = 3600
		}
		country_remove_ethic = ethic_fanatic_pacifist
		country_add_ethic = ethic_fanatic_militarist
		country_add_ethic = ethic_egalitarian
		change_government = {
			authority = auth_democratic
			civics = random
		}
		every_owned_pop = {
			limit = {
				has_ethic = ethic_pacifist
			}
			pop_change_ethic = ethic_militarist
		}
		# kill_leader = {
		# 	type = ruler
		# 	show_notification = no
		# }
		set_country_type = default
		#set_empire_name = "Kad Republic"
		set_global_flag = human_fallen_empires_future_in_expansion
		every_country = {
			establish_communications_no_message = event_target:human_fallen_empires_future_country
			if = {
				limit = {
					is_ai = no
				}
				country_event = {
					id = human_fallen_empires.5011
				}
			}
		}
		random_country = {
			limit = {
				is_country_type = default
				fleet_power > 30000
				not = {
					is_country = root
				}
			}
			log = "future awekened by [This.GetName]"
		}
	}
}

# future expansion notification
country_event = {
	id = human_fallen_empires.5011
	title = human_fallen_empires.5011.name
	desc = human_fallen_empires.5011.desc.0
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future.ruler
		room = human_fallen_empires_future_room
	}

	option = {
		name = human_fallen_empires.5011.0
		trigger = {
			has_country_flag = human_fallen_empires_future_contacted
		}
		hidden_effect = {
			if = {
				limit = {
					can_be_subject = {
						overlord = event_target:human_fallen_empires_future
						subject_type = human_fallen_empires_future_vassal
					}
				}
				country_event = {
					id = human_fallen_empires.5012
					days = 10
					random = 15
				}
			}
		}
		custom_tooltip = human_fallen_empires.5011.0.tooltip
	}
	option = {
		name = human_fallen_empires.5011.0
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_future_contacted
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires_future_contacted
		}
	}
}

# future expansion notification invite
country_event = {
	id = human_fallen_empires.5012
	title = TRANSMISSION
	desc = human_fallen_empires.5012.desc
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future
		room = human_fallen_empires_future_room
	}

	option = {
		name = human_fallen_empires.5012.0
		set_subject_of = {
			who = event_target:human_fallen_empires_future
			subject_type = human_fallen_empires_future_vassal
		}
		play_sound = event_celebration
	}
	option = {
		name = human_fallen_empires.5012.1
		default_hide_option = yes
	}
}

# assimilation event (turn regular subject into coalition member subject type) 5020 - 5021
country_event = {
	id = human_fallen_empires.5020
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		any_subject = {
			not = {
				is_subject_type = human_fallen_empires_future_vassal
			}
		}
	}

	immediate = {
		random_subject = {
			limit = {
				not = {
					is_subject_type = human_fallen_empires_future_vassal
				}
			}
			set_subject_of = {
				who = root
				subject_type = human_fallen_empires_future_vassal
			}
			country_event = {
				id = human_fallen_empires.5021
			}
		}
	}
}

# inform player
country_event = {
	id = human_fallen_empires.5021
	title = human_fallen_empires.5021.name
	desc = human_fallen_empires.5021.desc
	picture = GFX_evt_human_fallen_empires_coalition
	show_sound = event_administrative_work
	is_triggered_only = yes

	trigger = {
		is_ai = no
	}

	option = {
		name = human_fallen_empires.5021.0
	}
}


## anomalys and after survey on actions 5050 - 5100

# criopods anomaly 5050 - 5055

# switch to country
ship_event = {
	id = human_fallen_empires.5050
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		from = {
			save_event_target_as = human_fallen_empires_criopods_planet
		}
		owner = {
			country_event = {
				id = human_fallen_empires.5051
			}
		}
	}
}

# main event
country_event = {
	id = human_fallen_empires.5051
	title = human_fallen_empires.5051.name
	desc = {
		trigger = {
			# step 0
			# have contact
			success_text = {
				text = human_fallen_empires.5051.desc.0.0
				has_country_flag = human_fallen_empires_future_contacted
			}
			# havent contact
			fail_text = {
				text = human_fallen_empires.5051.desc.0.1
				has_country_flag = human_fallen_empires_future_contacted
			}
			# human addition
			success_text = {
				text = human_fallen_empires.5051.desc.0.2
				not = {
					has_country_flag = human_fallen_empires_future_contacted
				}
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# step 1
			text = human_fallen_empires.5051.desc.1.0
			# step 2
			# human
			# have contact
			success_text = {
				text = human_fallen_empires.5051.desc.2.0
				has_country_flag = human_fallen_empires_future_contacted
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# havent contact
			success_text = {
				text = human_fallen_empires.5051.desc.2.1
				not = {
					has_country_flag = human_fallen_empires_future_contacted
				}
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# non human
			# xenophobe
			success_text = {
				text = human_fallen_empires.5051.desc.2.2
				nor = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophobe = yes
			}
			# xenophile
			success_text = {
				text = human_fallen_empires.5051.desc.2.3
				nor = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophile = yes
			}
			# authoritarian
			success_text = {
				text = human_fallen_empires.5051.desc.2.4
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophobe = no
				is_xenophile = no
				human_fallen_empires_trigger_is_authoritarian = yes
			}
			# egalitarian
			success_text = {
				text = human_fallen_empires.5051.desc.2.5
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophobe = no
				is_xenophile = no
				is_egalitarian = yes
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_colony_new
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_criopods_planet
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.5051.0
		trigger = {
			has_country_flag = human_fallen_empires_future_contacted
			has_country_flag = human_fallen_empires_marked_as_human
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.1
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_future_contacted
			}
			has_country_flag = human_fallen_empires_marked_as_human
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.2
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = yes
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.3
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_high = yes
	}
	option = {
		name = human_fallen_empires.5051.4
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.5
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = no
			is_xenophile = no
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction_low = yes
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.6
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = no
			is_xenophile = no
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction_low = yes
		hidden_effect = {
			random_list = {
				1 = {
					set_country_flag = human_fallen_empires_criopods_var_1
				}
				1 = {
					set_country_flag = human_fallen_empires_criopods_var_2
				}
				1 = {
					set_country_flag = human_fallen_empires_criopods_var_3
				}
			}
			country_event = {
				id = human_fallen_empires.5052 days = 15 random = 15
			}
		}
	}
}

# step 2 for egalitarian
country_event = {
	id = human_fallen_empires.5052
	title = human_fallen_empires.5052.name
	desc = {
		trigger = {
			hidden:root = {
				switch = {
					trigger = has_country_flag

					human_fallen_empires_criopods_var_1 = {
						text = human_fallen_empires.5052.desc.1
					}
					human_fallen_empires_criopods_var_2 = {
						text = human_fallen_empires.5052.desc.2
					}
					human_fallen_empires_criopods_var_3 = {
						text = human_fallen_empires.5052.desc.3
					}
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_colony_new
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_criopods_planet
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.5052.1
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_1
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_colony = {
				owner = root
				species = event_target:human_fallen_empires_future_species
			}
		}
	}
	option = {
		name = human_fallen_empires.5052.2
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_2
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_country = {
				name = random
				type = default
				species = event_target:human_fallen_empires_future_species
				authority = random
				civics = random
				flag = random
				ethos = {
					ethic = ethic_fanatic_egalitarian
					ethic = ethic_militarist
				}
				effect = {
					set_subject_of = {
						who = root
						subject_type = protectorate
					}
				}
			}
			create_colony = {
				owner = last_created_country
				species = event_target:human_fallen_empires_future_species
			}
		}
	}
	option = {
		name = human_fallen_empires.5052.3
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_3
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_country = {
				name = random
				type = default
				species = event_target:human_fallen_empires_future_species
				authority = random
				civics = random
				flag = random
				ethos = {
					ethic = ethic_fanatic_egalitarian
					ethic = ethic_militarist
				}
				effect = {
					establish_communications_no_message = root
				}
			}
			create_colony = {
				owner = last_created_country
				species = event_target:human_fallen_empires_future_species
			}
		}
	}
	option = {
		name = human_fallen_empires.5052.4
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_3
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction_middle = yes
		event_target:human_fallen_empires_criopods_planet = {
			create_country = {
				name = random
				type = default
				species = event_target:human_fallen_empires_future_species
				authority = random
				civics = random
				flag = random
				ethos = {
					ethic = ethic_fanatic_egalitarian
					ethic = ethic_militarist
				}
				effect = {
					establish_communications_no_message = root
				}
			}
			create_colony = {
				owner = last_created_country
				species = event_target:human_fallen_empires_future_species
			}
			root = {
				declare_war = {
					target = last_created_country
					attacker_war_goal = wg_subjugation
				}
			}
		}
	}
	after = {
		remove_country_flag = human_fallen_empire_criopods_var_1
		remove_country_flag = human_fallen_empire_criopods_var_2
		remove_country_flag = human_fallen_empire_criopods_var_3
	}
}

# dead worms anomaly 5055 - 5057

# start
ship_event = {
	id = human_fallen_empires.5055
	title = human_fallen_empires.5055.name
	desc = human_fallen_empires.5055.desc
	picture = GFX_evt_human_fallen_empires_space_debris
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	option = {
		name = human_fallen_empires_at_the_sreen
		leader = {
			add_experience = 200
		}
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.5056
				}
			}
		}
	}
}

# diplo event
country_event = {
	id = human_fallen_empires.5056
	title = human_fallen_empires.5056.name
	desc = human_fallen_empires.5056.desc
	show_sound = olafur_arnalds_only_the_winds
	is_triggered_only = yes
	diplomatic = yes

	immediate = {
		#	play_sound = olafur_arnalds_only_the_winds
	}

	picture_event_data = {
		room = human_fallen_empires_dead_worms_room
	}

	option = {
		name = human_fallen_empires.5056.0
		response_text = human_fallen_empires.5056.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.5056.1
		response_text = human_fallen_empires.5056.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.5056.2
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.5057
			}
		}
	}
}

# for pic
country_event = {
	id = human_fallen_empires.5057
	title = human_fallen_empires.5056.name
	desc = human_fallen_empires.5056.2.response
	#show_sound = event_space_battle
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_bombardment_room
	}

	option = {
		name = human_fallen_empires.5056.3
		trigger = {
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction_low = yes
	}
	option = {
		name = human_fallen_empires.5056.4
		trigger = {
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction_low = yes
	}
	option = {
		name = human_fallen_empires.5056.5
		trigger = {
			human_fallen_empires_trigger_is_clever_for_event = yes
		}
		human_fallen_empires_effect_materialist_attraction_low = yes
	}
	option = {
		name = human_fallen_empires.5056.6
		trigger = {
			is_xenophobe = no
			is_xenophile = no
			human_fallen_empires_trigger_is_clever_for_event = no
		}
	}
}


# other dialoges 5100 - 5200

# buy robots 5100
country_event = {
	id = human_fallen_empires.5100
	title = TRANSMISSION
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.5100.desc.0
				has_country_flag = human_fallen_empires.5100.step1
			}
			success_text = {
				text = human_fallen_empires.5100.desc.1
				has_country_flag = human_fallen_empires.5100.step1
			}
		}
	}
	#	show_sound = event_alien_signal
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future_country
		room = human_fallen_empires_future_room
	}

	trigger = {
		any_owned_pop = {
			has_trait = trait_mechanical
		}
		exists = event_target:human_fallen_empires_future_country
	}

	immediate = {
		set_country_flag = human_fallen_empires_future_try_take_robot
	}

	option = {
		name = human_fallen_empires.5100.0
		trigger = {
			not = {
				has_policy_flag = ai_full_rights
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_army_trained_by_future
			days = -1
		}
		hidden_effect = {
			set_global_flag = human_fallen_empires_future_take_robot
			random_owned_pop = {
				limit = {
					has_trait = trait_mechanical
				}
				save_event_target_as = human_fallen_empires_settle_pop_target
			}
			event_target:human_fallen_empires_future_country = {
				human_fallen_empires_effect_settle_pop = yes
			}
		}
		custom_tooltip = human_fallen_empires.5100.yes.tooltip
	}
	option = {
		name = human_fallen_empires.5100.1
		trigger = {
			or = {
				is_xenophobe = yes
				human_fallen_empires_trigger_is_authoritarian = yes
			}
			has_policy_flag = ai_full_rights
		}
		add_modifier = {
			modifier = human_fallen_empires_army_trained_by_future
			days = -1
		}
		hidden_effect = {
			set_global_flag = human_fallen_empires_future_take_robot
			random_owned_pop = {
				limit = {
					has_trait = trait_mechanical
				}
				save_event_target_as = human_fallen_empires_settle_pop_target
			}
			event_target:human_fallen_empires_future_country = {
				human_fallen_empires_effect_settle_pop = yes
			}
		}
		custom_tooltip = human_fallen_empires.5100.yes.tooltip
	}
	option = {
		name = human_fallen_empires.5100.2
		trigger = {
			is_xenophobe = no
			human_fallen_empires_trigger_is_authoritarian = no
			has_policy_flag = ai_full_rights
		}
		response_text = human_fallen_empires.5100.no.response
	}
	option = {
		name = human_fallen_empires.5100.3
		response_text = human_fallen_empires.5100.no.response
	}
	option = {
		name = human_fallen_empires.5100.4
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.5100.step1
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.5100.step1
			country_event = {
				id = human_fallen_empires.5100
			}
		}
	}
	option = {
		name = human_fallen_empires.5100.5
		trigger = {
			has_country_flag = human_fallen_empires.5100.step1
		}
		response_text = human_fallen_empires.5100.5.response
		is_dialog_only = yes
	}
}
