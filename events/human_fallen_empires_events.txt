namespace = human_fallen_empires

@tier1materialreward = 6
@tier1materialmin = 100
@tier1materialmax = 500
@tier2materialreward = 12
@tier2materialmin = 150
@tier2materialmax = 1000
@tier3materialreward = 18
@tier3materialmin = 250
@tier3materialmax = 1500
@tier4materialreward = 24
@tier4materialmin = 350
@tier4materialmax = 2000

@tier1influencereward = 6
@tier1influencemin = 40
@tier1influencemax = 100
@tier2influencereward = 12
@tier2influencemin = 80
@tier2influencemax = 175
@tier3influencereward = 18
@tier3influencemin = 125
@tier3influencemax = 250
@tier4influencereward = 24
@tier4influencemin = 150
@tier4influencemax = 300

@tier1researchreward = 6
@tier1researchmin = 60
@tier1researchmax = 150
@tier2researchreward = 12
@tier2researchmin = 90
@tier2researchmax = 250
@tier3researchreward = 18
@tier3researchmin = 120
@tier3researchmax = 350
@tier4researchreward = 24
@tier4researchmin = 150
@tier4researchmax = 500

# discovery
@human_fallen_empires_discovery_docking_update_minerals_cost = 300
@human_fallen_empires_discovery_docking_update_energy_cost = 300
@human_fallen_empires_discovery_docking_update_minerals_cost_minus = -300
@human_fallen_empires_discovery_docking_update_energy_cost_minus = -300
@human_fallen_empires_discovery_docking_update_minerals_dock_owner = 150
@human_fallen_empires_discovery_docking_update_energy_dock_owner = 150
@human_fallen_empires_discovery_contract_pirate_hunt_reward = 500
@human_fallen_empires_discovery_contract_pirate_hunt_reward_minus = -500
@human_fallen_empires_discovery_contract_embassy_reward = 100
@human_fallen_empires_discovery_contract_embassy_reward_minus = -100
@human_fallen_empires_discovery_kill_t0 = 50
@human_fallen_empires_discovery_kill_t1 = 100
@human_fallen_empires_discovery_kill_t2 = 150
@human_fallen_empires_discovery_kill_t3 = 200
@human_fallen_empires_discovery_kill_t4 = 1000
@human_fallen_empires_discovery_kill_energy = 75
@human_fallen_empires_discovery_kill_reward = 50
@human_fallen_empires_discovery_kill_reward_minus = -50

# pirate
@human_fallen_empires_pirate_base_cost = 3000
@human_fallen_empires_pirate_base_cost_minus = -3000
@human_fallen_empires_pirate_slave_cost = 300
@human_fallen_empires_pirate_slave_cost_minus = -300

# functional section 0 - 50

# install mod
country_event = {
	id = human_fallen_empires.0
	fire_only_once = yes
	hide_window = yes

	immediate = {
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_installed
				}
			}
			# prevent spawn vanilla pirates
			every_country = {
				set_country_flag = birth_of_piracy
			}
			# prevent vanilla awake
			set_global_flag = sleepers_awake_happened
			if = {
				limit = {
					any_country = {
						or = {
							has_country_flag = human_1
							has_country_flag = human_2
							species_portrait = human
						}
					}
				}
				every_country = {
					limit = {
						or = {
							has_country_flag = human_1
							has_country_flag = human_2
							species_portrait = human
						}
					}
					set_country_flag = human_fallen_empires_marked_as_human
				}
				if = {
					limit = {
						any_country = {
							has_country_flag = human_fallen_empires_marked_as_human
							is_ai = no
						}
					}
					random_country = {
						limit = {
							has_country_flag = human_fallen_empires_marked_as_human
							is_ai = no
						}
						species = { save_event_target_as = human_fallen_empires_human_species }
					}
					else = {
						random_country = {
							limit = {
								has_country_flag = human_fallen_empires_marked_as_human
							}
							species = { save_event_target_as = human_fallen_empires_human_species }
						}
					}
				}
				create_species = {
					name = "Ju Ahet"
					plural = "Ju Ahet"
					class = "MAM"
					portrait = human_fallen_empires_egypt_portrait
					traits = {
						ideal_planet_class = pc_continental
						trait = trait_extremely_adaptive
						trait = trait_venerable
						trait = trait_slow_breeders
					}
					immortal = yes
				}
				last_created_species = {
					set_species_identity = event_target:human_fallen_empires_human_species
					save_global_event_target_as = human_fallen_empires_egypt_species
				}
				create_species = {
					name = Human
					plural = Humans
					class = "MAM"
					portrait = "human"
					traits = {
						ideal_planet_class = pc_continental
						trait = trait_intelligent
						trait = trait_thrifty
						trait = trait_strong
						trait = trait_enduring
					}
				}
				last_created_species = {
					set_species_identity = event_target:human_fallen_empires_human_species
					save_global_event_target_as = human_fallen_empires_future_species
				}
				else = {
					create_species = {
						name = "Ju Ahet"
						plural = "Ju Ahet"
						class = "MAM"
						portrait = human_fallen_empires_egypt_portrait
						traits = {
							ideal_planet_class = pc_continental
							trait = trait_extremely_adaptive
							trait = trait_venerable
							trait = trait_slow_breeders
						}
					}
					last_created_species = {
						save_global_event_target_as = human_fallen_empires_egypt_species
					}
					create_species = {
						name = Human
						plural = Humans
						class = "MAM"
						portrait = "human"
						traits = {
							ideal_planet_class = pc_continental
							trait = trait_intelligent
							trait = trait_thrifty
							trait = trait_strong
							trait = trait_solitary
						}
					}
					last_created_species = {
						set_species_identity = event_target:human_fallen_empires_egypt_species
						save_global_event_target_as = human_fallen_empires_future_species
					}
				}
			}
			random_rim_system  = {
				limit = {
					nor = {
						any_system = {
							distance = {
								source = prev
								max_distance = 60
								min_distance = 0
							}
							exists = space_owner
						}
						exists = space_owner
						is_fe_cluster = yes
					}
				}
				spawn_system = {
					initializer = human_fallen_empires_future
				}
				set_global_flag = human_fallen_empires_future_spawned
			}
			create_species = {
				name = Ahet
				plural = Ahet
				class = "REP"
				portrait = random
				traits = {
					ideal_planet_class = pc_tropical
					trait = trait_slow_breeders
					trait = trait_strong
					trait = random_traits
				}
			}
			last_created_species = { save_global_event_target_as = human_fallen_empires_ahet_species }
			create_species = {
				name = Varelse
				plural = Varelse
				class = "REP"
				portrait = random
				traits = {
					ideal_planet_class = pc_desert
					trait = trait_industrious
					trait = trait_natural_engineers
					trait = trait_strong
					trait = trait_repugnant
				}
			}
			last_created_species = { save_global_event_target_as = human_fallen_empires_varelse_species }
			random_system = {
				limit = {
					nor = {
						any_system = {
							distance = {
								source = prev
								max_distance = 90
								min_distance = 0
							}
							exists = space_owner
						}
						exists = space_owner
						is_fe_cluster = yes
					}
				}
				spawn_system = {
					min_distance = 0
					max_distance = 10
					initializer = human_fallen_empires_egypt
				}
				spawn_system = {
					min_distance = 0
					max_distance = 10
					initializer = human_fallen_empires_hope
				}
				spawn_system = {
					min_distance = 0
					max_distance = 10
					initializer = human_fallen_empires_gift
				}
				spawn_system = {
					min_distance = 10
					max_distance = 20
					initializer = human_fallen_empires_ban
				}
				set_global_flag = human_fallen_empires_egypt_spawned
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_memorial_01 }
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_memorial_02 }
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_memorial_03 }
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_memorial_04 }
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_varelse }
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_ahet }
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_ahet_2 }
			}
			random_system = {
				limit = {
					has_owner = no
				}
				spawn_system = { initializer = human_fallen_empires_too_ideal_planet }
			}
			# discovery setup
			if = {
				limit = {
					any_country = {
						has_country_flag = human_fallen_empires_discovery
					}
				}
				every_country = {
					limit = {
						has_country_flag = human_fallen_empires_discovery
					}
					set_country_type = human_fallen_empires_discovery
					set_country_flag = Story7
					modify_species = {
						species = this
						remove_trait = trait_pc_nuked_preference
						add_trait = trait_pc_continental_preference
					}
					every_owned_fleet = {
						limit = {
							exists = leader
						}
						leader = {
							unassign_leader = this
						}
						destroy_fleet = this
					}
					random_owned_planet = {
						destroy_colony = yes
						create_fleet = {
							name = Discovery
							effect = {
								set_owner = prevprev
								create_ship = {
									name = Discovery
									design = Deepvoid
								}
								last_created_ship = {
									set_ship_flag = human_fallen_empires_discovery_ship
								}
								set_location = prev
							}
						}
						#	create_ship_design = {
						#		design = Constructor
						#		ftl = warp
						#	}
						#	create_fleet = {
						#		name = Constructor
						#		effect = {
						#			set_owner = prevprev
						#			create_ship = {
						#				name = random
						#				design = last_created_design
						#			}
						#			set_location = prev
						#		}
						#	}
						create_ship_design = {
							design = Prototype
							ftl = warp
						}
						create_fleet = {
							name = "Science Ship"
							effect = {
								set_owner = prevprev
								create_ship = {
									name = random
									design = last_created_design
								}
								set_location = prev
							}
						}
					}
					every_owned_planet = {
						destroy_colony = yes
					}
					every_owned_ship = {
						repair_ship = yes
						add_modifier = {
							modifier = human_fallen_empires_unkeep
							days = -1
						}
					}
					add_minerals = 500
					add_energy = 500
				}
			}
			# drone
			random_system = {
				limit = {
					nor = {
						any_system = {
							distance = {
								source = prev
								max_distance = 90
								min_distance = 0
							}
							exists = space_owner
						}
						exists = space_owner
						is_fe_cluster = yes
					}
					#	any_planet = {
					#		is_rim_system = no
					#	}
				}
				spawn_system = {
					min_distance = 0
					max_distance = 10
					initializer = human_fallen_empires_drone_sector_01
				}
				spawn_system = {
					min_distance = 0
					max_distance = 10
					initializer = human_fallen_empires_drone_sector_02
				}
				spawn_system = {
					min_distance = 0
					max_distance = 10
					initializer = human_fallen_empires_drone_sector_03
				}
			}
		}
		set_global_flag = human_fallen_empires_installed
	}
}

# functional events for yearly pulse
event = {
	id = human_fallen_empires.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# spawn pirates
		random_country = {
			limit = {
				is_country_type = default
				num_owned_planets > 2
			}
			country_event = { id = human_fallen_empires.650 days = 1 random = 365 }
		}
		# pirates life
		every_country = {
			limit = {
				is_country_type = human_fallen_empires_pirate
			}
			country_event = { id = human_fallen_empires.651 days = 1 random = 365 }
		}
	}
}

# functional events for bi yearly pulse
event = {
	id = human_fallen_empires.2
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# make discovery default country
		if = {
			limit = {
				any_country = {
					is_country_type = human_fallen_empires_discovery
					num_owned_planets > 0
				}
			}
			random_country = {
				limit = {
					is_country_type = human_fallen_empires_discovery
					num_owned_planets > 0
				}
				set_country_type = default
			}
		}
		# assimilation event for coalition
		random_country = {
			limit = {
				has_country_flag = human_fallen_empires_coalition_leader
			}
			country_event = { id = human_fallen_empires.5020 }
		}
		# varelse mahanicus event
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_varelse_mehanicus
				}
			}
			random_planet = {
				limit = {
					has_planet_flag = human_fallen_empires_varelse_colony
					has_observation_outpost = yes
					exists = owner
					owner = {
						is_country_type = primitive
					}
					observation_outpost_owner = {
						is_ai = no
					}
				}
				planet_event = { id = human_fallen_empires.101 days = 1 random = 365 }
			}
		}
		# fallen emp drain resurces from vassals
		if = {
			limit = {
				has_global_flag = human_fallen_empires_war_in_heaven_started
				any_country = {
					is_country_type = awakened_fallen_empire
					is_at_war = yes
					is_war_leader = yes
					is_proposing_war_demands = yes
					or = {
						any_war = {
							any_defender = {
								is_country = prev
							}
							defender_war_score < -20
						}
						any_war = {
							any_defender = {
								is_country = prev
							}
							attacker_war_score < -20
						}
					}
				}
			}
			random_country = {
				limit = {
					is_country_type = awakened_fallen_empire
					is_at_war = yes
					is_war_leader = yes
					is_proposing_war_demands = yes
					or = {
						any_war = {
							any_defender = {
								is_country = prevprev
							}
							defender_war_score < -20
						}
						any_war = {
							any_defender = {
								is_country = prevprev
							}
							attacker_war_score < -20
						}
					}
				}
				every_subject = {
					limit = {
						not = {
							has_modifier = human_fallen_empires_fallen_resurces_drain
						}
					}
					country_event = { id = human_fallen_empires.10200 }
				}
			}
		}
	}
}

# functional events for decade pulse
event = {
	id = human_fallen_empires.3
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# kad republic buy robots dialoge
		if = {
			limit = {
				exists = event_target:human_fallen_empires_future_country
				not = {
					has_global_flag = human_fallen_empires_future_take_robot
				}
				any_country = {
					is_ai = no
					any_owned_pop = {
						has_trait = trait_mechanical
					}
					not = {
						has_country_flag = human_fallen_empires_future_try_take_robot
					}
					event_target:human_fallen_empires_future_country = {
						has_communications = prev
					}
				}
			}
			random_list = {
				2 = { }
				1 = {
					random_country = {
						limit = {
							is_ai = no
							any_owned_pop = {
								has_trait = trait_mechanical
							}
							not = {
								has_country_flag = human_fallen_empires_future_try_take_robot
							}
						}
						country_event = { id = human_fallen_empires.5100 days = 1 random = 3650 }
					}
				}
			}
		}
		# future is in expansion
		if = {
			limit = {
				exists = event_target:human_fallen_empires_future_country
			}
			event_target:human_fallen_empires_future_country = {
				country_event = { id = human_fallen_empires.5010 days = 1 random = 3650 }
			}
		}
		# egypt is in expansion
		if = {
			limit = {
				exists = event_target:human_fallen_empires_egypt_country
			}
			event_target:human_fallen_empires_egypt_country = {
				country_event = { id = human_fallen_empires.11 days = 1 random = 3650 }
			}
		}
	}
}

# contact with egypt
country_event  = {
	id = human_fallen_empires.4
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		from = {
			has_country_flag = human_fallen_empires_egypt
			is_country_type = human_fallen_empire
		}
		#	not = {
		#		has_country_flag = human_fallen_empires_egypt_wormhole
		#	}
	}

	immediate = {
		establish_communications = from
		set_country_flag = human_fallen_empires_egypt_contacted
		if = {
			limit = {
				is_ai = no
			}
			country_event = { id = human_fallen_empires.5 }
			else = {
				from = {
					set_closed_borders = {
						who = root
						status = yes
					}
				}
			}
		}
	}
}

# meeting dialoge egypt
country_event = {
	id = human_fallen_empires.5
	title = TRANSMISSION
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				human_fallen_empires_egypt_wormhole = { text = human_fallen_empires.5.desc }
				default = { text = human_fallen_empires.5.desc.1 }
				egp_step1 = { text = human_fallen_empires.5.desc.2 }
				egp_step2 = { text = human_fallen_empires.5.desc.3 }
				egp_step3 = { text = human_fallen_empires.5.desc.4 }
				egp_step4 = { text = human_fallen_empires.5.desc.5 }
				egp_stepbadend = { text = human_fallen_empires.5.desc.6 }
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	#	immediate = {

	#	}

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_country
		room = human_fallen_empires_egypt_room
	}

	# step 0
	option = {
		name = human_fallen_empires.5.0.0
		trigger = {
			nor = {
				has_country_flag = egp_step1
				has_country_flag = egp_step2
				has_country_flag = egp_step3
				has_country_flag = egp_step4
				has_country_flag = human_fallen_empires_marked_as_human
			}
			has_ethic = ethic_fanatic_xenophobe
		}
		hidden_effect = {
			set_country_flag = egp_stepbadend
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.0.1
		trigger = {
			any_country = {
				has_communications = root
				not = { is_same_value = root}
				has_country_flag = human_fallen_empires_future
			}
			nor = {
				has_country_flag = egp_step1
				has_country_flag = egp_step2
				has_country_flag = egp_step3
				has_country_flag = egp_step4
			}
		}
		hidden_effect = {
			set_country_flag = egp_step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.0.2
		trigger = {
			nor = {
				has_country_flag = egp_step1
				has_country_flag = egp_step2
				has_country_flag = egp_step3
				has_country_flag = egp_step4
			}
			human_fallen_empires_trigger_is_xenophobe = no
			has_country_flag = human_fallen_empires_marked_as_human
		}
		hidden_effect = {
			set_country_flag = egp_step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.0.3
		trigger = {
			nor = {
				has_country_flag = egp_step1
				has_country_flag = egp_step2
				has_country_flag = egp_step3
				has_country_flag = egp_step4
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		hidden_effect = {
			set_country_flag = egp_step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.0.4
		trigger = {
			nor = {
				has_country_flag = egp_step1
				has_country_flag = egp_step2
				has_country_flag = egp_step3
				has_country_flag = egp_step4
			}
			has_ethic = ethic_fanatic_spiritualist
		}
		hidden_effect = {
			set_country_flag = egp_step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.5
			}
		}
		# добавить плюс к отношениям
	}
	option = {
		name = human_fallen_empires.5.0.5
		trigger = {
			nor = {
				has_country_flag = egp_step1
				has_country_flag = egp_step2
				has_country_flag = egp_step3
				has_country_flag = egp_step4
			}
			has_ethic = ethic_fanatic_militarist
			fleet_power > 20000
		}
		hidden_effect = {
			set_country_flag = egp_stepbadend
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.0.6
		trigger = {
			nor = {
				has_country_flag = egp_step1
				has_country_flag = egp_step2
				has_country_flag = egp_step3
				has_country_flag = egp_step4
				has_country_flag = human_fallen_empires_marked_as_human
			}
			any_country = {
				has_communications = root
				not = {
					is_country = root
				}
				or = {
					has_country_flag = human_fallen_empires_future
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
		}
		hidden_effect = {
			set_country_flag = egp_step1
			remove_country_flag = human_fallen_empires_egypt_wormhole
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.5.1.0
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_militarist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.1.1
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.1.2
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_materialist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.1.3
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_individualist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.1.4
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_pacifist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.1.5
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.1.6
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_spiritualist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.1.7
		trigger = {
			has_country_flag = egp_step1
			human_fallen_empires_trigger_is_collectivist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step1
			set_country_flag = egp_step2
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	# step 2
	option = {
		name = human_fallen_empires.5.2.0
		trigger = {
			has_country_flag = egp_step2
			or = {
				has_country_flag = human_1
				and = {
					any_system_within_border = {
						has_star_flag = sol
					}
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.1
		trigger = {
			has_country_flag = egp_step2
			has_country_flag = human_2
			or = {
				not = {
					any_system = {
						has_star_flag = sol
					}
				}
				any_system = {
					has_star_flag = sol
					is_surveyed = {
						who = root
						status = no
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.2
		trigger = {
			has_country_flag = egp_step2
			has_country_flag = human_2
			any_system = {
				has_star_flag = sol
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.3
		trigger = {
			has_country_flag = egp_step2
			nor = {
				any_system = {
					has_star_flag = sol
					is_surveyed = {
						who = root
						status = yes
					}
				}
				has_country_flag = human_1
				has_country_flag = human_2
			}
			has_country_flag = human_fallen_empires_marked_as_human
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.4
		trigger = {
			has_country_flag = egp_step2
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			any_country = {
				is_country_type = default
				has_communications = root
				not = { is_country = root}
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.5
		trigger = {
			has_country_flag = egp_step2
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			or = {
				not = {
					any_system = {
						has_star_flag = sol
					}
				}
				any_system = {
					has_star_flag = sol
					is_surveyed = {
						who = root
						status = no
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.6
		trigger = {
			has_country_flag = egp_step2
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			any_system = {
				has_star_flag = sol
				has_star_flag = nuked_sol
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.7
		trigger = {
			has_country_flag = egp_step2
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			any_system = {
				has_star_flag = sol
				has_star_flag = primitive_sol
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.2.8
		trigger = {
			has_country_flag = egp_step2
			or = {
				has_country_flag = human_fallen_empires_marked_as_human
				human_fallen_empires_trigger_is_xenophile = yes
			}
			or = {
				any_system = {
					has_star_flag = sol
					is_surveyed = {
						who = root
						status = no
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = egp_step2
			set_country_flag = egp_step3
			country_event = {
				id = human_fallen_empires.5
			}
			begin_event_chain = {
				event_chain = human_fallen_empires_find_sol_chain
				target = root
			}
			random_system = {
				limit = {
					has_star_flag = sol
				}
				save_event_target_as = human_fallen_empires_sol
				set_star_flag = human_fallen_empires_sol_target
			}
			set_country_flag = human_fallen_empires_sol_search
			create_point_of_interest = {
				id = human_fallen_empires_sol.1
				name = "sol_1_poi"
				desc = human_fallen_empires_find_sol_chain_desc.1
				event_chain = human_fallen_empires_find_sol_chain
				location = event_target:human_fallen_empires_sol
			}
		}
	}
	#step 3
	option = {
		name = human_fallen_empires.5.3.0
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_militarist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.3.1
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.3.2
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_materialist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.3.3
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_individualist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.3.4
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_pacifist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.3.5
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.3.6
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_spiritualist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	option = {
		name = human_fallen_empires.5.3.7
		trigger = {
			has_country_flag = egp_step3
			human_fallen_empires_trigger_is_collectivist = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step3
			set_country_flag = egp_step4
			country_event = {
				id = human_fallen_empires.5
			}
		}
	}
	#step 4
	option = {
		name = human_fallen_empires.5.4.0
		trigger = {
			has_country_flag = egp_step4
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = egp_step4
			event_target:human_fallen_empires_egypt_country = {
				set_closed_borders = {
					who = root
					status = yes
				}
			}
		}

		#добавить бонус к счастью
	}
	option = {
		name = human_fallen_empires.5.4.1
		trigger = {
			has_country_flag = egp_step4
			has_country_flag = human_fallen_empires_marked_as_human
		}
		hidden_effect = {
			remove_country_flag = egp_step4
			event_target:human_fallen_empires_egypt_country = {
				set_closed_borders = {
					who = root
					status = yes
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.5.4.2
		trigger = {
			has_country_flag = egp_step4
		}
		hidden_effect = {
			remove_country_flag = egp_step4
			event_target:human_fallen_empires_egypt_country = {
				set_closed_borders = {
					who = root
					status = yes
				}
			}
		}
	}
	#сделать бонусную ветку
}

# kill country event
country_event  = {
	id = human_fallen_empires.9
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		destroy_country = yes
	}
}

# make egypt default country
country_event = {
	id = human_fallen_empires.11
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_egypt_in_expansion
		}
		or = {
			years_passed > 90
			any_country = {
				is_country_type = default
				fleet_power > 30000
			}
		}
	}

	immediate = {
		every_owned_ship = {
			repair_ship = yes
			add_modifier = {
				modifier = human_fallen_empires_unkeep
				days = -1
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_navy_size
			days = 3650
		}
		country_add_ethic = ethic_xenophobe
		every_owned_pop = {
			pop_add_ethic = ethic_xenophobe
			pop_add_ethic = ethic_fanatic_spiritualist
		}
		set_country_type = default
		set_global_flag = human_fallen_empires_egypt_in_expansion
		ruler = {
			save_event_target_as = human_fallen_empires_egypt_ruler
		}
		every_country = {
			establish_communications_no_message = event_target:human_fallen_empires_egypt_country
			if = {
				limit = {
					is_ai = no
				}
				country_event = {
					id = human_fallen_empires.12
				}
				set_country_flag = human_fallen_empires_egypt_contacted
			}
		}
		random_country = {
			limit = {
				is_country_type = default
				fleet_power > 30000
			}
			log = "egypt awekened by [This.GetName]"
		}
	}
}

# go to expansion dialoge
country_event = {
	id = human_fallen_empires.12
	title = human_fallen_empires.12.name
	desc = human_fallen_empires.12.desc.0
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_ruler
		room = human_fallen_empires_egypt_room
	}

	option = {
		name = human_fallen_empires.12.0
	}
}


## anomalys and after survey on actions 50 - 100

# wormhole to ju ahet 50
ship_event = {
	id = human_fallen_empires.50
	title = human_fallen_empires.50.name
	desc = human_fallen_empires.50.desc
	picture = GFX_evt_human_fallen_empires_wormhole
	show_sound = event_ship_thrusters
	location = root
    is_triggered_only = yes

	immediate = {
		random_country = {
			limit = {
				has_country_flag = human_fallen_empires_egypt
			}
			random_owned_planet = {
				limit = {
					is_capital = yes
				}
				save_event_target_as = human_fallen_empires_ra_home
			}
		}
		owner = {
			set_country_flag = human_fallen_empires_egypt_wormhole
		}
	}

	option = {
		name = human_fallen_empires.50.0
		hidden_effect = {
			fleet = {
				set_location = {
					target = event_target:human_fallen_empires_ra_home
					distance = 5
					angle = random
				}
			}
			#	remove_country_flag = human_fallen_empires_egypt_wormhole
		}
	}
}

# varelse fleet in time trap 51-53

# start event
ship_event = {
	id = human_fallen_empires.51
	title = human_fallen_empires.51.name
	desc = human_fallen_empires.51.desc
	picture = GFX_evt_human_fallen_empires_station
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_varelse_fleet_location
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_has_event.51
		}
		exists = owner
		owner = {
			is_ai = no
		}
	}

	immediate = {
		set_global_flag = human_fallen_empires_has_event.51
		create_ambient_object = {
			type = ancient_battlefield_object
			location = solar_system
		}
		last_created_ambient_object = {
			save_event_target_as = human_fallen_empires_varelse_fleet_location
		}
		enable_special_project = {
			name = human_fallen_empires_varelse_fleet_project
			location = event_target:human_fallen_empires_varelse_fleet_location
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires.51.0
		trigger = {
			is_ship_size = science
		}
	}
	option = {
		name = human_fallen_empires.51.1
		trigger = {
			not = {
				is_ship_size = science
			}
		}
	}
}

# project complite
ship_event = {
	id = human_fallen_empires.52
	title = human_fallen_empires.52.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.52.desc.0
				owner = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
			text = human_fallen_empires.52.desc.1
		}
	}
	picture = GFX_evt_human_fallen_empires_wormhole
	show_sound = event_ship_thrusters
	location = root
    is_triggered_only = yes

	immediate = {
		create_country = {
			name = "Varelse Hegemony"
			type = faction
			effect = {
				establish_communications_no_message = root.owner
				set_faction_hostility = {
					set_hostile = no
				}
				create_leader = {
					type = admiral
					species = event_target:human_fallen_empires_varelse_species
					name = random
					skill = 500
				}
			}
		}
		create_fleet = {
			name = "11th Strike Force"
			effect = {
				set_owner = last_created_country
				while = {
					count = 10
					create_ship = {
						name = random
						design = Sunset
						graphical_culture = "reptilian_01"
					}
				}
				assign_leader = last_created_leader
				while = {
					count = 30
					create_ship = {
						name = random
						design = Farstar
						graphical_culture = "reptilian_01"
					}
				}
				owner = {
					every_owned_ship = {
						add_modifier = {
							modifier = human_fallen_empires_unkeep
							days = -1
						}
					}
				}
				set_location = root
				save_event_target_as = human_fallen_empires_varelse_fleet
			}
		}
		#	destroy_ambient_object = event_targe:human_fallen_empires_varelse_fleet_location
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		custom_tooltip = human_fallen_empires.53.0.tooltip
		hidden_effect = {
			owner = {
				country_event = { id = human_fallen_empires.53 }
				set_country_flag = human_fallen_empires.53.0
			}
		}
	}
}

# dialogue with fleet
country_event = {
	id = human_fallen_empires.53
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.53.desc.0.0
				has_country_flag = human_fallen_empires.53.0
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.0
				has_country_flag = human_fallen_empires.53.0.0
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.1
				or = {
					has_country_flag = human_fallen_empires.53.0.1
					has_country_flag = human_fallen_empires.53.0.2
				}
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.2
				or = {
					has_country_flag = human_fallen_empires.53.0.3
					has_country_flag = human_fallen_empires.53.0.4
				}
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_varelse_species
		room = human_fallen_empires_varelse_room
	}

	option = {
		name = human_fallen_empires.53.0.0
		trigger = {
			has_country_flag = human_fallen_empires.53.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.0
			country_event = { id = human_fallen_empires.53 }
		}
	}
	option = {
		name = human_fallen_empires.53.0.1
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
			human_fallen_empires_trigger_is_xenophobe = yes

		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.1
			country_event = { id = human_fallen_empires.53 }
		}
	}
	option = {
		name = human_fallen_empires.53.0.2
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
			human_fallen_empires_trigger_is_militarist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.2
			country_event = { id = human_fallen_empires.53 }
		}
	}
	option = {
		name = human_fallen_empires.53.0.3
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.3
			country_event = { id = human_fallen_empires.53 }
		}
	}
	option = {
		name = human_fallen_empires.53.0.4
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			human_fallen_empires_trigger_is_pacifist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.4
			country_event = { id = human_fallen_empires.53 }
		}
	}
	option = {
		name = human_fallen_empires_end_transmission
		trigger = {
			or = {
				has_country_flag = human_fallen_empires.53.0.0
				has_country_flag = human_fallen_empires.53.0.1
				has_country_flag = human_fallen_empires.53.0.2
				has_country_flag = human_fallen_empires.53.0.3
				has_country_flag = human_fallen_empires.53.0.4
			}
		}
		hidden_effect = {
			# attack home of light
			if = {
				limit = {
					or = {
						has_country_flag = human_fallen_empires.53.0.0
						has_country_flag = human_fallen_empires.53.0.1
						has_country_flag = human_fallen_empires.53.0.2
					}
				}
				remove_country_flag = human_fallen_empires.53.0.0
				remove_country_flag = human_fallen_empires.53.0.1
				remove_country_flag = human_fallen_empires.53.0.2
				event_target:human_fallen_empires_varelse_fleet = {
					human_fallen_empires_effect_varelse_fleet_attack_home_of_light = yes
				}
			}
			# found new home
			if = {
				limit = {
					or = {
						has_country_flag = human_fallen_empires.53.0.3
						has_country_flag = human_fallen_empires.53.0.4
					}
				}
				remove_country_flag = human_fallen_empires.53.0.3
				remove_country_flag = human_fallen_empires.53.0.4
				event_target:human_fallen_empires_varelse_fleet = {
					human_fallen_empires_effect_varelse_fleet_find_new_home = yes
				}
			}
		}
	}
}



### varelse section 100 - 150

# varlse colony after curvey 100
ship_event = {
	id = human_fallen_empires.100
	title = human_fallen_empires.100.name
	desc = human_fallen_empires.100.desc
	picture = GFX_evt_human_fallen_empire_events_valeres_planet
	location = root
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_ai = no
		}
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_varelse_colony
		}
		exists = from.owner
		from.owner = {
			is_country_type = primitive
		}
	}

	option = {
		name = human_fallen_empires.100.0
	}
}


## observation outpost events


## varelse mehanicus

# start event
planet_event = {
	id = human_fallen_empires.101
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_observation_outpost = yes
	}

	immediate = {
		set_global_flag = human_fallen_empires_varelse_mehanicus
		observation_outpost_owner = {
			country_event = { id = human_fallen_empires.102 }
		}
		save_event_target_as = human_fallen_empires_varelse_colony
	}
}

# choice
country_event = {
	id = human_fallen_empires.102
	title = human_fallen_empires.102.name
	desc = human_fallen_empires.102.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	#lets go to artifact
	option = {
		name = human_fallen_empires.102.0
		hidden_effect = {
			country_event = { id = human_fallen_empires.103 days = 12 random = 4 }
		}
		custom_tooltip = human_fallen_empires.102.0.tooltip
	}
	option = {
		name = human_fallen_empires.102.1
		hidden_effect = {
			if = {
				limit = {
					human_fallen_empires_trigger_is_xenophobe = yes
				}
				country_event = { id = human_fallen_empires.105 days = 10 random = 5 }#lets go to factory and destroy it
				else = {
					country_event = { id = human_fallen_empires.106 days = 11 random = 5 }#lets go to factory
				}
			}
		}
		custom_tooltip = human_fallen_empires.102.1.tooltip
	}
	#lets revolt (materialist)
	option = {
		name = human_fallen_empires.102.2
		trigger = {
			human_fallen_empires_trigger_is_materialist = yes
		}
		hidden_effect = {
			country_event = { id = human_fallen_empires.107 days = 100 random = 20 }
		}
	}
	#lets infiltrat
	option = {
		name = human_fallen_empires.102.3
		trigger = {
			from = {
				observation_outpost = { has_mission = covert_infiltration }
			}
		}
		hidden_effect = {
			country_event = { id = human_fallen_empires.108 days = 100 random = 20 }
		}
	}
	option = {
		name = human_fallen_empires.102.4
	}
}

# lets go to artifact
country_event = {
	id = human_fallen_empires.103
	title = human_fallen_empires.103.name
	desc = human_fallen_empires.103.desc
	# картинка скрижали?
	picture = GFX_evt_human_fallen_empire_events_valeres_planet
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_varelse_colony

	is_triggered_only = yes

	option = {
		name = human_fallen_empires_at_the_sreen
		hidden_effect = {
			country_event = { id = human_fallen_empires.104 }
		}
	}
}

# history of varelse
country_event = {
	id = human_fallen_empires.104
	title = "human_fallen_empires.104.name"
	desc = "human_fallen_empires.104.desc"
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		room = human_fallen_empires_varelse_room
	}

	option = {
		name = human_fallen_empires.104.0
		response_text = human_fallen_empires.104.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.104.1
		response_text = human_fallen_empires.104.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.104.2
		response_text = human_fallen_empires.104.2.response
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier2researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
	}
}

# lets go to factory
country_event = {
	id = human_fallen_empires.105
	title = "human_fallen_empires.105.name"
	desc = "human_fallen_empires.105.desc"
	picture = GFX_evt_human_fallen_empire_events_valeres_planet
	show_sound = event_cityscape
	location = event_target:human_fallen_empires_varelse_colony

	is_triggered_only = yes

	option = {
		name = "human_fallen_empires_good_job"
		add_monthly_resource_mult = {
			resource = engineering_research
			value = @tier2researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
	}
}

# lets go to factory and destroy it
country_event = {
	id = human_fallen_empires.106
	title = "human_fallen_empires.105.name"
	desc = "human_fallen_empires.106.desc"
	picture = GFX_evt_human_fallen_empire_events_valeres_planet
	show_sound = event_cityscape
	location = event_target:human_fallen_empires_varelse_colony

	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_colony = {
			owner = {
				human_fallen_empires_effect_down_primitive_teh_lvl = yes
			}
			every_tile = {
				limit = { has_building = yes }
				set_ruined = yes
			}
			random_pop = {
				kill_pop = yes
			}
			random_pop = {
				kill_pop = yes
			}
		}
	}

	option = {
		name = "human_fallen_empires.106.0"
		trigger = {
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		add_monthly_resource_mult = {
			resource = engineering_research
			value = @tier2researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = @tier2researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
	}
}

# materialist result lets revolt
country_event = {
	id = human_fallen_empires.107
	title = "human_fallen_empires.107.name"
	desc = "human_fallen_empires.107.desc"
	picture = GFX_evt_human_fallen_empire_events_valeres_planet
	show_sound = event_planetary_riot
	location = event_target:human_fallen_empires_varelse_colony

	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_colony = {
			owner = {
				human_fallen_empires_effect_up_primitive_teh_lvl = yes
				country_remove_ethic = "ethic_spiritualist"
				country_add_ethic = "ethic_materialist"
				every_owned_pop = {
					pop_remove_ethic = "ethic_spiritualist"
					pop_add_ethic = "ethic_materialist"
				}
			}
		}
	}

	option = {
		name = "human_fallen_empires.107.0"
		trigger = {
			human_fallen_empires_trigger_is_materialist = yes
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = @tier2researchreward
			min = @tier2researchmin
			max = @tier2researchmax
		}
	}
}

# lets infiltrate
country_event = {
	id = human_fallen_empires.108
	title = "human_fallen_empires.108.name"
	desc = "human_fallen_empires.108.desc"
	picture = GFX_evt_human_fallen_empire_events_valeres_planet
	show_sound = event_primitive_civilization
	location = event_target:human_fallen_empires_varelse_colony

	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_colony = {
			observation_outpost = { add_mission_progress = 0.3 }
		}
	}

	option = {
		name = "human_fallen_empires_good_job"
	}
}



### memorial section 150 - 350


## pyramid events 150 - 200

# start
planet_event = {
	id = human_fallen_empires.150
	title = "human_fallen_empires.150.name"
	desc = "human_fallen_empires.150.desc"
	picture = GFX_evt_human_fallen_empires_pyramid_2
	show_sound = event_mystic_reveal
	location = ROOT
	is_triggered_only = yes

	trigger = {
		not = { has_planet_flag = human_fallen_empires_planet_pyramid }
		has_modifier = "human_fallen_empires_memorial"
		exists = owner
		owner = {
			is_ai = no
		}
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_planet_pyramid
	}

	option = {
		name = "human_fallen_empires.150.0"
		enable_special_project = {
			name = "human_fallen_empires_pyramid_project"
			location = root
			owner = root.owner
		}
		save_event_target_as = human_fallen_empires_memorial_planet
	}
	option = {
		name = "human_fallen_empires_not_interested"
	}
}

# golocube
ship_event = {
	id = human_fallen_empires.151
	title = "human_fallen_empires.151.name"
	desc = "human_fallen_empires.151.desc"
	picture = GFX_evt_human_fallen_empires_pyramid_2
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	option = {
		name = "human_fallen_empires.151.0"
		hidden_effect = {
			root.owner = {
				country_event = { id = human_fallen_empires.152 }
				set_country_flag = human_fallen_empires_has_event.151
			}
		}
	}
}

# memorial story
country_event = {
	id = human_fallen_empires.152
	title = "human_fallen_empires.152.name"
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				human_fallen_empires.152.0 = { text = human_fallen_empires.152.desc.1 }
				default = { text = human_fallen_empires.152.desc.0 }
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_memorial_story_room
	}

	option = {
		name = human_fallen_empires.152.0
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.152.0
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.152.0
			country_event = { id = human_fallen_empires.152 }
		}
	}
	option = {
		name = human_fallen_empires.152.1
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = governor
				species = event_target:human_fallen_empires_egypt_species
				name = random
				skill = 0
			}
			last_created_leader = {
				set_skill = 3
			}

		}
	}
	option = {
		name = human_fallen_empires.152.2
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = scientist
				species = event_target:human_fallen_empires_egypt_species
				name = random
				skill = 0
			}
			last_created_leader = {
				set_skill = 3
			}

		}
	}
	option = {
		name = human_fallen_empires.152.3
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = admiral
				species = event_target:human_fallen_empires_egypt_species
				name = random
				skill = 0
			}
			last_created_leader = {
				set_skill = 3
			}
		}
	}
	option = {
		name = human_fallen_empires.152.4
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = general
				species = event_target:human_fallen_empires_egypt_species
				name = random
				skill = 0
			}
			last_created_leader = {
				set_skill = 3
			}
		}
	}
	#	option = {
	#		name = human_fallen_empires.152.5
	#		trigger = {
	#			has_country_flag = human_fallen_empires.152.0
	#		}
	#		hidden_effect = {
	#		# добавить технологию
	#		}
	#	}

	after = {
		remove_country_flag = human_fallen_empires.152
	}
}

# obelisk
ship_event = {
	id = human_fallen_empires.153
	title = "human_fallen_empires.153.name"
	desc = "human_fallen_empires.153.desc"
	picture = GFX_evt_human_fallen_empires_obelisk
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.153
		}
		event_target:human_fallen_empires_memorial_planet = {
			create_country = {
				name = "Gnosis"
				type = faction
				effect = {
					establish_communications_no_message = root.owner
				}
			}
			create_species = {
				name = "Gnosis"
				class = random
				portrait = random
				traits = random
			}
			# запилить новый тип армии
			create_army = {
				name = "Gnosis"
				owner = last_created
				species = last_created
				type = "titanic_guardian_army"
			}
			create_army = {
				name = "Gnosis"
				owner = last_created
				species = last_created
				type = "titanic_assault_army"
			}
			create_army = {
				name = "Gnosis"
				owner = last_created
				species = last_created
				type = "titanic_assault_army"
			}
		}
	}

	option = {
		name = "human_fallen_empires.153.0"
	}
}

# mutant cloud
ship_event = {
	id = human_fallen_empires.154
	title = "human_fallen_empires.154.name"
	desc = "human_fallen_empires.154.desc"
	picture = GFX_evt_human_fallen_empire_events_city_cloud
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.154
		}
		event_target:human_fallen_empires_memorial_planet = {
			planet_event = { id = human_fallen_empires.155 days = 15 }
		}
	}

	option = {
		name = "human_fallen_empires.155.0"
	}
}

# lets mutate
planet_event = {
	id = human_fallen_empires.155
	title = "human_fallen_empires.154.name"
	desc = "human_fallen_empires.155.desc"
	picture = GFX_evt_human_fallen_empire_events_city_cloud
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		every_owned_pop = {
			human_fallen_empires_effect_add_random_trait = yes
		}
	}

	option = {
		name = "human_fallen_empires.155.0"
		custom_tooltip = human_fallen_empires.155.tooltip
	}
}

# tomb
ship_event = {
	id = human_fallen_empires.156
	title = "human_fallen_empires.156.name"
	desc = "human_fallen_empires.156.desc"
	picture = GFX_evt_human_fallen_empires_strange_tech
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.156
		}
	}

	option = {
		name = "human_fallen_empires.156.0"
		hidden_effect = {
			event_target:human_fallen_empires_memorial_planet = {
				random_list = {
					50 = {
						add_modifier = {
							modifier = "human_fallen_empires_tomb_happy"
							days = 360
						}
					}
					50 = {
						add_modifier = {
							modifier = "human_fallen_empires_tomb_unhappy"
							days = 360
						}
					}
				}
			}
		}
		# нужно добавить штраф к отношениям
	}
}


## military warehouse events 200 - 250

# start
planet_event = {
	id = human_fallen_empires.200
	title = "human_fallen_empires.200.name"
	desc = "human_fallen_empires.200.desc"
	picture = GFX_evt_human_fallen_empire_events_weapon_storage
	show_sound = event_mystic_reveal
	location = ROOT
	is_triggered_only = yes

	trigger = {
		not = {
			has_planet_flag = human_fallen_empires_military_warehouse_planet
		}
		has_modifier = human_fallen_empires_memorial
		exists = owner
		owner = {
			is_ai = no
		}
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_military_warehouse_planet
	}

	option = {
		name = human_fallen_empires.200.0
		enable_special_project = {
			name = human_fallen_empires_military_warehouse_project
			location = root
			owner = root.owner
		}
		save_event_target_as = human_fallen_empires_memorial_planet
	}

	option = {
		name = human_fallen_empires_not_interested
	}
}

# defense system
ship_event = {
	id = human_fallen_empires.201
	title = human_fallen_empires.201.name
	desc = human_fallen_empires.201.desc
	picture = GFX_evt_human_fallen_empire_events_weapon_storage_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.201
		}
	}

	option = {
		name = human_fallen_empires.201.0
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_army_planet_defense_damage_mult
				days = -1
			}
		}
	}
}

# abandoned armory
ship_event = {
	id = human_fallen_empires.202
	title = human_fallen_empires.202.name
	desc = human_fallen_empires.202.desc
	picture = GFX_evt_human_fallen_empire_events_weapon_storage_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.202
		}
	}

	option = {
		name = human_fallen_empires.202.0
		owner = {
			add_modifier = {
				modifier = human_fallen_empires_army_attack_damage_mult
				days = -1
			}
		}
	}
}

# abandoned librariy
ship_event = {
	id = human_fallen_empires.203
	title = human_fallen_empires.203.name
	desc = human_fallen_empires.203.desc
	picture = GFX_evt_human_fallen_empire_events_library_old
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.203
		}
	}

	option = {
		name = human_fallen_empires.203.0
		owner = {
			add_modifier = {
				modifier = human_fallen_empires_army_defense_damage_mult
				days = -1
			}
		}
	}
}

# abandoned military academy
ship_event = {
	id = human_fallen_empires.204
	title = human_fallen_empires.204.name
	desc = human_fallen_empires.204.desc
	picture = GFX_evt_human_fallen_empire_events_weapon_storage
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.204
		}
	}

	option = {
		name = human_fallen_empires.204.0
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_army_academy
				days = -1
			}
		}
	}
}

# explosion of the warehouse
country_event = {
	id = human_fallen_empires.205
	title = human_fallen_empires.205.name
	desc = {
		trigger = {
			# scientist survived
			success_text = {
				text = human_fallen_empires.205.desc.0
				has_country_flag = human_fallen_empires.205.0
			}
			# scientist wounded
			success_text = {
				text = human_fallen_empires.205.desc.1
				has_country_flag = human_fallen_empires.205.1
			}
			# scientist recovered
			success_text = {
				text = human_fallen_empires.205.desc.2
				has_country_flag = human_fallen_empires.205.2
			}
			# scientist dead
			success_text = {
				text = human_fallen_empires.205.desc.3
				has_country_flag = human_fallen_empires.205.3
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_explosion
	show_sound = event_ship_explosion
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		set_country_flag = human_fallen_empires_has_event.205
		if = {
			limit = {
				has_country_flag = human_fallen_empires.205.1
			}
			event_target:human_fallen_empires_ship = {
				fleet = {
					exile_leader_as = human_fallen_empires_scientist_wounded
				}
			}
		}
		# имя лидера будет некорректно отображаться, если корабля нет
		if = {
			limit = {
				has_country_flag = human_fallen_empires.205.2
			}
			if = {
				limit = {
					exists = event_target:human_fallen_empires_ship
				}
				event_target:human_fallen_empires_ship = {
					fleet = {
						set_leader = human_fallen_empires_scientist_wounded
					}
				}
				else = {
					set_leader = human_fallen_empires_scientist_wounded
				}
			}
		}
		if = {
			limit = {
				has_country_flag = human_fallen_empires.205.3
			}
			event_target:human_fallen_empires_ship = {
				fleet = {
					kill_leader = {	type = scientist show_notification = no }
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.205.0
		trigger = {
			has_country_flag = human_fallen_empires.205.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.0
		}
	}
	option = {
		name = human_fallen_empires.205.1
		trigger = {
			has_country_flag = human_fallen_empires.205.1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.1
			set_country_flag = human_fallen_empires.205.2
			country_event = { id = human_fallen_empires.205 days = 60 random = 120 }
		}
	}
	option = {
		name = human_fallen_empires.205.2
		trigger = {
			has_country_flag = human_fallen_empires.205.2
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.2
		}
	}
	option = {
		name = human_fallen_empires.205.3
		trigger = {
			has_country_flag = human_fallen_empires.205.3
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.205.3
		}
	}
}

# scientific bonus of the warehouse
ship_event = {
	id = human_fallen_empires.206
	title = "human_fallen_empires.206.name"
	desc = "human_fallen_empires.206.desc"
	picture = GFX_evt_human_fallen_empire_events_weapon_storage
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.206
		}
	}

	option = {
		name = "human_fallen_empires.206.0"
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
			set_country_flag = human_fallen_empires_military_warehouse_events_6
		}
	}
}

# dr moro
ship_event = {
	id = human_fallen_empires.207
	title = "human_fallen_empires.207.name"
	desc = "human_fallen_empires.207.desc"
	picture = GFX_evt_human_fallen_empire_events_weapon_storage
	show_sound = event_alien_nature
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.207
		}
	}

	option = {
		name = "human_fallen_empires.207.0"
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = "human_fallen_empires_tomb_unhappy"
				days = 360
			}
		}
	}
}


## found cruiser 250 - 300

# start
planet_event = {
	id = human_fallen_empires.250
	title = "human_fallen_empires.250.name"
	desc = "human_fallen_empires.250.desc"
	picture = GFX_evt_human_fallen_empires_ship_old
	show_sound = event_mystic_reveal
	location = ROOT
	is_triggered_only = yes

	trigger = {
		not = { has_planet_flag = human_fallen_empires_found_cruiser_planet }
		has_modifier = "human_fallen_empires_memorial"
		has_owner = yes
		owner = { is_ai = no }
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_found_cruiser_planet
	}

	option = {
		name = "human_fallen_empires.250.0"
		enable_special_project = {
			name = "human_fallen_empires_found_cruiser_project"
			location = root
			owner = root.owner
		}
		save_event_target_as = human_fallen_empires_memorial_planet
	}

	option = {
		name = "human_fallen_empires_not_interested"
	}
}

# rotten skeleton
ship_event = {
	id = human_fallen_empires.251
	title = human_fallen_empires.251.name
	desc = human_fallen_empires.251.desc
	picture = GFX_evt_human_fallen_empires_ship_old
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.251
		}
	}

	option = {
		name = human_fallen_empires.251.0
		owner = {
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier2materialreward
				min = @tier2materialmin
				max = @tier2materialmax
			}
		}
	}
	option = {
		name = human_fallen_empires.251.1
		owner = {
			add_monthly_resource_mult = {
				resource = energy
				value = @tier2materialreward
				min = @tier2materialmin
				max = @tier2materialmax
			}
		}
	}
	option = {
		name = human_fallen_empires.251.2
		owner = {
			add_monthly_resource_mult = {
				resource = physics_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# explosion on the cruiser scientist dead
ship_event = {
	id = human_fallen_empires.252
	title = "human_fallen_empires.252.name"
	desc = "human_fallen_empires.252.desc"
	picture = GFX_evt_archaeological_dig
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.252
		}
	}

	option = {
		name = "human_fallen_empires.252.0"
		hidden_effect = {
			kill_leader = {	type = scientist show_notification = no }
		}
	}
}

# runaway cruiser
ship_event = {
	id = human_fallen_empires.253
	title = "human_fallen_empires.253.name"
	desc = {
		trigger = {
			fail_text = {
				text = "human_fallen_empires.253.desc.0"
				has_country_flag = human_fallen_empires_egypt_country
			}
			success_text = {
				text = "human_fallen_empires.253.desc.1"
				has_country_flag = human_fallen_empires_egypt_country
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ship
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.253
		}
	}

	immediate = {
		create_country = {
			name = "Cruiser"
			type = neutral_faction
			effect = {
				establish_communications_no_message = root.owner
				#		set_faction_hostility = {
				#			set_hostile = no
				#		}
			}
		}
		create_fleet = {
			name = "Cruiser"
			effect = {
				save_event_target_as = human_fallen_empires_cruiser # убрать, если работает owner
				set_owner = last_created_country
				create_ship = {
					name = random
					design = "Seth"
					graphical_culture = "mammalian_01"
					prefix = no
				}
				set_location = root
				set_fleet_stance = aggressive
				queue_actions = {
					find_closest_system = {
						trigger = {
							id = "human_fallen_empires.253.trigger.0"
							any_planet = {
								has_planet_flag = human_fallen_empires_varelse_colony
							}
						}
						found_system = {
							move_to = this
						}
					}
					find_closest_planet = {
						trigger = {
							id = "human_fallen_empires.253.trigger.1"
							has_planet_flag = human_fallen_empires_varelse_colony
						}
						found_planet = {
							orbit_planet = this
							effect = {
								id = "human_fallen_empires.253.effect.0"
								owner = {
									set_faction_hostility = {
										set_hostile = yes
									}
								}
							}
							repeat = {
								wait = 100
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = "human_fallen_empires.253.0"
	}
}

# cruiser became aggressive
ship_event = {
	id = human_fallen_empires.254
	title = "human_fallen_empires.254.name"
	desc = "human_fallen_empires.254.desc"
	picture = GFX_evt_human_fallen_empires_ship
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.254
		}
		create_country = {
			name = "Mad Cruiser"
			type = faction
			effect = {
				#		set_faction_hostility = {
				#			set_hostile = yes
				#		}
				establish_communications_no_message = root.owner
			}
		}
		create_fleet = {
			name = "Mad Cruiser"
			effect = {
				set_owner = last_created_country
				create_ship = {
					name = random
					design = "Seth"
					graphical_culture = "mammalian_01"
					prefix = no
				}
				set_fleet_stance = aggressive
				set_location = root
				queue_actions = {
					repeat = {
						find_closest_system = {
							trigger = {
								id = "human_fallen_empires.254.trigger.0"
								any_planet = {
									or = {
										has_mining_station = yes
										has_research_station = yes
									}
									exists = controller
									controller = { is_country = root.owner }
								}
							}
							found_system = {
								move_to = THIS
							}
						}
						find_closest_planet = {
							trigger = {
								id = "human_fallen_empires.254.trigger.1"
								or = {
									has_mining_station = yes
									has_research_station = yes
								}
								exists = controller
								controller = { is_country = root.owner }
							}
							found_planet = {
								orbit_planet = THIS
								wait = {
									duration = 20
								}
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = "human_fallen_empires.254.0"
	}
}

# love is
ship_event = {
	id = human_fallen_empires.255
	title = human_fallen_empires.255.name
	desc = human_fallen_empires.255.desc
	picture = GFX_evt_human_fallen_empires_ship_new
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.255
		}
		create_fleet = {
			name = "Marvin"
			effect = {
				set_owner = root.owner
				create_ship = {
					name = "Marvin"
					design = "Seth"
					graphical_culture = "mammalian_01"
					prefix = no
				}
				last_created_ship = {
					add_modifier = {
						modifier = human_fallen_empires_ship_weapon_range_mult
						days = -1
					}
				}
				set_location = root
				set_fleet_stance = aggressive
			}
		}
	}

	option = {
		name = human_fallen_empires.255.0
	}
}

# new cruiser
#ship_event = {
#	id = human_fallen_empires.257
#	title = "human_fallen_empires.257.name"
#	desc = "human_fallen_empires.257.desc"
#	picture = GFX_evt_archaeological_dig
#	show_sound = event_airlock
#	location = event_target:human_fallen_empires_memorial_planet
#
#	is_triggered_only = yes
#
#	immediate = {
#		create_fleet = { name = "Cruiser"}
#		last_created_fleet = {
#			set_owner = root.owner
#			create_ship = {
#				name = random
#				design = "Seth"
#				graphical_culture = "mammalian_01"
#				prefix = no
#			}
#			set_location = root
#			set_fleet_stance = aggressive
#		}
#	}
#
#	option = {
#		name = "human_fallen_empires.257.0"
#	}
#}


## sputnik 300 - 350

# start
planet_event = {
	id = human_fallen_empires.300
	title = "human_fallen_empires.300.name"
	desc = "human_fallen_empires.300.desc"
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		not = { has_planet_flag = human_fallen_empires_sputnik_planet }
		has_modifier = "human_fallen_empires_memorial"
		has_owner = yes
		owner = {
			is_ai = no
		}
		has_ground_combat = no
		num_pops > 0
		owner = {
			not = {
				and = {
					has_country_flag = human_fallen_empires_has_event.301
					has_country_flag = human_fallen_empires_has_event.302
					has_country_flag = human_fallen_empires_has_event.304
				}
			}
		}
	}

	immediate = {
		set_planet_flag = human_fallen_empires_sputnik_planet
	}

	option = {
		name = "human_fallen_empires.300.0"
		enable_special_project = {
			name = "human_fallen_empires_sputnik_project"
			location = root
			owner = root.owner
		}
		save_event_target_as = human_fallen_empires_memorial_planet
	}

	option = {
		name = "human_fallen_empires_not_interested"
	}
}

# bonus to the sensors
ship_event = {
	id = human_fallen_empires.301
	title = "human_fallen_empires.301.name"
	desc = "human_fallen_empires.301.desc"
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.301
		}
	}

	option = {
		name = human_fallen_empires.301.0
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_planet_sensor_range_mult
				days = -1
			}
		}
	}
}

# go to another events
ship_event = {
	id = human_fallen_empires.302
	title = "human_fallen_empires.302.name"
	desc = "human_fallen_empires.302.desc"
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.302
		}
	}

	option = {
		name = human_fallen_empires.302.0
		hidden_effect = {
			event_target:human_fallen_empires_memorial_planet = {
				random_list = {
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_planet_pyramid
						}
						planet_event = { id = human_fallen_empires.150 days = 1 }
					}
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_military_warehouse_planet
						}
						planet_event = { id = human_fallen_empires.200 days = 1 }
					}
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_found_cruiser_planet
						}
						planet_event = { id = human_fallen_empires.250 days = 1 }
					}
					1 = {
						root = {
							ship_event = { id = human_fallen_empires.303 days = 15 }
						}
					}
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.302.1
	}
}

# go to nothing
ship_event = {
	id = human_fallen_empires.303
	title = "human_fallen_empires.303.name"
	desc = "human_fallen_empires.303.desc"
	picture = GFX_evt_human_fallen_empires_satellite_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.303.0
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier1researchreward
				min = @tier1researchmin
				max = @tier1researchmax
			}
		}
	}
}

# eng bonus
ship_event = {
	id = human_fallen_empires.304
	title = "human_fallen_empires.304.name"
	desc = "human_fallen_empires.304.desc"
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.304
		}
	}

	option = {
		name = human_fallen_empires.304.0
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}


## find sol 350
ship_event = {
	id = human_fallen_empires.350
	title = human_fallen_empires.350.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.350.desc.0
				owner = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			fail_text = {
				text = human_fallen_empires.350.desc.1
				owner = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_sol_system
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		from = { has_star_flag = human_fallen_empires_sol_target }
		owner = { has_country_flag = human_fallen_empires_sol_search }
	}

	immediate = {
		from = { remove_star_flag = human_fallen_empires_sol_target }
		owner = {
			remove_country_flag = human_fallen_empires_sol_search
			add_event_chain_counter = {
				event_chain = "human_fallen_empires_find_sol_chain"
				counter = "found"
				amount = 1
			}
		}
	}

	option = {
		name = human_fallen_empires.350.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		owner = {
			add_monthly_resource_mult = {
				resource = influence
				value = @tier2influencereward
				min = @tier2influencemin
				max = @tier2influencemax
			}
		}
	}
	option = {
		name = human_fallen_empires.350.1
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_xenophile = yes
				not = { has_country_flag = human_fallen_empires_marked_as_human }
			}
		}
		owner = {
			add_monthly_resource_mult = {
				resource = influence
				value = @tier2influencereward
				min = @tier2influencemin
				max = @tier2influencemax
			}
		}
	}
	option = {
		name = human_fallen_empires.350.2
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_xenophile = yes
				human_fallen_empires_trigger_is_collectivist = yes
				not = { has_country_flag = human_fallen_empires_marked_as_human }
			}
		}
		owner = {
			add_monthly_resource_mult = {
				resource = influence
				value = @tier2influencereward
				min = @tier2influencemin
				max = @tier2influencemax
			}
		}
	}
	after = {
		owner = { end_event_chain = "human_fallen_empires_find_sol_chain" }
	}
}



### Ahet section 400 - 401

# ahet colonys after survey

# сolony 1
ship_event = {
	id = human_fallen_empires.400
	title = "human_fallen_empires.400.name"
	desc = {
		trigger = {
			success_text = {
				text = "human_fallen_empires.400.desc.0"
				has_country_flag = human_fallen_empires_ahet_found
			}
			fail_text = {
				text = "human_fallen_empires.400.desc.1"
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ship_old_jungle
	location = from

    is_triggered_only = yes

	trigger = {
		from = { has_planet_flag = human_fallen_empires_ahet_colony }
		from.owner = { is_country_type = primitive }
	}

	option = {
		name = human_fallen_empires.400.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	option = {
		name = human_fallen_empires.400.1
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_materialist = no
			}
		}
	}
	option = {
		name = human_fallen_empires.400.2
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_materialist = yes
			}
		}
	}
	after = {
		owner = { set_country_flag = human_fallen_empires_ahet_found }
	}
}

# colony 2
ship_event = {
	id = human_fallen_empires.401
	title = "human_fallen_empires.401.name"
	desc = {
		trigger = {
			success_text = {
				text = "human_fallen_empires.401.desc.0"
				has_country_flag = human_fallen_empires_ahet_found
			}
			fail_text = {
				text = "human_fallen_empires.401.desc.1"
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ship_old_jungle_2
	location = from

    is_triggered_only = yes

	trigger = {
		from = { has_planet_flag = human_fallen_empires_ahet_colony_2 }
		from.owner = { is_country_type = primitive }
	}

	option = {
		name = human_fallen_empires.401.0
		trigger = {
			owner = { has_country_flag = human_fallen_empires_ahet_found }
		}
	}
	option = {
		name = human_fallen_empires.401.1
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_xenophile = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.401.2
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_xenophobe = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.401.3
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_xenophile = no
				human_fallen_empires_trigger_is_xenophobe = no
			}
		}
	}
	after = {
		owner = { set_country_flag = human_fallen_empires_ahet_found }
	}
}

# Ra'ar story (then home of light captured) 500 - 501

# start event
planet_event = {
	id = human_fallen_empires.500
	title = "human_fallen_empires.500.name"
	desc = "human_fallen_empires.500.desc"
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = root

    is_triggered_only = yes

	trigger = {
		has_planet_flag = human_fallen_empires_home_of_light
		exists = owner
		owner = {
			is_ai = no
		}
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		owner = {
			country_event = { id = human_fallen_empires.501 }
		}
	}
}

# raar story
country_event = {
	id = human_fallen_empires.501
	title = human_fallen_empires.501.name
	desc = human_fallen_empires.501.desc
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	diplomatic = yes

    picture_event_data = {
		room = human_fallen_empires_raar_room
	}

	option = {
		name = human_fallen_empires.501.0
		response_text = human_fallen_empires.501.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.1
		response_text = human_fallen_empires.501.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.2
		response_text = human_fallen_empires.501.2.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.3
		response_text = human_fallen_empires.501.3.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.4
		response_text = human_fallen_empires.501.4.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.5
		response_text = human_fallen_empires.501.5.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.6
		response_text = human_fallen_empires.501.6.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.7
		response_text = human_fallen_empires.501.7.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.8
		response_text = human_fallen_empires.501.8.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.9
		response_text = human_fallen_empires.501.9.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.10
		response_text = human_fallen_empires.501.10.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.11
		response_text = human_fallen_empires.501.11.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.12
		response_text = human_fallen_empires.501.12.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.13
		custom_tooltip = human_fallen_empires.501.13.tooltip
	}
}


## drone country section 600
# cheat for survey
ship_event = {
	id = human_fallen_empires.600
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_drone
		}
		exists = from
	}

	immediate = {
		from = {
			every_neighbor_system = {
				every_system_planet = {
					surveyed = {
						set_surveyed = yes
						surveyor = fromfrom
					}
				}
			}
			every_system_planet = {
				surveyed = {
					set_surveyed = yes
					surveyor = fromfrom
				}
			}
		}
	}
}

# add bonus for outposts
ship_event = {
	id = human_fallen_empires.601
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_drone
		}
	}

	immediate = {
		log = "drone outpost builded"
		owner = {
			change_variable = {
				which = human_fallen_empires_drone_outpost
				value = 1
			}
			human_fallen_empires_effect_drone_calc_outpost = yes
		}
	}
}

# remove bonus
country_event = {
	id = human_fallen_empires.602
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_drone
		exists = fromfrom
		fromfrom = {
			is_ship_size = outpost_station
		}
	}

	immediate = {
		log = "drone outpost killed"
		change_variable = {
			which = human_fallen_empires_drone_outpost
			value = -1
		}
		human_fallen_empires_effect_drone_calc_outpost = yes
	}
}

# destroy drone planet
country_event = {
	id = human_fallen_empires.603
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_drone
		exists = fromfrom
		fromfrom = {
			is_ship_size = orbital_station
		}
	}

	immediate = {
		random_owned_planet = {
			limit = {
				solar_system = {
					is_same_value = fromfrom.solar_system
				}
			}
			destroy_colony = yes
			change_pc = pc_molten
			log = "drone base killed on [Root.GetStarName]"
		}
	}
}

# contact event
country_event = {
	id = human_fallen_empires.604
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_drone
		exists = from
	}

	immediate = {
		establish_communications = from
		from = {
			if = {
				limit = {
					is_ai = no
				}
				country_event = { id = human_fallen_empires.605 }
				set_country_flag = human_fallen_empires.605.step0
			}
		}
	}
}

# diplomatic contact event
country_event = {
	id = human_fallen_empires.605
	title = TRANSMISSION
	desc = {
		trigger = {
			# start
			fail_text = {
				text = human_fallen_empires.605.desc.0
				has_country_flag = human_fallen_empires.605.step3
			}
			success_text = {
				text = human_fallen_empires.605.desc.1
				has_country_flag = human_fallen_empires.605.step3
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	# step 0
	option = {
		name = human_fallen_empires.605.0.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step0
			set_country_flag = human_fallen_empires.605.step1
			country_event = { id = human_fallen_empires.605 }
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.605.1.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step1
			set_country_flag = human_fallen_empires.605.step2
			country_event = { id = human_fallen_empires.605 }
		}
	}
	# step 2
	option = {
		name = human_fallen_empires.605.2.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step2
			human_fallen_empires_trigger_has_clever_trait = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step2
			set_country_flag = human_fallen_empires.605.step3
			country_event = { id = human_fallen_empires.605 }
		}
	}
	# step 3
	option = {
		name = human_fallen_empires.605.3.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.0.response
	}
	option = {
		name = human_fallen_empires.605.3.1
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.1.response
	}
	option = {
		name = human_fallen_empires.605.3.2
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.2.response
	}
	option = {
		name = human_fallen_empires.605.3.3
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.3.response
	}
	option = {
		name = human_fallen_empires.605.3.4
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.4.response
	}
	option = {
		name = human_fallen_empires_end_transmission
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step0
			remove_country_flag = human_fallen_empires.605.step1
			remove_country_flag = human_fallen_empires.605.step2
			remove_country_flag = human_fallen_empires.605.step3
		}
	}
}



# functional and life simulation stuff 650 - 675

# spawn pirates
country_event = {
	id = human_fallen_empires.650
	title = pirate.1.name
	picture = GFX_evt_exploding_ship
	show_sound = event_space_battle

	desc = { # Spiritual
		text = pirate.1.desc_01
		trigger = {
			OR = {
				has_government = theocratic_republic
				has_government = transcendent_republic
				has_government = theocratic_oligarchy
				has_government = transcendent_oligarchy
				has_government = divine_mandate
				has_government = transcendent_empire
			}
		}
	}

	desc = { # Militarist
		text = pirate.1.desc_02
		trigger = {
			OR = {
				has_government = military_dictatorship
				has_government = martial_empire
				has_government = military_junta
				has_government = ordered_stratocracy
				has_government = military_republic
				has_government = martial_demarchy
			}
		}
	}

	desc = { # Materialist
		text = pirate.1.desc_03
		trigger = {
			OR = {
				has_government = despotic_hegemony
				has_government = ai_overlordship
				has_government = science_directorate
				has_government = illuminated_technocracy
				has_government = direct_democracy
				has_government = subconscious_consensus
			}
		}
	}

	desc = { # Pacifist
		text = pirate.1.desc_04
		trigger = {
			OR = {
				has_government = moral_democracy
				has_government = irenic_democracy
				has_government = peaceful_bureaucracy
				has_government = irenic_protectorate
				has_government = enlightened_monarchy
				has_government = irenic_monarchy
			}
		}
	}

	desc = { # Generic Autocracy
		text = pirate.1.desc_05
		trigger = {
			OR = {
				has_government = despotic_empire
				has_government = star_empire
			}
		}
	}

	desc = { # Generic Oligarchy
		text = pirate.1.desc_06
		trigger = {
			OR = {
				has_government = plutocratic_oligarchy
				has_government = mega_corporation
			}
		}
	}

	desc = { # Generic Democracy
		text = pirate.1.desc_07
		trigger = {
			OR = {
				has_government = indirect_democracy
				has_government = democratic_utopia
			}
		}
	}

	trigger = {
		is_country_type = default
		not = {
			has_country_flag = human_fallen_empires_birth_of_piracy
		}
	}

	is_triggered_only = yes

	immediate = {
		log = "pirates spawned"
		set_country_flag = human_fallen_empires_birth_of_piracy
		set_country_flag = pirate_encountered
		save_event_target_as = human_fallen_empires_pirate_target
		random_system = {
			limit = {
				or = {
					distance = {
						source = root.capital_scope
						min_distance = 5
						max_distance = 50
					}
					any_planet = {
						is_neighbor_of = root
					}
				}
				nor = {
					any_planet = {
						exists = owner
					}
					has_star_flag = hostile_system
				}
				any_planet = {
					is_asteroid = yes
					nor = {
						exists = controller
						exists = owner
					}
				}
			}
			random_system_planet = {
				limit = {
					is_asteroid = yes
					nor = {
						exists = controller
						exists = owner
					}
				}
				human_fallen_empires_effect_create_pirate = yes
				human_fallen_empires_effect_create_pirate_base = yes
			}
		}
		every_country = {
			limit = {
				is_country_type = default
				has_country_flag = pirate_encountered
			}
			every_country = {
				limit = {
					or = {
						is_country_type = pirate
						is_country_type = human_fallen_empires_pirate
					}
				}
				establish_communications_no_message = prev
			}
		}
	}

	option = {
		name = pirate.2.a
		trigger = {
			OR = {
				has_government = theocratic_republic
				has_government = transcendent_republic
				has_government = theocratic_oligarchy
				has_government = transcendent_oligarchy
				has_government = divine_mandate
				has_government = transcendent_empire
			}
		}
	}
	option = {
		name = pirate.2.b
		trigger = {
			OR = {
				has_government = military_dictatorship
				has_government = martial_empire
				has_government = military_junta
				has_government = ordered_stratocracy
				has_government = military_republic
				has_government = martial_demarchy
			}
		}
	}
	option = {
		name = pirate.2.c
		trigger = {
			OR = {
				has_government = despotic_hegemony
				has_government = ai_overlordship
				has_government = science_directorate
				has_government = illuminated_technocracy
				has_government = direct_democracy
				has_government = subconscious_consensus
			}
		}
	}
	option = {
		name = pirate.2.d
		trigger = {
			OR = {
				has_government = moral_democracy
				has_government = irenic_democracy
				has_government = peaceful_bureaucracy
				has_government = irenic_protectorate
				has_government = enlightened_monarchy
				has_government = irenic_monarchy
			}
		}
	}
	option = {
		name = pirate.2.e
		trigger = {
			OR = {
				has_government = despotic_empire
				has_government = star_empire
			}
		}
	}
	option = {
		name = pirate.2.f
		trigger = {
			OR = {
				has_government = plutocratic_oligarchy
				has_government = mega_corporation
			}
		}
	}
	option = {
		name = pirate.2.g
		trigger = {
			OR = {
				has_government = indirect_democracy
				has_government = democratic_utopia
			}
		}
	}
	option = {
		name = INTERESTING
	}
}

# pirate life simulation
country_event = {
	id = human_fallen_empires.651
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_pirate
	}

	immediate = {
		# build new bases
		country_event = { id = human_fallen_empires.652 }
		# send fleet logic for unstuck fleets
		every_owned_fleet = {
			fleet_event = { id = human_fallen_empires.675 }
		}
		# kick buildings
		every_owned_planet = {
			limit = {
				free_building_tiles > 0
			}
			every_tile = {
				limit = {
					exists = pop
					not = {
						has_building = human_fallen_empires_pirate_slave_pit
					}
				}
				add_building_construction = human_fallen_empires_pirate_slave_pit
			}
			every_owned_pop = {
				enslave_pop = yes
			}
		}
		# also cheat for better drives
		if = {
			limit = {
				years_passed > 20
			}
			if = {
				limit = {
					has_technology = tech_warp_drive_1
					not = {
						has_technology = tech_warp_drive_2
					}
				}
				give_technology = tech_warp_drive_2
			}
			if = {
				limit = {
					has_technology = tech_wormhole_generation_1
					not = {
						has_technology = tech_wormhole_generation_2
					}
				}
				give_technology = tech_wormhole_generation_2
			}
			if = {
				limit = {
					has_technology = tech_hyper_drive_1
					not = {
						has_technology = tech_wormhole_generation_3
					}
				}
				give_technology = tech_hyper_drive_2
			}
		}
		if = {
			limit = {
				years_passed > 40
			}
			if = {
				limit = {
					has_technology = tech_warp_drive_2
					not = {
						has_technology = tech_warp_drive_3
					}
				}
				give_technology = tech_warp_drive_3
			}
			if = {
				limit = {
					has_technology = tech_wormhole_generation_2
					not = {
						has_technology = tech_wormhole_generation_3
					}
				}
				give_technology = tech_wormhole_generation_3
			}
			if = {
				limit = {
					has_technology = tech_hyper_drive_2
					not = {
						has_technology = tech_hyper_drive_3
					}
				}
				give_technology = tech_hyper_drive_3
			}
		}
	}
}

# pirate build base
country_event = {
	id = human_fallen_empires.652
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		energy > @human_fallen_empires_pirate_base_cost
	}

	immediate = {
		save_event_target_as = pirate_band
		every_owned_planet = {
			random_system = {
				limit = {
					distance = {
						source = prev
						min_distance = 5
						max_distance = 50
					}
					nor = {
						any_planet = {
							exists = owner
						}
						has_star_flag = hostile_system
					}
					any_planet = {
						is_asteroid = yes
						nor = {
							exists = controller
							exists = owner
						}
					}
					root = {
						energy > @human_fallen_empires_pirate_base_cost
					}
				}
				random_system_planet = {
					limit = {
						is_asteroid = yes
						nor = {
							exists = controller
							exists = owner
						}
					}
					human_fallen_empires_effect_create_pirate_base = yes
					root = {
						add_energy = @human_fallen_empires_pirate_base_cost_minus
					}
				}
			}
		}
	}
}

# pirates fleet logic set by ship build on action
ship_event = {
	id = human_fallen_empires.653
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_pirate
		}
		is_ship_class = shipclass_military
	}

	immediate = {
		fleet = {
			fleet_event = { id = human_fallen_empires.675 }
		}
	}
}

# kill pirate base
country_event = {
	id = human_fallen_empires.654
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			is_country_type = human_fallen_empires_pirate
		}
		exists = fromfromfrom
		fromfromfrom = {
			is_ship_size = orbital_station
		}
	}

	immediate = {
		from = {
			if = {
				limit = {
					num_owned_planets = 1
				}
				if = {
					limit = {
						any_country = {
							is_country_type = human_fallen_empires_pirate
							not = {
								is_country = root
							}
						}
					}
					random_country = {
						limit = {
							is_country_type = human_fallen_empires_pirate
							not = {
								is_country = root
							}
						}
						save_event_target_as = human_fallen_empires_pirate_new_owner
					}
					every_owned_fleet = {
						set_owner = event_target:human_fallen_empires_pirate_new_owner
					}
				}
				random_owned_planet = {
					change_pc = pc_asteroid
				}
				# destroy contry later for fix errors in log
				country_event = { id = human_fallen_empires.9 days = 2 }
				#	destroy_country = yes
				remove_modifier = human_fallen_empires_pirate_base
				break = yes
			}
			random_owned_planet = {
				limit = {
					solar_system = {
						is_same_value = fromfromfrom.solar_system
					}
				}
				destroy_colony = yes
				change_pc = pc_asteroid
				remove_modifier = human_fallen_empires_pirate_base
			}
		}
	}
}

# functional fleet stuff 675 - 700

# pirates fleet logic
fleet_event = {
	id = human_fallen_empires.675
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_pirate
		}
		num_ships > 4
		has_hp_percentage > 0.99
		nor = {
			has_fleet_order = upgrade_design_fleet_order
			has_fleet_order = merge_fleet_order
			has_fleet_order = move_to_system_point_order
			has_fleet_order = orbit_planet_order
			has_fleet_order = repair_ship_fleet_order
			has_fleet_order = return_fleet_order
			has_fleet_order = upgrade_design_fleet_order
		}
		any_system = {
			any_planet = {
				or = {
					and = {
						has_orbital_station = yes
						exists = controller
						controller = {
							is_country_type = default
							is_hostile = root.owner
						}
					}
					and = {
						exists = owner
						owner = {
							or = {
								is_country_type = default
								is_country_type = primitive
							}
							is_hostile = root.owner
						}
					}
				}
			}
			not = {
				any_ship_in_system = {
					or = {
						is_ship_size = orbital_station
						is_ship_class = shipclass_military
						is_ship_class = shipclass_military_station
					}
					exists = owner
					owner = {
						is_hostile = root.owner
					}
					root = {
						num_ships > 40
					}
				}
			}
		}
	}

	immediate = {
		#log = "pirate fleet logic"
		clear_fleet_actions = this
		queue_actions = {
			repeat = {
				find_closest_system = {
					trigger = {
						id = human_fallen_empires.675.trigger.0
						root = {
							has_hp_percentage > 0.99
						}
						any_country = {
							has_opinion_modifier = {
								who = root.owner
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
						any_planet = {
							or = {
								and = {
									has_orbital_station = yes
									exists = controller
									controller = {
										is_country_type = default
										is_hostile = root.owner
										has_opinion_modifier = {
											who = root.owner
											modifier = human_fallen_empires_opinion_pirate_prior_target
										}
									}
								}
								and = {
									human_fallen_empires_primitive_planet = no
									exists = owner
									owner = {
										or = {
											is_country_type = default
											is_country_type = primitive
										}
										is_hostile = root.owner
										has_opinion_modifier = {
											who = root.owner
											modifier = human_fallen_empires_opinion_pirate_prior_target
										}
									}
								}
							}
						}
						not = {
							any_ship_in_system = {
								or = {
									is_ship_size = orbital_station
									is_ship_class = shipclass_military
									is_ship_class = shipclass_military_station
								}
								exists = owner
								owner = {
									is_hostile = root.owner
								}
								root = {
									num_ships < 40
								}
							}
						}
					}
					found_system = {
						effect = {
							id = human_fallen_empires.675.effect.0
							root = {
								if = {
									limit = {
										or = {
											num_ships < 5
											has_hp_percentage < 0.99
										}
									}
									clear_fleet_actions = this
									log = "pirate fleet stop operation due low hp"
								}
							}
						}
						move_to = this
					}
					failed = {
						find_closest_system = {
							trigger = {
								id = human_fallen_empires.675.trigger.1
								root = {
									has_hp_percentage > 0.99
								}
								any_planet = {
									or = {
										and = {
											has_orbital_station = yes
											exists = controller
											controller = {
												is_country_type = default
												is_hostile = root.owner
												not = {
													has_opinion_modifier = {
														who = root.owner
														modifier = human_fallen_empires_opinion_pirate_pay_for_protect
													}
												}
											}
										}
										and = {
											exists = owner
											human_fallen_empires_primitive_planet = no
											owner = {
												or = {
													is_country_type = default
													is_country_type = primitive
												}
												is_hostile = root.owner
												not = {
													has_opinion_modifier = {
														who = root.owner
														modifier = human_fallen_empires_opinion_pirate_pay_for_protect
													}
												}
											}
										}
									}
								}
								not = {
									any_ship_in_system = {
										or = {
											is_ship_size = orbital_station
											is_ship_class = shipclass_military
											is_ship_class = shipclass_military_station
										}
										exists = owner
										owner = {
											is_hostile = root.owner
										}
										root = {
											num_ships < 40
										}
									}
								}
							}
							found_system = {
								move_to = this
							}
							failed = {
								wait = 200
								effect = {
									id = human_fallen_empires.675.effect.1
									root = {
										clear_fleet_actions = this
										fleet_event = { id = human_fallen_empires.675 } # days = 200 }
										log = "pirate fleet stop operation due no targets"
									}
								}
							}
						}
					}
				}
				repeat = {
					max_iterations = 5
					find_closest_planet = {
						trigger = {
							id = human_fallen_empires.675.trigger.2
							human_fallen_empires_primitive_planet = no
							root = {
								has_hp_percentage > 0.99
							}
							or = {
								has_orbital_station = yes
								exists = owner
							}
						}
						found_planet = {
							orbit_planet = this
							wait = 31
						}
					}
				}
				find_random_system = {
					trigger = {
						id = human_fallen_empires.675.trigger.3
						any_planet = {
							exists = owner
							owner = {
								is_country = root.owner
							}
						}
					}
					found_system = {
						move_to = this
					}
				}
				find_closest_planet = {
					trigger = {
						id = human_fallen_empires.675.trigger.4
						exists = owner
						owner = {
							is_country = root.owner
						}
					}
					found_planet = {
						orbit_planet = this
						wait = {
							duration = 200
							random = 150
						}
					}
				}
			}
		}
	}
}

# cleet fleet actions after emercy ftl
fleet_event = {
	id = human_fallen_empires.676
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_pirate
		}
	}

	immediate = {
		#	log = "pirate fleet emercy ftl"
		clear_fleet_actions = this
	}
}

# pirates gain resurces after kill station
country_event = {
	id = human_fallen_empires.677
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_pirate
		exists = fromfromfrom
		fromfromfrom = {
			or = {
				is_ship_size = wormhole_station
				is_ship_size = research_station
				is_ship_size = mining_station
				is_ship_size = observation_station
				is_ship_size = outpost_station
			}
		}
	}

	immediate = {
		from = {
			set_timed_country_flag = {
				flag = human_fallen_empires_attacked_by_pirate
				days = 200
			}
		}
		add_minerals = 90
		add_energy = 10
		add_physics_research = 5
		add_society_research = 5
		add_engineering_research = 5
		log = "pirates kill station"
	}
}

# pirate bombard colony
planet_event = {
	id = human_fallen_empires.678
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		num_pops > 0
		exists = owner
		exists = from
		from = {
			is_country_type = human_fallen_empires_pirate
		}
	}

	immediate = {
		log = "pirate bombarding on [Root.GetStarName]"
		owner = {
			set_timed_country_flag = {
				flag = human_fallen_empires_pirates_attacked
				days = 200
			}
		}
		from = {
			add_minerals = 90
			add_energy = 10
			add_physics_research = 5
			add_society_research = 5
			add_engineering_research = 5
		}
		random_tile = {
			limit = {
				has_building = yes
			}
			set_ruined = yes
		}
		random_owned_pop = {
			limit = {
				is_sentient = yes
			}
			save_event_target_as = human_fallen_empires_pirates_pop
			from = {
				if = {
					limit = {
						any_owned_planet = {
							free_pop_tiles > 0
						}
					}
					random_owned_planet = {
						limit = {
							free_pop_tiles > 0
						}
						create_pop = {
							species = human_fallen_empires_pirates_pop.species
						}
					}
				}
			}
			kill_pop = yes
		}
	}
}

# clear action on comand for ai for on_ship_ordered
ship_event = {
	id = human_fallen_empires.679
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_pirate
		}
		fleet = {
			not = {
				has_fleet_flag = human_fallen_empires_clear_action_on_order
			}
		}
	}

	immediate = {
		log = "clear ship order by ai comand"
		fleet = {
			set_timed_fleet_flag = { flag = human_fallen_empires_clear_action_on_order days = 365 }
			clear_fleet_actions = this
		}
	}
}

# pirate diplomacy 700-750

# start event diplomacy
country_event = {
	id = human_fallen_empires.700
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			is_country_type = human_fallen_empires_pirate
		}
	}

	immediate = {
		from = {
			save_event_target_as = human_fallen_empires_pirate_country
		}
		country_event = { id = human_fallen_empires.701 }
	}
}

# pirate diplomacy main menu
country_event = {
	id = human_fallen_empires.701
	title = TRANSMISSION
	desc = {
		trigger = {
			# start
			success_text = {
				text = human_fallen_empires.701.desc.0
				human_fallen_empires_trigger_pirate_diplomacy_any_menu = no
			}
			# raid
			success_text = {
				text = human_fallen_empires.701.raid_menu.desc.0
				has_country_flag = human_fallen_empires.701.raid_menu
				human_fallen_empires_trigger_exists_any_event_target = yes
			}
			success_text = {
				text = human_fallen_empires.701.raid_menu.desc.1
				has_country_flag = human_fallen_empires.701.raid_menu
				human_fallen_empires_trigger_exists_any_event_target = no
			}
			# traid
			success_text = {
				text = human_fallen_empires.701.traid_menu.desc.0
				has_country_flag = human_fallen_empires.701.traid_menu
			}
			# slave
			success_text = {
				text = human_fallen_empires.701.slave_menu.desc.0
				has_country_flag = human_fallen_empires.701.slave_menu
				human_fallen_empires_trigger_exists_any_slave_target = no
			}
			success_text = {
				text = human_fallen_empires.701.slave_menu.desc.1
				has_country_flag = human_fallen_empires.701.slave_menu
				human_fallen_empires_trigger_exists_any_slave_target = yes
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_pirate_country
		room = event_target:human_fallen_empires_pirate_country
	}

	# pay for protect
	option = {
		name = human_fallen_empires.701.0
		trigger = {
			human_fallen_empires_trigger_pirate_diplomacy_any_menu = no
		}
		allow = {
			custom_tooltip_fail = {
				text = human_fallen_empires.701.0.tooltip_fail
				not = {
					has_opinion_modifier = {
						who = event_target:human_fallen_empires_pirate_country
						modifier = human_fallen_empires_opinion_pirate_pay_for_protect
					}
				}
			}
			energy > 500
			minerals > 500
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.0.response

		add_energy = -500
		add_minerals = -500
		event_target:human_fallen_empires_pirate_country = {
			add_energy = 500
			add_minerals = 500
		}
		hidden_effect = {
			add_opinion_modifier = {
				who = event_target:human_fallen_empires_pirate_country
				modifier = human_fallen_empires_opinion_pirate_pay_for_protect
			}
			event_target:human_fallen_empires_pirate_country = {
				add_opinion_modifier = {
					who = root
					modifier = human_fallen_empires_opinion_pirate_pay_for_protect
				}
				every_owned_fleet = {
					clear_fleet_actions = this
					fleet_event = { id = human_fallen_empires.675 }
				}
			}
		}
	}
	# pay for prior target
	option = {
		name = human_fallen_empires.701.1
		trigger = {
			human_fallen_empires_trigger_pirate_diplomacy_any_menu = no
		}
		hidden_effect = {
			#	human_fallen_empires_effect_clear_event_target = yes
			every_country = {
				limit = {
					is_country_type = default
					has_communications = root
					is_at_war_with = root
					nor = {
						is_country = root
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_prior_target
						}
					}
				}
				human_fallen_empires_effect_save_event_target = yes
			}
			if = {
				limit = {
					human_fallen_empires_trigger_exists_all_event_targets = no
				}
				every_country = {
					limit = {
						is_country_type = default
						has_communications = root
						is_rival = root
						nor = {
							is_country = root
							has_opinion_modifier = {
								who = event_target:human_fallen_empires_pirate_country
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
					}
					human_fallen_empires_effect_save_event_target = yes
				}
			}
			if = {
				limit = {
					human_fallen_empires_trigger_exists_all_event_targets = no
				}
				every_country = {
					limit = {
						is_country_type = default
						has_communications = root
						is_domineering_to = root
						nor = {
							is_country = root
							has_opinion_modifier = {
								who = event_target:human_fallen_empires_pirate_country
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
					}
					human_fallen_empires_effect_save_event_target = yes
				}
			}
			if = {
				limit = {
					human_fallen_empires_trigger_exists_all_event_targets = no
				}
				every_country = {
					limit = {
						is_country_type = default
						has_communications = root
						is_hostile_to = root
						nor = {
							is_country = root
							has_opinion_modifier = {
								who = event_target:human_fallen_empires_pirate_country
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
					}
					human_fallen_empires_effect_save_event_target = yes
				}
			}
			if = {
				limit = {
					human_fallen_empires_trigger_exists_all_event_targets = no
				}
				every_country = {
					limit = {
						is_country_type = default
						has_communications = root
						is_dismissive_to = root
						nor = {
							is_country = root
							has_opinion_modifier = {
								who = event_target:human_fallen_empires_pirate_country
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
					}
					human_fallen_empires_effect_save_event_target = yes
				}
			}
			if = {
				limit = {
					human_fallen_empires_trigger_exists_all_event_targets = no
				}
				every_country = {
					limit = {
						is_country_type = default
						has_communications = root
						is_unfriendly_to = root
						nor = {
							is_country = root
							has_opinion_modifier = {
								who = event_target:human_fallen_empires_pirate_country
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
					}
					human_fallen_empires_effect_save_event_target = yes
				}
			}
			if = {
				limit = {
					human_fallen_empires_trigger_exists_all_event_targets = no
				}
				every_country = {
					limit = {
						is_country_type = default
						has_communications = root
						is_threatened_to = root
						nor = {
							is_country = root
							has_opinion_modifier = {
								who = event_target:human_fallen_empires_pirate_country
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
					}
					human_fallen_empires_effect_save_event_target = yes
				}
			}
			if = {
				limit = {
					human_fallen_empires_trigger_exists_all_event_targets = no
				}
				every_country = {
					limit = {
						is_country_type = default
						has_communications = root
						nor = {
							is_country = root
							has_opinion_modifier = {
								who = event_target:human_fallen_empires_pirate_country
								modifier = human_fallen_empires_opinion_pirate_prior_target
							}
						}
					}
					human_fallen_empires_effect_save_event_target = yes
				}
			}
			human_fallen_empires_effect_pirates_diplomacy_remove_flags = yes
			set_country_flag = human_fallen_empires.701.raid_menu
			country_event = { id = human_fallen_empires.701 }
		}
	}
	# select target menu
	option = {
		name = human_fallen_empires.701.raid_menu.0
		trigger = {
			has_country_flag = human_fallen_empires.701.raid_menu
			exists = event_target:human_fallen_empires_event_target_0
		}
		allow = {
			energy > 500
			minerals > 500
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_pay_for_protect
				not = {
					event_target:human_fallen_empires_event_target_0 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_pay_for_protect
						}
					}
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_prior_target
				not = {
					event_target:human_fallen_empires_event_target_0 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_prior_target
						}
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.raid_menu.0.response

		add_energy = -500
		add_minerals = -500
		event_target:human_fallen_empires_pirate_country = {
			add_energy = 500
			add_minerals = 500
		}
		hidden_effect = {
			event_target:human_fallen_empires_event_target_0 = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_pirate_country
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
			}
			event_target:human_fallen_empires_pirate_country = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_event_target_0
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
				every_owned_fleet = {
					clear_fleet_actions = this
					fleet_event = { id = human_fallen_empires.675 }
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.raid_menu.1
		trigger = {
			has_country_flag = human_fallen_empires.701.raid_menu
			exists = event_target:human_fallen_empires_event_target_1
		}
		allow = {
			energy > 500
			minerals > 500
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_pay_for_protect
				not = {
					event_target:human_fallen_empires_event_target_1 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_pay_for_protect
						}
					}
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_prior_target
				not = {
					event_target:human_fallen_empires_event_target_1 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_prior_target
						}
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.raid_menu.1.response

		add_energy = -500
		add_minerals = -500
		event_target:human_fallen_empires_pirate_country = {
			add_energy = 500
			add_minerals = 500
		}
		hidden_effect = {
			event_target:human_fallen_empires_event_target_1 = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_pirate_country
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
			}
			event_target:human_fallen_empires_pirate_country = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_event_target_1
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
				every_owned_fleet = {
					clear_fleet_actions = this
					fleet_event = { id = human_fallen_empires.675 }
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.raid_menu.2
		trigger = {
			has_country_flag = human_fallen_empires.701.raid_menu
			exists = event_target:human_fallen_empires_event_target_2
		}
		allow = {
			energy > 500
			minerals > 500
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_pay_for_protect
				not = {
					event_target:human_fallen_empires_event_target_2 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_pay_for_protect
						}
					}
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_prior_target
				not = {
					event_target:human_fallen_empires_event_target_2 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_prior_target
						}
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.raid_menu.2.response

		add_energy = -500
		add_minerals = -500
		event_target:human_fallen_empires_pirate_country = {
			add_energy = 500
			add_minerals = 500
		}
		hidden_effect = {
			event_target:human_fallen_empires_event_target_2 = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_pirate_country
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
			}
			event_target:human_fallen_empires_pirate_country = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_event_target_2
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
				every_owned_fleet = {
					clear_fleet_actions = this
					fleet_event = { id = human_fallen_empires.675 }
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.raid_menu.3
		trigger = {
			has_country_flag = human_fallen_empires.701.raid_menu
			exists = event_target:human_fallen_empires_event_target_3
		}
		allow = {
			energy > 500
			minerals > 500
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_pay_for_protect
				not = {
					event_target:human_fallen_empires_event_target_3 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_pay_for_protect
						}
					}
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_prior_target
				not = {
					event_target:human_fallen_empires_event_target_3 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_prior_target
						}
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.raid_menu.3.response

		add_energy = -500
		add_minerals = -500
		event_target:human_fallen_empires_pirate_country = {
			add_energy = 500
			add_minerals = 500
		}
		hidden_effect = {
			event_target:human_fallen_empires_event_target_3 = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_pirate_country
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
			}
			event_target:human_fallen_empires_pirate_country = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_event_target_3
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
				every_owned_fleet = {
					clear_fleet_actions = this
					fleet_event = { id = human_fallen_empires.675 }
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.raid_menu.4
		trigger = {
			has_country_flag = human_fallen_empires.701.raid_menu
			exists = event_target:human_fallen_empires_event_target_4
		}
		allow = {
			energy > 500
			minerals > 500
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_pay_for_protect
				not = {
					event_target:human_fallen_empires_event_target_4 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_pay_for_protect
						}
					}
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_prior_target
				not = {
					event_target:human_fallen_empires_event_target_4 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_prior_target
						}
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.raid_menu.4.response

		add_energy = -500
		add_minerals = -500
		event_target:human_fallen_empires_pirate_country = {
			add_energy = 500
			add_minerals = 500
		}
		hidden_effect = {
			event_target:human_fallen_empires_event_target_4 = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_pirate_country
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
			}
			event_target:human_fallen_empires_pirate_country = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_event_target_4
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
				every_owned_fleet = {
					clear_fleet_actions = this
					fleet_event = { id = human_fallen_empires.675 }
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.raid_menu.5
		trigger = {
			has_country_flag = human_fallen_empires.701.raid_menu
			exists = event_target:human_fallen_empires_event_target_5
		}
		allow = {
			energy > 500
			minerals > 500
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_pay_for_protect
				not = {
					event_target:human_fallen_empires_event_target_5 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_pay_for_protect
						}
					}
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.raid_menu.fail_prior_target
				not = {
					event_target:human_fallen_empires_event_target_5 = {
						has_opinion_modifier = {
							who = event_target:human_fallen_empires_pirate_country
							modifier = human_fallen_empires_opinion_pirate_prior_target
						}
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.raid_menu.5.response

		add_energy = -500
		add_minerals = -500
		event_target:human_fallen_empires_pirate_country = {
			add_energy = 500
			add_minerals = 500
		}
		hidden_effect = {
			event_target:human_fallen_empires_event_target_5 = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_pirate_country
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
			}
			event_target:human_fallen_empires_pirate_country = {
				add_opinion_modifier = {
					who = event_target:human_fallen_empires_event_target_5
					modifier = human_fallen_empires_opinion_pirate_prior_target
				}
				every_owned_fleet = {
					clear_fleet_actions = this
					fleet_event = { id = human_fallen_empires.675 }
				}
			}
		}
	}
	# traid menu
	option = {
		name = human_fallen_empires.701.2
		trigger = {
			human_fallen_empires_trigger_pirate_diplomacy_any_menu = no
		}
		hidden_effect = {
			human_fallen_empires_effect_pirates_diplomacy_remove_flags = yes
			set_country_flag = human_fallen_empires.701.traid_menu
			country_event = { id = human_fallen_empires.701 }
		}
	}
	# energy for minerals
	option = {
		name = human_fallen_empires.701.traid_menu.0
		trigger = {
			has_country_flag = human_fallen_empires.701.traid_menu
		}
		allow = {
			minerals > 150
			custom_tooltip_fail = {
				text = human_fallen_empires.701.traid_menu.fail
				event_target:human_fallen_empires_pirate_country = {
					energy > 100
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.traid_menu.0.response

		add_energy = 100
		add_minerals = -150
		event_target:human_fallen_empires_pirate_country = {
			add_energy = -100
			add_minerals = 150
		}
	}
	# buy slave
	option = {
		name = human_fallen_empires.701.traid_menu.1
		trigger = {
			has_country_flag = human_fallen_empires.701.traid_menu
		}
		hidden_effect = {
			human_fallen_empires_effect_pirates_diplomacy_remove_flags = yes
			set_country_flag = human_fallen_empires.701.slave_menu
			event_target:human_fallen_empires_pirate_country = {
				human_fallen_empires_effect_save_slave_target = yes
			}
			country_event = { id = human_fallen_empires.701 }
		}
	}
	option = {
		name = human_fallen_empires.701.slave_menu.0
		trigger = {
			has_country_flag = human_fallen_empires.701.slave_menu
			event_target:human_fallen_empires_pirate_country = {
				human_fallen_empires_trigger_is_individualist = yes
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.slave_menu.0.response
	}
	# select slave menu
	option = {
		name = human_fallen_empires.701.slave_menu.1
		trigger = {
			has_country_flag = human_fallen_empires.701.slave_menu
			exists = event_target:human_fallen_empires_slave_target_0
		}
		allow = {
			energy > @human_fallen_empires_pirate_slave_cost
			minerals > @human_fallen_empires_pirate_slave_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_space
				any_owned_planet = {
					free_pop_tiles > 0
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_slave
				event_target:human_fallen_empires_pirate_country = {
					any_owned_pop = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_0
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.slave_menu.1.response

		add_energy = @human_fallen_empires_pirate_slave_cost_minus
		add_minerals = @human_fallen_empires_pirate_slave_cost_minus
		event_target:human_fallen_empires_pirate_country = {
			add_energy = @human_fallen_empires_pirate_slave_cost
			add_minerals = @human_fallen_empires_pirate_slave_cost
		}
		hidden_effect = {
			random_owned_planet = {
				limit = {
					free_pop_tiles > 0
				}
				create_pop = {
					species = event_target:human_fallen_empires_slave_target_0
				}
			}
			event_target:human_fallen_empires_pirate_country = {
				random_owned_pop = {
					limit = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_0
					}
					kill_pop = yes
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.slave_menu.2
		trigger = {
			has_country_flag = human_fallen_empires.701.slave_menu
			exists = event_target:human_fallen_empires_slave_target_1
		}
		allow = {
			energy > @human_fallen_empires_pirate_slave_cost
			minerals > @human_fallen_empires_pirate_slave_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_space
				any_owned_planet = {
					free_pop_tiles > 0
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_slave
				event_target:human_fallen_empires_pirate_country = {
					any_owned_pop = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.slave_menu.2.response

		add_energy = @human_fallen_empires_pirate_slave_cost_minus
		add_minerals = @human_fallen_empires_pirate_slave_cost_minus
		event_target:human_fallen_empires_pirate_country = {
			add_energy = @human_fallen_empires_pirate_slave_cost
			add_minerals = @human_fallen_empires_pirate_slave_cost
		}
		hidden_effect = {
			event_target:human_fallen_empires_pirate_country = {
				random_owned_pop = {
					limit = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_1
					}
					save_event_target_as = human_fallen_empires_pirates_pop
					root = {
						random_owned_planet = {
							limit = {
								free_pop_tiles > 0
							}
							create_pop = {
								species = human_fallen_empires_pirates_pop.species
							}
						}
					}
					kill_pop = yes
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.slave_menu.3
		trigger = {
			has_country_flag = human_fallen_empires.701.slave_menu
			exists = event_target:human_fallen_empires_slave_target_2
		}
		allow = {
			energy > @human_fallen_empires_pirate_slave_cost
			minerals > @human_fallen_empires_pirate_slave_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_space
				any_owned_planet = {
					free_pop_tiles > 0
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_slave
				event_target:human_fallen_empires_pirate_country = {
					any_owned_pop = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_2
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.slave_menu.3.response

		add_energy = @human_fallen_empires_pirate_slave_cost_minus
		add_minerals = @human_fallen_empires_pirate_slave_cost_minus
		event_target:human_fallen_empires_pirate_country = {
			add_energy = @human_fallen_empires_pirate_slave_cost
			add_minerals = @human_fallen_empires_pirate_slave_cost
		}
		hidden_effect = {
			event_target:human_fallen_empires_pirate_country = {
				random_owned_pop = {
					limit = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_2
					}
					save_event_target_as = human_fallen_empires_pirates_pop
					root = {
						random_owned_planet = {
							limit = {
								free_pop_tiles > 0
							}
							create_pop = {
								species = human_fallen_empires_pirates_pop.species
							}
						}
					}
					kill_pop = yes
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.slave_menu.4
		trigger = {
			has_country_flag = human_fallen_empires.701.slave_menu
			exists = event_target:human_fallen_empires_slave_target_3
		}
		allow = {
			energy > @human_fallen_empires_pirate_slave_cost
			minerals > @human_fallen_empires_pirate_slave_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_space
				any_owned_planet = {
					free_pop_tiles > 0
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_slave
				event_target:human_fallen_empires_pirate_country = {
					any_owned_pop = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_3
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.slave_menu.4.response

		add_energy = @human_fallen_empires_pirate_slave_cost_minus
		add_minerals = @human_fallen_empires_pirate_slave_cost_minus
		event_target:human_fallen_empires_pirate_country = {
			add_energy = @human_fallen_empires_pirate_slave_cost
			add_minerals = @human_fallen_empires_pirate_slave_cost
		}
		hidden_effect = {
			event_target:human_fallen_empires_pirate_country = {
				random_owned_pop = {
					limit = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_3
					}
					save_event_target_as = human_fallen_empires_pirates_pop
					root = {
						random_owned_planet = {
							limit = {
								free_pop_tiles > 0
							}
							create_pop = {
								species = human_fallen_empires_pirates_pop.species
							}
						}
					}
					kill_pop = yes
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.slave_menu.5
		trigger = {
			has_country_flag = human_fallen_empires.701.slave_menu
			exists = event_target:human_fallen_empires_slave_target_4
		}
		allow = {
			energy > @human_fallen_empires_pirate_slave_cost
			minerals > @human_fallen_empires_pirate_slave_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_space
				any_owned_planet = {
					free_pop_tiles > 0
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_slave
				event_target:human_fallen_empires_pirate_country = {
					any_owned_pop = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_4
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.slave_menu.5.response

		add_energy = @human_fallen_empires_pirate_slave_cost_minus
		add_minerals = @human_fallen_empires_pirate_slave_cost_minus
		event_target:human_fallen_empires_pirate_country = {
			add_energy = @human_fallen_empires_pirate_slave_cost
			add_minerals = @human_fallen_empires_pirate_slave_cost
		}
		hidden_effect = {
			event_target:human_fallen_empires_pirate_country = {
				random_owned_pop = {
					limit = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_4
					}
					save_event_target_as = human_fallen_empires_pirates_pop
					root = {
						random_owned_planet = {
							limit = {
								free_pop_tiles > 0
							}
							create_pop = {
								species = human_fallen_empires_pirates_pop.species
							}
						}
					}
					kill_pop = yes
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.701.slave_menu.6
		trigger = {
			has_country_flag = human_fallen_empires.701.slave_menu
			exists = event_target:human_fallen_empires_slave_target_5
		}
		allow = {
			energy > @human_fallen_empires_pirate_slave_cost
			minerals > @human_fallen_empires_pirate_slave_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_space
				any_owned_planet = {
					free_pop_tiles > 0
				}
			}
			custom_tooltip_fail = {
				text = human_fallen_empires.701.slave_menu.fail_havent_slave
				event_target:human_fallen_empires_pirate_country = {
					any_owned_pop = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_5
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.701.slave_menu.6.response

		add_energy = @human_fallen_empires_pirate_slave_cost_minus
		add_minerals = @human_fallen_empires_pirate_slave_cost_minus
		event_target:human_fallen_empires_pirate_country = {
			add_energy = @human_fallen_empires_pirate_slave_cost
			add_minerals = @human_fallen_empires_pirate_slave_cost
		}
		hidden_effect = {
			event_target:human_fallen_empires_pirate_country = {
				random_owned_pop = {
					limit = {
						is_exact_same_species = event_target:human_fallen_empires_slave_target_5
					}
					save_event_target_as = human_fallen_empires_pirates_pop
					root = {
						random_owned_planet = {
							limit = {
								free_pop_tiles > 0
							}
							create_pop = {
								species = human_fallen_empires_pirates_pop.species
							}
						}
					}
					kill_pop = yes
				}
			}
		}
	}
	# return
	option = {
		name = modmenu_return
		trigger = {
			human_fallen_empires_trigger_pirate_diplomacy_any_menu = yes
		}
		hidden_effect = {
			human_fallen_empires_effect_pirates_diplomacy_remove_flags = yes
			country_event = { id = human_fallen_empires.701 }
		}
	}
	# exit
	option = {
		name = human_fallen_empires_end_transmission
		hidden_effect = {
			human_fallen_empires_effect_pirates_diplomacy_remove_flags = yes
		}
	}
}

### Kad Republic section

# 5000-10000

# functional on actions events 5000 - 5050

# contact dialoge with future 5000 - 5002
country_event  = {
	id = human_fallen_empires.5000
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		exists = from
		from = {
			is_country_type = human_fallen_empire
			has_country_flag = human_fallen_empires_future
		}
	}

	immediate = {
		from = {
			establish_communications = root
			random_owned_leader = {
				limit = {
					gender = female
				}
				save_event_target_as = human_fallen_empires_female_leader
			}
			random_owned_leader = {
				limit = {
					not = { gender = female }
					leader_class = admiral
				}
				save_event_target_as = human_fallen_empires_male_leader
			}
		}
		if = {
			limit = {
				is_ai = no
			}
			set_country_flag = human_fallen_empires.5001.step0
			country_event = { id = human_fallen_empires.5001 }
			else = {
				from = {
					set_closed_borders = {
						who = root
						status = yes
					}
				}
			}
		}
		set_country_flag = human_fallen_empires_future_contacted
	}
}

# main dialoge
country_event = {
	id = human_fallen_empires.5001
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = "human_fallen_empires.5001.desc.0"
				has_country_flag = human_fallen_empires.5001.step0
			}
			success_text = {
				text = "human_fallen_empires.5001.desc.1"
				has_country_flag = human_fallen_empires.5001.step1
			}
			success_text = {
				text = "human_fallen_empires.5001.desc.2"
				has_country_flag = human_fallen_empires.5001.step2
			}
			success_text = {
				text = "human_fallen_empires.5001.desc.3"
				has_country_flag = human_fallen_empires.5001.step3
			}
			success_text = {
				text = "human_fallen_empires.5001.desc.4"
				has_country_flag = human_fallen_empires.5001.step4
			}
			success_text = {
				text = "human_fallen_empires.5001.desc.5"
				has_country_flag = human_fallen_empires.5001.step5
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_female_leader
		room = human_fallen_empires_future_room
	}

	# step 0
	option = {
		name = human_fallen_empires.5001.0.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			any_country = {
				has_communications = root
				not = {
					is_country = root
				}
				has_country_flag = human_fallen_empires_marked_as_human
			}
			human_fallen_empires_trigger_is_xenophobe = yes
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.0.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			any_country = {
				has_communications = root
				not = { is_country = root}
				has_country_flag = human_fallen_empires_egypt
			}
			has_country_flag = human_fallen_empires_marked_as_human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.0.2
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				any_country = {
					has_communications = root
					not = { is_country = root}
					has_country_flag = human_fallen_empires_egypt
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.0.3
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				any_country = {
					has_communications = root
					not = { is_country = root}
					has_country_flag = human_fallen_empires_egypt
				}
			}
			human_fallen_empires_trigger_is_materialist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.0.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.0.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.0.6
		trigger = {
			human_fallen_empires_trigger_is_xenophobe = no
			human_fallen_empires_trigger_is_xenophile = no
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.0.7
		trigger = {
			human_fallen_empires_trigger_is_materialist = yes
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		add_energy = 500
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step0
			set_country_flag = human_fallen_empires.5001.step1
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.5001.1.0
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			set_country_flag = human_fallen_empires.5001.step2.human
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.1.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.1.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.1.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			human_fallen_empires_trigger_is_spiritualist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = { id = human_fallen_empires.5001 }

		}
	}
	option = {
		name = human_fallen_empires.5001.1.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			nor = {
				has_country_flag = human_fallen_empires_marked_as_human
				has_ethic = ethic_fanatic_xenophobe
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophile
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step1
			set_country_flag = human_fallen_empires.5001.step2
			country_event = { id = human_fallen_empires.5001 }

		}
	}
	# step 2
	option = {
		name = human_fallen_empires.5001.2.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			has_country_flag = human_fallen_empires.5001.step2.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
			remove_country_flag = human_fallen_empires.5001.step2.human
			set_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step3.human
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.2.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			not = { has_country_flag = human_fallen_empires.5001.step2.human }
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
			set_country_flag = human_fallen_empires.5001.step3
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.2.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			human_fallen_empires_trigger_is_xenophobe = yes
			not = { has_country_flag = human_fallen_empires.5001.step2.human }
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
			event_target:human_fallen_empires_future_country = {
				set_closed_borders = {
					who = root
					status = yes
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.5001.2.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			human_fallen_empires_trigger_is_xenophobe = no
			nor = {
				has_ethic = ethic_fanatic_xenophobe
				has_ethic = ethic_xenophobe
				has_country_flag = human_fallen_empires.5001.step2.human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
			event_target:human_fallen_empires_future_country = {
				set_closed_borders = {
					who = root
					status = yes
				}
			}
		}
	}
	# step 3
	option = {
		name = human_fallen_empires.5001.3.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			has_country_flag = human_fallen_empires.5001.step3.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			remove_country_flag = human_fallen_empires.5001.step3.human
			set_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step4.human
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_collectivist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_individualist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_militarist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_pacifist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_spiritualist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.3.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_materialist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3
			set_country_flag = human_fallen_empires.5001.step4
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	# step 4
	option = {
		name = human_fallen_empires.5001.4.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			has_country_flag = human_fallen_empires.5001.step4.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			remove_country_flag = human_fallen_empires.5001.step4.human
			set_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step5.human
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_collectivist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_individualist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_militarist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_pacifist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_spiritualist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	option = {
		name = human_fallen_empires.5001.4.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_materialist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4
			set_country_flag = human_fallen_empires.5001.step5
			country_event = { id = human_fallen_empires.5001 }
		}
	}
	# step 5
	option = {
		name = human_fallen_empires.5001.5.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			has_country_flag = human_fallen_empires.5001.step5.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			remove_country_flag = human_fallen_empires.5001.step5.human
			set_country_flag = human_fallen_empires.5001.step6
			set_country_flag = human_fallen_empires.5001.step6.human
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_collectivist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_individualist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_xenophobe = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_xenophile = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_militarist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_pacifist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_spiritualist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.5.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_materialist = yes
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5
			set_country_flag = human_fallen_empires.5001.step6
			country_event = { id = human_fallen_empires.5002 }
		}
	}
}

# part 2 for male portrait
country_event = {
	id = human_fallen_empires.5002
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = "human_fallen_empires.5001.desc.6.1"
				has_country_flag = human_fallen_empires.5001.step6
				is_species_class = HUM
			}
			success_text = {
				text = "human_fallen_empires.5001.desc.6.2"
				has_country_flag = human_fallen_empires.5001.step6
				not = { is_species_class = HUM }
			}
			success_text = {
				text = "human_fallen_empires.5001.desc.7"
				has_country_flag = human_fallen_empires.5001.step7
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_male_leader
		room = human_fallen_empires_future_room
	}

	# step 6
	option = {
		name = human_fallen_empires.5001.6.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step6
			is_species_class = HUM
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step6
			set_country_flag = human_fallen_empires.5001.step7
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.6.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step6
			not = { is_species_class = HUM }
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step6
			set_country_flag = human_fallen_empires.5001.step7
			country_event = { id = human_fallen_empires.5002 }
		}
	}
	option = {
		name = human_fallen_empires.5001.7.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step7
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step7
			event_target:human_fallen_empires_future_country = {
				set_closed_borders = {
					who = root
					status = yes
				}
			}
		}
	}
}

# make future default country, start expansion era 5010 - 5012
country_event = {
	id = human_fallen_empires.5010
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_future_in_expansion
		}
		or = {
			years_passed > 110
			any_country = {
				is_country_type = default
				fleet_power > 50000
			#	not = {
			#		has_country_flag = human_fallen_empires_egypt
			#	}
			}
		}
	}

	immediate = {
		every_owned_ship = {
			repair_ship = yes
			add_modifier = {
				modifier = human_fallen_empires_unkeep
				days = -1
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_navy_size
			days = 3650
		}
		country_remove_ethic = ethic_fanatic_pacifist
		country_add_ethic = ethic_fanatic_militarist
		country_add_ethic = ethic_individualist
		every_owned_pop = {
			pop_remove_ethic = ethic_fanatic_pacifist
			pop_add_ethic = ethic_fanatic_militarist
			pop_add_ethic = ethic_individualist
		}
		kill_leader = {
			type = ruler
			show_notification = no
		}
		set_country_type = default
		change_government = martial_demarchy
		set_empire_name = "Kad Republic"
		set_global_flag = human_fallen_empires_future_in_expansion
		ruler = {
			save_event_target_as = human_fallen_empires_future_ruler
		}
		every_country = {
			establish_communications_no_message = event_target:human_fallen_empires_future_country
			if = {
				limit = { is_ai = no }
				country_event = { id = human_fallen_empires.5011 }
			}
		}
		random_country = {
			limit = {
				is_country_type = default
				fleet_power > 30000
				not = {
					is_country = root
				}
			}
			log = "future awekened by [This.GetName]"
		}
	}
}

# future expansion notification
country_event = {
	id = human_fallen_empires.5011
	title = "human_fallen_empires.5011.name"
	desc = "human_fallen_empires.5011.desc.0"
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future_ruler
		room = human_fallen_empires_future_room
	}

	option = {
		name = human_fallen_empires.5011.0
		trigger = {
			has_country_flag = human_fallen_empires_future_contacted
		}
		# добавить эвент приглашения
		#	hidden_effect = {

		#	}
		custom_tooltip = human_fallen_empires.5011.0.tooltip
	}
	option = {
		name = human_fallen_empires.5011.0
		trigger = {
			not = { has_country_flag = human_fallen_empires_future_contacted }
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires_future_contacted
		}
	}
}

# assimilation event (turn regular subject into coalitionmember subject type) 5020 - 5021
country_event = {
	id = human_fallen_empires.5020
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		any_subject = {
			not = { is_subject_type = human_fallen_empires_future_vassal }
		}
	}

	immediate = {
		random_subject = {
			limit = {
				not = { is_subject_type = human_fallen_empires_future_vassal }
			}
			set_subject_of = {
				who = root
				subject_type = human_fallen_empires_future_vassal
			}
			country_event = { id = human_fallen_empires.5021 }
		}
	}
}

# inform player
country_event = {
	id = human_fallen_empires.5021
	title = "human_fallen_empires.5021.name"
	desc = "human_fallen_empires.5021.desc"
	picture = GFX_evt_human_fallen_empires_coalition
	show_sound = event_administrative_work
	is_triggered_only = yes

	trigger = {
		is_ai = no
	}

	option = {
		name = human_fallen_empires.5021.0
	}
}


## anomalys and after survey on actions 5050 - 5100

# criopods anomaly 5050 - 5055

# switch to country
ship_event = {
	id = human_fallen_empires.5050
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				not = { exists = event_target:human_fallen_empires_future_species }
			}
			random_country = {
				limit = {
					has_country_flag = human_fallen_empires_future
				}
				species = { save_event_target_as = human_fallen_empires_future_species }
			}
		}
		from = { save_event_target_as = human_fallen_empires_criopods_planet }
		owner = {
			country_event = { id = human_fallen_empires.5051 }
		}
	}
}

# main event
country_event = {
	id = human_fallen_empires.5051
	title = human_fallen_empires.5051.name
	desc = {
		trigger = {
			# step 1
			# have contact
			success_text = {
				text = human_fallen_empires.5051.step1.desc.1
				has_country_flag = human_fallen_empires_future_contacted
			}
			# havent contact
			fail_text = {
				text = human_fallen_empires.5051.step1.desc.2
				has_country_flag = human_fallen_empires_future_contacted
			}
			# human addition
			success_text = {
				text = human_fallen_empires.5051.step1.desc.3
				not = { has_country_flag = human_fallen_empires_future_contacted }
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# step 2
			text = human_fallen_empires.5051.step2.desc.1
			# step 3
			# human
			# have contact
			success_text = {
				text = human_fallen_empires.5051.step3.desc.1
				has_country_flag = human_fallen_empires_future_contacted
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# havent contact
			success_text = {
				text = human_fallen_empires.5051.step3.desc.2
				not = {
					has_country_flag = human_fallen_empires_future_contacted
				}
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# non human
			# xenophobe
			success_text = {
				text = human_fallen_empires.5051.step3.desc.3
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				human_fallen_empires_trigger_is_xenophobe = yes
			}
			# xenophile
			success_text = {
				text = human_fallen_empires.5051.step3.desc.4
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				human_fallen_empires_trigger_is_xenophile = yes
			}
			# collectivist
			success_text = {
				text = human_fallen_empires.5051.step3.desc.5
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				human_fallen_empires_trigger_is_collectivist = yes
			}
			# individualist
			success_text = {
				text = human_fallen_empires.5051.step3.desc.6
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				human_fallen_empires_trigger_is_individualist = yes
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_colony_new
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_criopods_planet
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.5051.0
		trigger = {
			has_country_flag = human_fallen_empires_future_contacted
			has_country_flag = human_fallen_empires_marked_as_human
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_colony = {
				owner = root
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5051.1
		trigger = {
			not = { has_country_flag = human_fallen_empires_future_contacted }
			has_country_flag = human_fallen_empires_marked_as_human
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_colony = {
				owner = root
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5051.2
		trigger = {
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			or = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_colony = {
				owner = root
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5051.3
		trigger = {
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			or = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
		}
	}
	option = {
		name = human_fallen_empires.5051.4
		trigger = {
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			or = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_colony = {
				owner = root
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5051.5
		trigger = {
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			or = {
				has_ethic = ethic_collectivist
				has_ethic = ethic_fanatic_collectivist
			}
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_colony = {
				owner = root
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5051.6
		trigger = {
			not = { has_country_flag = human_fallen_empires_marked_as_human }
			or = {
				has_ethic = ethic_individualist
				has_ethic = ethic_fanatic_individualist
			}
		}
		hidden_effect = {
			random_list = {
				1 = { set_country_flag = human_fallen_empires_criopods_var_1 }
				1 = { set_country_flag = human_fallen_empires_criopods_var_2 }
				1 = { set_country_flag = human_fallen_empires_criopods_var_3 }
			}
			country_event = { id = human_fallen_empires.5052 days = 15 random = 15 }
		}
	}
}

# step 2 for individualist
country_event = {
	id = human_fallen_empires.5052
	title = human_fallen_empires.5052.name
	desc = {
		trigger = {
			hidden:root = {
				switch = {
					trigger = has_country_flag

					default = { text = "error" }
					human_fallen_empires_criopods_var_1 = { text = human_fallen_empires.5052.desc.1 }
					human_fallen_empires_criopods_var_2 = { text = human_fallen_empires.5052.desc.2 }
					human_fallen_empires_criopods_var_3 = { text = human_fallen_empires.5052.desc.3 }
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_colony_new
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_criopods_planet
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.5052.1
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_1
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_colony = {
				owner = root
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5052.2
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_2
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_country = {
				name = random
				type = default
				species = event_target:human_fallen_empires_future_species
				government = random
				flag = random
				ethos = {
					ethic = ethic_fanatic_individualist
					ethic = ethic_militarist
				}
				effect = {
					set_subject_of = {
						who = root
						subject_type = protectorate
					}
				}
			}
			create_colony = {
				owner = last_created_country
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5052.3
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_3
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_country = {
				name = random
				type = default
				species = event_target:human_fallen_empires_future_species
				government = random
				flag = random
				ethos = {
					ethic = ethic_fanatic_individualist
					ethic = ethic_militarist
				}
				effect = {
					establish_communications_no_message = root
				}
			}
			create_colony = {
				owner = last_created_country
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
		}
	}
	option = {
		name = human_fallen_empires.5052.4
		trigger = {
			has_country_flag = human_fallen_empires_criopods_var_3
			or = {
				has_ethic = ethic_fanatic_militarist
				has_ethic = ethic_militarist
			}
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_country = {
				name = random
				type = default
				species = event_target:human_fallen_empires_future_species
				government = random
				flag = random
				ethos = {
					ethic = ethic_fanatic_individualist
					ethic = ethic_militarist
				}
				effect = {
					establish_communications_no_message = root
				}
			}
			create_colony = {
				owner = last_created_country
				species = event_target:human_fallen_empires_future_species
				ethos = owner
			}
			root = {
				declare_war = {
					who = last_created_country
				}
				add_war_demand = {
					type = cede_planet
					parameter:planet = prev
					target = prev.owner
					warscore_cost = 50
				}
			}
		}
	}
	after = {
		remove_country_flag = human_fallen_empire_criopods_var_1
		remove_country_flag = human_fallen_empire_criopods_var_2
		remove_country_flag = human_fallen_empire_criopods_var_3
	}
}

# dead worms anomaly 5055 - 5057

# start
ship_event = {
	id = human_fallen_empires.5055
	title = human_fallen_empires.5055.name
	desc = human_fallen_empires.5055.desc
	picture = GFX_evt_human_fallen_empires_space_debris
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	option  = {
		name = human_fallen_empires_at_the_sreen
		leader = { add_experience = 200 }
		hidden_effect = {
			owner = {
				country_event = { id = human_fallen_empires.5056 }
			}
		}
	}
}

# diplo event
country_event = {
	id = human_fallen_empires.5056
	title = human_fallen_empires.5056.name
	desc = human_fallen_empires.5056.desc
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_dead_worms_room
	}

	option = {
		name = human_fallen_empires.5056.0
		response_text = human_fallen_empires.5056.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.5056.1
		response_text = human_fallen_empires.5056.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.5056.2
		hidden_effect = {
			country_event = { id = human_fallen_empires.5057 }
		}
	}
}

# for pic
country_event = {
	id = human_fallen_empires.5057
	title = human_fallen_empires.5056.name
	desc = human_fallen_empires.5056.2.response
	show_sound = event_space_battle
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_bombardment_room
	}

	option = {
		name = human_fallen_empires.5056.3
		trigger = {
			human_fallen_empires_trigger_is_xenophobe = yes
		}
	}
	option = {
		name = human_fallen_empires.5056.4
		trigger = {
			human_fallen_empires_trigger_is_xenophile = yes
		}
	}
	option = {
		name = human_fallen_empires.5056.5
		trigger = {
			human_fallen_empires_trigger_has_clever_trait = yes
		}
	}
	option = {
		name = human_fallen_empires.5056.6
		trigger = {
			human_fallen_empires_trigger_is_xenophobe = no
			human_fallen_empires_trigger_is_xenophile = no
			human_fallen_empires_trigger_has_clever_trait = no
		}
	}
}


# other dialoges 5100 - 5200

# buy robots 5100
country_event = {
	id = human_fallen_empires.5100
	title = TRANSMISSION
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.5100.desc.0
				has_country_flag = human_fallen_empires.5100.step1
			}
			success_text = {
				text = human_fallen_empires.5100.desc.1
				has_country_flag = human_fallen_empires.5100.step1
			}
		}
	}
	#	show_sound = event_alien_signal
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future_country
		room = human_fallen_empires_future_room
	}

	trigger = {
		any_owned_pop = {
			has_trait = trait_mechanical
		}
		exists = event_target:human_fallen_empires_future_country
	}

	immediate = {
		set_country_flag = human_fallen_empires_future_try_take_robot
	}

	option = {
		name = human_fallen_empires.5100.0
		trigger = {
			not = {
				has_policy_flag = ai_full_rights
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_army_trained_by_future
			days = -1
		}
		hidden_effect = {
			set_global_flag = human_fallen_empires_future_take_robot
			random_owned_pop = {
				limit = {
					has_trait = trait_mechanical
				}
				kill_pop = yes
			}
			event_target:human_fallen_empires_future_country = {
				random_owned_planet = {
					limit = {
						free_pop_tiles > 0
					}
					random_tile = {
						limit = {
							not = {
								exists = pop
							}
						}
						build_pop = {
    						name = buildable_robot_pop_3
    						grown = yes
						}
					}
				}
			}
		}
		custom_tooltip = human_fallen_empires.5100.yes.tooltip
	}
	option = {
		name = human_fallen_empires.5100.1
		trigger = {
			or = {
				human_fallen_empires_trigger_is_xenophobe = yes
				human_fallen_empires_trigger_is_collectivist = yes
			}
			has_policy_flag = ai_full_rights
		}
		add_modifier = {
			modifier = human_fallen_empires_army_trained_by_future
			days = -1
		}
		hidden_effect = {
			set_global_flag = human_fallen_empires_future_take_robot
			random_owned_pop = {
				limit = {
					has_trait = trait_mechanical
				}
				kill_pop = yes
			}
			event_target:human_fallen_empires_future_country = {
				random_owned_planet = {
					limit = {
						free_pop_tiles > 0
					}
					random_tile = {
						limit = {
							not = {
								exists = pop
							}
						}
						build_pop = {
    						name = buildable_robot_pop_3
    						grown = yes
						}
					}
				}
			}
		}
		custom_tooltip = human_fallen_empires.5100.yes.tooltip
	}
	option = {
		name = human_fallen_empires.5100.2
		trigger = {
			human_fallen_empires_trigger_is_xenophobe = no
			human_fallen_empires_trigger_is_collectivist = no
			has_policy_flag = ai_full_rights
		}
		response_text = human_fallen_empires.5100.no.response
	}
	option = {
		name = human_fallen_empires.5100.3
		response_text = human_fallen_empires.5100.no.response
	}
	option = {
		name = human_fallen_empires.5100.4
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.5100.step1
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.5100.step1
			country_event = { id = human_fallen_empires.5100 }
		}
	}
	option = {
		name = human_fallen_empires.5100.5
		trigger = {
			has_country_flag = human_fallen_empires.5100.step1
		}
		response_text = human_fallen_empires.5100.5.response
		is_dialog_only = yes
	}
}










### The War in Heavens by Human Fallen Empires
#10000+
# functional events

# Sleepers Awake
event = {
	id = human_fallen_empires.10000
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		years_passed > 100
		any_country = {
			is_country_type = fallen_empire
			is_at_war = no
		}

		# Wake up if regular empire is growing too strong or has started to conquer other fallen empires
		any_country = {
			is_country_type = default
			OR = {
				AND = {
					is_difficulty = 0
					#		NOT = { is_difficulty = 1 }
					fleet_power > 40000
				}
				AND = {
					is_difficulty = 1
					fleet_power > 50000
				}
				fleet_power > 60000
				any_owned_planet = {
					has_planet_flag = fallen_empire_world
				}
			}
		}
	}

	immediate = {
		random_list = {
			400 = { }
			100 = {
				modifier = {
					factor = 2
					any_country = {
						is_country_type = default
						OR = {
							AND = {
								is_difficulty = 0
								fleet_power > 60000
							}
							AND = {
								is_difficulty = 1
								fleet_power > 80000
							}
							fleet_power > 100000
						}
					}
				}
				modifier = {
					factor = 0.5
					num_fallen_empires > 1
					num_fallen_empires < 3
				}
				modifier = {
					factor = 0.5
					num_fallen_empires > 2
					num_fallen_empires < 4
				}
				modifier = {
					factor = 0.25
					num_fallen_empires > 3
				}
				modifier = {
					factor = 10
					any_country = {
						is_country_type = default
						any_owned_planet = {
							has_planet_flag = fallen_empire_world
						}
					}
				}
				modifier = {
					factor = 100
					has_global_flag = high_awaken_chance
				}
				# awake random fallen
				random_country = {
					limit = {
						is_country_type = fallen_empire
					}
					set_global_flag = sleepers_awake_happened
					set_global_flag = human_fallen_empires_sleepers_awake_happened
					country_event = { id = fallen_empires_awakening.3 }
					country_event = { id = human_fallen_empires.10001 }
				}
			}
		}
	}
}

# for inform
country_event = {
	id = human_fallen_empires.10001
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# inform player
		every_country = {
			limit = {
				is_ai = no
			}
			establish_communications_no_message = from
			country_event = { id = fallen_empires_awakening.2 }
		}
	}
}

# start war 100010
event = {
	id = human_fallen_empires.10010
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		host_has_dlc = "Leviathans Story Pack"
		count_countries = {
			limit = {
				is_country_type = awakened_fallen_empire
				is_at_war = no
				fleet_power > 40000
			}
			count > 1
		}
	}

	immediate = {
		random_list = {
			1 = { }
			4 = {
				break = yes
			}
		}
		every_country = {
			limit = {
				is_country_type = awakened_fallen_empire
			}
			remove_country_flag = ai_no_wars
			country_event = { id = fallen_empires.13 }
			if = {
				limit = {
					any_country = {
						is_country_type = default
						fleet_power > 50000
					}
				}
				country_event = { id = fallen_empires.13 }
			}
		}
		if = {
			limit = {
				count_countries = {
					limit = { is_country_type = awakened_fallen_empire }
					count > 3
				}
			}
			set_global_flag = human_fallen_empires_war_in_heaven_4
		}
		if = {
			limit = {
				count_countries = {
					limit = { is_country_type = awakened_fallen_empire }
					count = 3
				}
			}
			set_global_flag = human_fallen_empires_war_in_heaven_3
		}
		if = {
			limit = {
				count_countries = {
					limit = { is_country_type = awakened_fallen_empire }
					count = 2
				}
			}
			set_global_flag = human_fallen_empires_war_in_heaven_2
		}
		random_country = {
			limit = {
				is_country_type = awakened_fallen_empire
			}
			save_event_target_as = human_fallen_empires_1_awakened
		}
		random_country = {
			limit = {
				is_country_type = awakened_fallen_empire
				not = {
					is_country = event_target:human_fallen_empires_1_awakened
				}
			}
			save_event_target_as = human_fallen_empires_2_awakened
		}
		if = {
			limit = {
				or = {
					has_global_flag = human_fallen_empires_war_in_heaven_3
					has_global_flag = human_fallen_empires_war_in_heaven_4
				}
			}
			random_country = {
				limit = {
					is_country_type = awakened_fallen_empire
					nor = {
						is_country = event_target:human_fallen_empires_1_awakened
						is_country = event_target:human_fallen_empires_2_awakened
					}
				}
				save_event_target_as = human_fallen_empires_3_awakened
			}
		}
		if = {
			limit = {
				has_global_flag = human_fallen_empires_war_in_heaven_4
			}
			random_country = {
				limit = {
					is_country_type = awakened_fallen_empire
					nor = {
						is_country = event_target:human_fallen_empires_1_awakened
						is_country = event_target:human_fallen_empires_2_awakened
						is_country = event_target:human_fallen_empires_3_awakened
					}
				}
				save_event_target_as = human_fallen_empires_4_awakened
			}
		}
		# 1 vs 2
		event_target:human_fallen_empires_1_awakened = {
			declare_war = {
				who = event_target:human_fallen_empires_2_awakened
				major_war = yes
				name = "The War in Heaven"
			}
			add_war_demand = {
				type = "total_defeat"
				parameter:country = event_target:human_fallen_empires_2_awakened
				warscore_cost = 100
				target = this
				enemy = event_target:human_fallen_empires_2_awakened
			}
			event_target:human_fallen_empires_2_awakened = {
				add_war_demand = {
					type = "total_defeat"
					parameter:country = event_target:human_fallen_empires_1_awakened
					warscore_cost = 100
					target = this
					enemy = event_target:human_fallen_empires_1_awakened
				}
			}
		}
		if = {
			limit = {
				or = {
					has_global_flag = human_fallen_empires_war_in_heaven_3
					has_global_flag = human_fallen_empires_war_in_heaven_4
				}
			}
			# 3 vs 2
			event_target:human_fallen_empires_3_awakened = {
				declare_war = {
					who = event_target:human_fallen_empires_2_awakened
					major_war = yes
					name = "The War in Heaven"
				}
				add_war_demand = {
					type = "total_defeat"
					parameter:country = event_target:human_fallen_empires_2_awakened
					warscore_cost = 100
					target = this
					enemy = event_target:human_fallen_empires_2_awakened
				}
				event_target:human_fallen_empires_2_awakened = {
					add_war_demand = {
						type = "total_defeat"
						parameter:country = event_target:human_fallen_empires_3_awakened
						warscore_cost = 100
						target = this
						enemy = event_target:human_fallen_empires_3_awakened
					}
				}
			}
			# 3 vs 1
			event_target:human_fallen_empires_3_awakened = {
				declare_war = {
					who = event_target:human_fallen_empires_1_awakened
					major_war = yes
					name = "The War in Heaven"
				}
				add_war_demand = {
					type = "total_defeat"
					parameter:country = event_target:human_fallen_empires_1_awakened
					warscore_cost = 100
					target = this
					enemy = event_target:human_fallen_empires_1_awakened
				}
				event_target:human_fallen_empires_1_awakened = {
					add_war_demand = {
						type = "total_defeat"
						parameter:country = event_target:human_fallen_empires_3_awakened
						warscore_cost = 100
						target = this
						enemy = event_target:human_fallen_empires_3_awakened
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = human_fallen_empires_war_in_heaven_4
			}
			# 4 vs 2
			event_target:human_fallen_empires_4_awakened = {
				declare_war = {
					who = event_target:human_fallen_empires_2_awakened
					major_war = yes
					name = "The War in Heaven"
				}
				add_war_demand = {
					type = "total_defeat"
					parameter:country = event_target:human_fallen_empires_2_awakened
					warscore_cost = 100
					target = this
					enemy = event_target:human_fallen_empires_2_awakened
				}
				event_target:human_fallen_empires_2_awakened = {
					add_war_demand = {
						type = "total_defeat"
						parameter:country = event_target:human_fallen_empires_4_awakened
						warscore_cost = 100
						target = this
						enemy = event_target:human_fallen_empires_4_awakened
					}
				}
			}
			# 4 vs 1
			event_target:human_fallen_empires_4_awakened = {
				declare_war = {
					who = event_target:human_fallen_empires_1_awakened
					major_war = yes
					name = "The War in Heaven"
				}
				add_war_demand = {
					type = "total_defeat"
					parameter:country = event_target:human_fallen_empires_1_awakened
					warscore_cost = 100
					target = this
					enemy = event_target:human_fallen_empires_1_awakened
				}
				event_target:human_fallen_empires_1_awakened = {
					add_war_demand = {
						type = "total_defeat"
						parameter:country = event_target:human_fallen_empires_4_awakened
						warscore_cost = 100
						target = this
						enemy = event_target:human_fallen_empires_4_awakened
					}
				}
			}
			# 4 vs 3
			event_target:human_fallen_empires_4_awakened = {
				declare_war = {
					who = event_target:human_fallen_empires_3_awakened
					major_war = yes
					name = "The War in Heaven"
				}
				add_war_demand = {
					type = "total_defeat"
					parameter:country = event_target:human_fallen_empires_3_awakened
					warscore_cost = 100
					target = this
					enemy = event_target:human_fallen_empires_3_awakened
				}
				event_target:human_fallen_empires_3_awakened = {
					add_war_demand = {
						type = "total_defeat"
						parameter:country = event_target:human_fallen_empires_4_awakened
						warscore_cost = 100
						target = this
						enemy = event_target:human_fallen_empires_4_awakened
					}
				}
			}
		}
		every_country = {
			limit = {
				is_country_type = default
			}
			country_event = { id = human_fallen_empires.10050 }
		}
		set_global_flag = human_fallen_empires_war_in_heaven_started
	}
}

# inform events with text 10050
country_event = {
	id = human_fallen_empires.10050
	title = human_fallen_empires.10050.name
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.10050.desc.0.0
				exists = event_target:human_fallen_empires_3_awakened
			}
			success_text = {
				text = human_fallen_empires.10050.desc.0.1
				exists = event_target:human_fallen_empires_3_awakened
				not = { exists = event_target:human_fallen_empires_4_awakened }
			}
			success_text = {
				text = human_fallen_empires.10050.desc.0.2
				exists = event_target:human_fallen_empires_4_awakened
			}
			text = newline
			success_text = {
				text = human_fallen_empires.10050.desc.1.0
				exists = event_target:human_fallen_empires_coalition_leader
			}
			text = newline
			success_text = {
				text = human_fallen_empires.10050.desc.1.1
				exists = event_target:human_fallen_empires_egypt_country
				event_target:human_fallen_empires_egypt_country = {
					not = {
						is_country = event_target:human_fallen_empires_coalition_leader
					}
				}
			}
			text = newline
			text = human_fallen_empires.10050.desc.2.0
		}
	}
	picture = GFX_evt_fallen_empire_awakes
	show_sound = event_alien_signal
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.10050.0
		trigger = {
			is_subject = no
			#is_at_war = no		#подумать над этим
			is_country_type = default
			exists = event_target:human_fallen_empires_1_awakened
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				or = {
					has_ai_personality = fanatic_purifiers
					has_ai_personality = metalhead
					has_country_flag = human_fallen_empires_future
					has_country_flag = human_fallen_empires_egypt
				}
			}
			modifier = {
				factor = 0.5
				or = {
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_militarist = no
					}
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_xenophile = no
					}
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_spiritualist = no
					}
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_materialist = no
					}
					human_fallen_empires_trigger_is_xenophobe = yes
				}
			}
			modifier = {
				factor = 0.1
				or = {
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_xenophile = yes
					}
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_militarist = yes
					}
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_spiritualist = yes
					}
					and = {
						event_target:human_fallen_empires_1_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_materialist = yes
					}
				}
			}
		}
		hidden_effect = {
			set_country_flag = war_in_heaven_picked_side
			event_target:human_fallen_empires_1_awakened = {
				guarantee_country = {
					target = root
					free_guarantee_days = 3650
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_1_awakened = {
						has_ethic = ethic_fanatic_xenophobe
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_1_awakened
					subject_type = thrall
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_1_awakened = {
						has_ethic = ethic_fanatic_xenophile
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_1_awakened
					subject_type = signatory
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_1_awakened = {
						has_ethic = ethic_fanatic_spiritualist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_1_awakened
					subject_type = dominion
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_1_awakened = {
						has_ethic = ethic_fanatic_materialist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_1_awakened
					subject_type = satellite
				}
			}
			add_opinion_modifier = { who = event_target:human_fallen_empires_1_awakened modifier = opinion_war_in_heaven_ally }
			event_target:human_fallen_empires_1_awakened = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_ally } }
			# стоит ли добавить модификатор врага? from = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_enemy } }
			join_war = event_target:human_fallen_empires_1_awakened
		}
	}
	option = {
		name = human_fallen_empires.10050.1
		trigger = {
			is_subject = no
			#is_at_war = no		#подумать над этим
			is_country_type = default
			exists = event_target:human_fallen_empires_2_awakened
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				or = {
					has_ai_personality = fanatic_purifiers
					has_ai_personality = metalhead
					has_country_flag = human_fallen_empires_future
					has_country_flag = human_fallen_empires_egypt
				}
			}
			modifier = {
				factor = 0.5
				or = {
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_militarist = no
					}
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_xenophile = no
					}
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_spiritualist = no
					}
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_materialist = no
					}
					human_fallen_empires_trigger_is_xenophobe = yes
				}
			}
			modifier = {
				factor = 0.1
				or = {
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_xenophile = yes
					}
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_militarist = yes
					}
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_spiritualist = yes
					}
					and = {
						event_target:human_fallen_empires_2_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_materialist = yes
					}
				}
			}
		}
		hidden_effect = {
			set_country_flag = war_in_heaven_picked_side
			event_target:human_fallen_empires_2_awakened = {
				guarantee_country = {
					target = root
					free_guarantee_days = 3650
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_2_awakened = {
						has_ethic = ethic_fanatic_xenophobe
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_2_awakened
					subject_type = thrall
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_2_awakened = {
						has_ethic = ethic_fanatic_xenophile
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_2_awakened
					subject_type = signatory
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_2_awakened = {
						has_ethic = ethic_fanatic_spiritualist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_2_awakened
					subject_type = dominion
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_2_awakened = {
						has_ethic = ethic_fanatic_materialist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_2_awakened
					subject_type = satellite
				}
			}
			add_opinion_modifier = { who = event_target:human_fallen_empires_2_awakened modifier = opinion_war_in_heaven_ally }
			event_target:human_fallen_empires_2_awakened = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_ally } }
			# стоит ли добавить модификатор врага? from = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_enemy } }
			join_war = event_target:human_fallen_empires_2_awakened
		}
	}
	option = {
		name = human_fallen_empires.10050.2
		trigger = {
			is_subject = no
			#is_at_war = no		#подумать над этим
			is_country_type = default
			has_global_flag = human_fallen_empires_war_in_heaven_3
			exists = event_target:human_fallen_empires_3_awakened
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				or = {
					has_ai_personality = fanatic_purifiers
					has_ai_personality = metalhead
					has_country_flag = human_fallen_empires_future
					has_country_flag = human_fallen_empires_egypt
				}
			}
			modifier = {
				factor = 0.5
				or = {
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_militarist = no
					}
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_xenophile = no
					}
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_spiritualist = no
					}
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_materialist = no
					}
					human_fallen_empires_trigger_is_xenophobe = yes
				}
			}
			modifier = {
				factor = 0.1
				or = {
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_xenophile = yes
					}
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_militarist = yes
					}
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_spiritualist = yes
					}
					and = {
						event_target:human_fallen_empires_3_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_materialist = yes
					}
				}
			}
		}
		hidden_effect = {
			set_country_flag = war_in_heaven_picked_side
			event_target:human_fallen_empires_3_awakened = {
				guarantee_country = {
					target = root
					free_guarantee_days = 3650
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_3_awakened = {
						has_ethic = ethic_fanatic_xenophobe
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_3_awakened
					subject_type = thrall
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_3_awakened = {
						has_ethic = ethic_fanatic_xenophile
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_3_awakened
					subject_type = signatory
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_3_awakened = {
						has_ethic = ethic_fanatic_spiritualist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_3_awakened
					subject_type = dominion
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_3_awakened = {
						has_ethic = ethic_fanatic_materialist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_3_awakened
					subject_type = satellite
				}
			}
			add_opinion_modifier = { who = event_target:human_fallen_empires_3_awakened modifier = opinion_war_in_heaven_ally }
			event_target:human_fallen_empires_3_awakened = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_ally } }
			# стоит ли добавить модификатор врага? from = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_enemy } }
			join_war = event_target:human_fallen_empires_3_awakened
		}
	}
	option = {
		name = human_fallen_empires.10050.3
		trigger = {
			is_subject = no
			#is_at_war = no		#подумать над этим
			is_country_type = default
			exists = event_target:human_fallen_empires_4_awakened
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				or = {
					has_ai_personality = fanatic_purifiers
					has_ai_personality = metalhead
					has_country_flag = human_fallen_empires_future
					has_country_flag = human_fallen_empires_egypt
				}
			}
			modifier = {
				factor = 0.5
				or = {
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_militarist = no
					}
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_xenophile = no
					}
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_spiritualist = no
					}
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_materialist = no
					}
					human_fallen_empires_trigger_is_xenophobe = yes
				}
			}
			modifier = {
				factor = 0.1
				or = {
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_xenophobe
						}
						human_fallen_empires_trigger_is_xenophile = yes
					}
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_xenophile
						}
						human_fallen_empires_trigger_is_militarist = yes
					}
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_materialist
						}
						human_fallen_empires_trigger_is_spiritualist = yes
					}
					and = {
						event_target:human_fallen_empires_4_awakened = {
							has_ethic = ethic_fanatic_spiritualist
						}
						human_fallen_empires_trigger_is_materialist = yes
					}
				}
			}
		}
		hidden_effect = {
			set_country_flag = war_in_heaven_picked_side
			event_target:human_fallen_empires_4_awakened = {
				guarantee_country = {
					target = root
					free_guarantee_days = 3650
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_4_awakened = {
						has_ethic = ethic_fanatic_xenophobe
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_4_awakened
					subject_type = thrall
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_4_awakened = {
						has_ethic = ethic_fanatic_xenophile
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_4_awakened
					subject_type = signatory
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_4_awakened = {
						has_ethic = ethic_fanatic_spiritualist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_4_awakened
					subject_type = dominion
				}
			}
			if = {
				limit = {
					event_target:human_fallen_empires_4_awakened = {
						has_ethic = ethic_fanatic_materialist
					}
				}
				set_subject_of = {
					who = event_target:human_fallen_empires_4_awakened
					subject_type = satellite
				}
			}
			add_opinion_modifier = { who = event_target:human_fallen_empires_4_awakened modifier = opinion_war_in_heaven_ally }
			event_target:human_fallen_empires_4_awakened = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_ally } }
			# стоит ли добавить модификатор врага? from = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_enemy } }
			join_war = event_target:human_fallen_empires_4_awakened
		}
	}
	option = {
		name = human_fallen_empires.10050.4
		trigger = {
			is_subject = no
			#is_at_war = no		#подумать над этим
			is_country_type = default
			exists = event_target:human_fallen_empires_coalition_leader
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				or = {
					has_ai_personality = fanatic_purifiers
					has_ai_personality = metalhead
					has_country_flag = human_fallen_empires_egypt
				}
			}
			modifier = {
				factor = 0.5
				human_fallen_empires_trigger_is_individualist = no
				human_fallen_empires_trigger_is_xenophile = no
				human_fallen_empires_trigger_is_militarist = no
			}
			modifier = {
				factor = 0.1
				or = {
					human_fallen_empires_trigger_is_collectivist = yes
					human_fallen_empires_trigger_is_xenophobe = yes
					human_fallen_empires_trigger_is_pacifist = yes
				}
			}
		}
		hidden_effect = {
			set_country_flag = war_in_heaven_picked_side
			event_target:human_fallen_empires_coalition_leader = {
				guarantee_country = {
					target = root
					free_guarantee_days = 3650
				}
			}
			set_subject_of = {
				who = event_target:human_fallen_empires_coalition_leader
				subject_type = human_fallen_empires_future_vassal
			}
			add_opinion_modifier = { who = event_target:human_fallen_empires_future_country modifier = opinion_war_in_heaven_ally }
			event_target:human_fallen_empires_coalition_leader = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_ally } }
			# стоит ли добавить модификатор врага? from = { add_opinion_modifier = { who = root modifier = opinion_war_in_heaven_enemy } }
			join_war = event_target:human_fallen_empires_coalition_leader
		}
	}
	option = {
		name = human_fallen_empires.10050.5
		trigger = {
			is_subject = no
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.5
				fleet_power < 5000
			}
			modifier = {
				factor = 0.5
				fleet_power < 10000
			}
			modifier = {
				factor = 1.5
				fleet_power > 20000
			}
			modifier = {
				factor = 2
				fleet_power > 30000
			}
			modifier = {
				factor = 10
				fleet_power > 40000
			}
			modifier = {
				factor = 5
				has_federation = yes
			}
			modifier = {
				factor = 2
				any_country = {
					is_ai = no
					is_in_federation_with = root
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.10050.6
		trigger = {
			is_subject = yes
		}
		if = {
			limit = {
				overlord = { is_country = event_target:human_fallen_empires_1_awakened }
			}
			join_war = event_target:human_fallen_empires_1_awakened
		}
		if = {
			limit = {
				overlord = { is_country = event_target:human_fallen_empires_2_awakened }
			}
			join_war = event_target:human_fallen_empires_2_awakened
		}
		if = {
			limit = {
				exists = event_target:human_fallen_empires_3_awakened
				overlord = { is_country = event_target:human_fallen_empires_3_awakened }
			}
			join_war = event_target:human_fallen_empires_3_awakened
		}
		if = {
			limit = {
				exists = event_target:human_fallen_empires_4_awakened
				overlord = { is_country = event_target:human_fallen_empires_4_awakened }
			}
			join_war = event_target:human_fallen_empires_4_awakened
		}
	}
}

# event for empire after total war win 10150
country_event = {
	id = human_fallen_empires.10150
	title = human_fallen_empires.10150.name
	desc = human_fallen_empires.10150.desc.0
	picture = GFX_evt_fallen_empire_awakes
	show_sound = event_space_battle
	is_triggered_only = yes

	# make primitive
	option = {
		name = human_fallen_empires.10150.0
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				human_fallen_empires_trigger_is_materialist = no
			}
		}
		hidden_effect = {
			# inform
			every_country = {
				limit = {
					is_ai = no
				}
				country_event = { id = human_fallen_empires.10151 }
			}
		}
	}
	# annex
	option = {
		name = human_fallen_empires.10150.1
		ai_chance = {
			factor = 100
			modifier = {
				factor = 100
				has_country_flag = human_fallen_empires_egypt
			}
			modifier = {
				factor = 0
				human_fallen_empires_trigger_is_collectivist = no
				human_fallen_empires_trigger_is_individualist = no
			}
		}
		hidden_effect = {
			# inform
			every_country = {
				limit = {
					is_ai = no
				}
				country_event = { id = human_fallen_empires.10152 }
			}
		}
	}
	# make vassal
	option = {
		name = human_fallen_empires.10150.2
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				human_fallen_empires_trigger_is_spiritualist = no
				human_fallen_empires_trigger_is_xenophile = no
				not = { has_country_flag = human_fallen_empires_coalition_leader }
			}
		}
		hidden_effect = {
			# inform
			every_country = {
				limit = {
					is_ai = no
				}
				country_event = { id = human_fallen_empires.10152 }
			}
		}
	}
	# kill them all
	option = {
		name = human_fallen_empires.10150.3
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				human_fallen_empires_trigger_is_xenophobe = no
			}
		}
		hidden_effect = {
			# inform
			every_country = {
				limit = {
					is_ai = no
				}
				country_event = { id = human_fallen_empires.10154 }
			}
			event_target:WarInHeavenLoserFE = {
				every_owned_planet = {
					add_threat = {
						who = root
						amount = 3 # scales to pops
					}
					destroy_colony = yes
				}
			}
		}
	}
}

# inform after total war
country_event = {
	id = human_fallen_empires.10151
	title = human_fallen_empires.10151.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.10151.desc.0
				is_country = from
			}
			fail_text = {
				text = human_fallen_empires.10151.desc.1
				is_country = from
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_tech_fail
	show_sound = event_space_battle
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.10151.0
		trigger = {
			is_country = from
		}
	}

	option = {
		name = human_fallen_empires.10151.1
		trigger = {
			not = {
				is_country = from
			}
		}
	}
}

country_event = {
	id = human_fallen_empires.10152
	title = human_fallen_empires.10152.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.10152.desc.0
				is_country = from
			}
			fail_text = {
				text = human_fallen_empires.10152.desc.1
				is_country = from
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ships_on_orbit
	show_sound = event_space_battle
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.10152.0
		trigger = {
			is_country = from
		}
	}

	option = {
		name = human_fallen_empires.10152.1
		trigger = {
			not = {
				is_country = from
			}
		}
	}
}

country_event = {
	id = human_fallen_empires.10153
	title = human_fallen_empires.10153.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.10153.desc.0
				is_country = from
			}
			fail_text = {
				text = human_fallen_empires.10153.desc.1
				is_country = from
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_city_center
	show_sound = event_space_battle
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.10153.0
		trigger = {
			is_country = from
		}
	}

	option = {
		name = human_fallen_empires.10153.1
		trigger = {
			not = {
				is_country = from
			}
		}
	}
}

country_event = {
	id = human_fallen_empires.10154
	title = human_fallen_empires.10154.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.101513.desc.0
				is_country = from
			}
			fail_text = {
				text = human_fallen_empires.10154.desc.1
				is_country = from
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ruins
	show_sound = event_space_battle
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.10154.0
		trigger = {
			is_country = from
		}
	}

	option = {
		name = human_fallen_empires.10154.1
		trigger = {
			not = {
				is_country = from
			}
		}
	}
}

# fallen drain resurces if losing war 10200
country_event = {
	id = human_fallen_empires.10200
	title = human_fallen_empires.10200.name
	desc = human_fallen_empires.100200.desc.0
	picture = GFX_evt_human_fallen_empires_fallen_3
	show_sound = event_alien_signal
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.10050.0
		add_modifier = {
			modifier = human_fallen_empires_fallen_resurces_drain
			days = 1825
		}
		overlord = {
			add_modifier = {
				modifier = human_fallen_empires_fallen_ship_build_buff
				days = 1825
			}
		}
	}
}


## discovery section 15000

# discovery contact
country_event = {
	id = human_fallen_empires.15001
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		# mods stuff auto contact with vanilla stuff
		or = {
			is_country_type = human_fallen_empires_discovery
			has_country_flag = human_fallen_empires_discovery
			is_country_type = human_fallen_empires_pirate
		}
		from = {
			or = {
				is_guardian_country = yes
				is_country_type = default
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
				is_country_type = nomad
				is_country_type = enclave
				#is_country_type = primitive
				# has own contact rule for default empires
				is_country_type = human_fallen_empire
				# pirates will know pirates, why not
				is_country_type = human_fallen_empires_pirate
			}
		}
	}

	immediate = {
		establish_communications = from
	}
}

# if discovery destroyed = end game
# This = owner of ship 1 (destroyed)
# From = owner of ship 2 (combatant)
# FromFrom = ship 1
# FromFromFrom = ship 2
country_event = {
	id = human_fallen_empires.15002
	title = human_fallen_empires.15002.name
	desc = human_fallen_empires.15002.desc
	picture = GFX_evt_star_chart
	location = fromfrom
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		fromfrom = {
			has_ship_flag = human_fallen_empires_discovery_ship
		}
	}

	option = {
		name = human_fallen_empires.15002.0
		hidden_effect = {
			destroy_country = yes
		}
	}
}

# creatures contact for discovery
country_event = {
	id = human_fallen_empires.15003
	title = action.10.name
	desc = action.15.desc
	picture = GFX_evt_star_chart
	show_sound = advisor_notification_alien_vessel_encountered
	location = FROMFROMFROM
	is_triggered_only = yes

	trigger = {
		or = {
			is_country_type = human_fallen_empires_discovery
			has_country_flag = human_fallen_empires_discovery
		}
		from = {
			OR = {
				and = {
					is_country_type = amoeba
					not = {
						root = {
							has_country_flag = amoeba_encountered
						}
					}
				}
				and = {
					is_country_type = crystal
					not = {
						root = {
							has_country_flag = crystal_encountered
						}
					}
				}
				and = {
					is_country_type = drone
					not = {
						root = {
							has_country_flag = drone_encountered
						}
					}
				}
				and = {
					is_country_type = cloud
					not = {
						root = {
							has_country_flag = cloud_encountered
						}
					}
				}
				and = {
					is_country_type = tianki
					not = {
						root = {
							has_country_flag = cloud_encountered
						}
					}
				}
				and = {
					is_country_type = pirate
					not = {
						root = {
							has_country_flag = pirate_encountered
						}
					}
				}
			}
		}
	}

	immediate = {
		establish_communications = from # временное решение
		# придумать свои взаимодействия
	}

	option = {
		name = action.10.a
	}
}

# clear discovery war target flag after war end
country_event = {
	id = human_fallen_empires.15004
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		has_country_flag = human_fallen_empires_discovery_war_target
	}

	immediate = {
		remove_country_flag = human_fallen_empires_discovery_war_target
		fromfrom = {
			random_war_participant = {
				limit = {
					is_country_type = human_fallen_empires_discovery
				}
				save_event_target_as = human_fallen_empires_discovery_country
			}
			every_war_participant = {
				limit = {
					has_country_flag = human_fallen_empires_discovery_war_target
					not = {
						is_at_war_with = event_target:human_fallen_empires_discovery_country
					}
				}
				remove_country_flag = human_fallen_empires_discovery_war_target
			}
		}
	}
}

# make default country if have planets, kill desovery ship
country_event = {
	id = human_fallen_empires.15005
	hide_window = yes
    is_triggered_only = yes

	trigger = {
	#	has_country_flag = human_fallen_empires_discovery
		is_country_type = human_fallen_empires_discovery
		num_owned_planets > 0
		num_pops > 0
	}

	immediate = {
		set_country_type = default
		random_owned_ship = {
			limit = {
				has_ship_flag = human_fallen_empires_discovery_ship
			}

		}
	}
}

# on_ship_destroyed_perp
# This = owner of ship 1 (combatant)
# From = owner of ship 2 (destroyed)
# FromFrom = ship 1
# FromFromFrom = ship 2

# harvest from frags for on_ship_destroyed_perp
country_event = {
	id = human_fallen_empires.15050
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		exists = from
		exists = fromfrom
		exists = fromfromfrom
		fromfrom = {
			has_ship_flag = human_fallen_empires_discovery_ship
		}
	}

	immediate = {
		if = {
			limit = {
				not = {
					has_event_chain = human_fallen_empires_discovery_kill_count
				}
			}
			begin_event_chain = {
				event_chain = human_fallen_empires_discovery_kill_count
				target = root
			}
		}
		if = {
			limit = {
				fromfromfrom = {
					or = {
						is_ship_size = destroyer
						is_ship_size = military_station_small
						is_ship_size = small_ship_fallen_empire
						is_ship_size = nomad_destroyer
						is_ship_size = pirate_destroyer
						is_ship_size = military_station_small_ai
						is_ship_size = ancient_destroyer
						is_ship_size = crystal_ship_small_blue
						is_ship_size = crystal_ship_small_green
						is_ship_size = crystal_ship_small_yellow
						is_ship_size = crystal_ship_small_red
						is_ship_size = crystal_ship_small_blue_elite
						is_ship_size = crystal_ship_small_green_elite
						is_ship_size = crystal_ship_small_yellow_elite
						is_ship_size = crystal_ship_small_red_elite
					}
				}
			}
			add_minerals = @human_fallen_empires_discovery_kill_t1
			add_event_chain_counter = {
				event_chain = human_fallen_empires_discovery_kill_count
				counter = human_fallen_empires_discovery_kill_count_t1
				amount = 1
			}
			else = {
				if = {
					limit = {
						fromfromfrom = {
							or = {
								is_ship_size = cruiser
								is_ship_size = military_station_medium
								is_ship_size = military_station_small_fallen_empire
								is_ship_size = pirate_cruiser
								is_ship_size = pirate_station
								is_ship_size = space_amoeba_mother
								is_ship_size = crystal_ship_medium_blue
								is_ship_size = crystal_ship_medium_green
								is_ship_size = crystal_ship_medium_yellow
								is_ship_size = crystal_ship_medium_red
								is_ship_size = crystal_ship_medium_blue_elite
								is_ship_size = crystal_ship_medium_green_elite
								is_ship_size = crystal_ship_medium_yellow_elite
								is_ship_size = crystal_ship_medium_red_elite
							}
						}
					}
					add_minerals = @human_fallen_empires_discovery_kill_t2
					add_event_chain_counter = {
						event_chain = human_fallen_empires_discovery_kill_count
						counter = human_fallen_empires_discovery_kill_count_t2
						amount = 1
					}
					else = {
						if = {
							limit = {
								fromfromfrom = {
									or = {
										is_ship_size = battleship
										is_ship_size = military_station_large
										is_ship_size = large_ship_fallen_empire
										is_ship_size = military_station_large_fallen_empire
										is_ship_size = large_ship_ai
										is_ship_size = military_station_large_ai
										is_ship_size = crystal_ship_large_blue
										is_ship_size = crystal_ship_large_green
										is_ship_size = crystal_ship_large_yellow
										is_ship_size = crystal_ship_large_red
										is_ship_size = crystal_ship_large_blue_elite
										is_ship_size = crystal_ship_large_green_elite
										is_ship_size = crystal_ship_large_yellow_elite
										is_ship_size = crystal_ship_large_red_elite
										is_ship_size = orbital_station
									}
								}
							}
							add_minerals = @human_fallen_empires_discovery_kill_t3
							add_event_chain_counter = {
								event_chain = human_fallen_empires_discovery_kill_count
								counter = human_fallen_empires_discovery_kill_count_t3
								amount = 1
							}
							else = {
								if = {
									limit = {
										fromfromfrom = {
											or = {
												is_ship_size = massive_ship_fallen_empire
												is_ship_size = core_ai
												is_ship_size = crystal_station_large
												is_ship_size = asteroid
											}
										}
									}
									add_minerals = @human_fallen_empires_discovery_kill_t4
									add_event_chain_counter = {
										event_chain = human_fallen_empires_discovery_kill_count
										counter = human_fallen_empires_discovery_kill_count_t4
										amount = 1
									}
									else = {
										add_minerals = @human_fallen_empires_discovery_kill_t0
										add_event_chain_counter = {
											event_chain = human_fallen_empires_discovery_kill_count
											counter = human_fallen_empires_discovery_kill_count_t0
											amount = 1
										}
									}
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				from = {
					has_country_flag = human_fallen_empires_discovery_war_target
				}
				any_country = {
					is_at_war_with = from
					energy > 10
				}
			}
			if = {
				limit = {
					fromfromfrom = {
						is_ship_size = corvette
					}
				}
				random_country = {
					limit = {
						is_at_war_with = from
						energy > 10
					}
					add_energy = -10
					root = {
						add_energy = 10
						add_event_chain_counter = {
							event_chain = human_fallen_empires_discovery_kill_count
							counter = human_fallen_empires_discovery_kill_count_reward
							amount = 1
						}
					}
				}
				if = {
					limit = {
						fromfromfrom = {
							or = {
								is_ship_size = destroyer
								is_ship_size = military_station_small
								is_ship_size = small_ship_fallen_empire
							}
						}
					}
					random_country = {
						limit = {
							is_at_war_with = from
							energy > 100
						}
						add_energy = -100
						root = {
							add_energy = 100
							add_event_chain_counter = {
								event_chain = human_fallen_empires_discovery_kill_count
								counter = human_fallen_empires_discovery_kill_count_reward
								amount = 1
							}
						}
					}
					else = {
						if = {
							limit = {
								fromfromfrom = {
									or = {
										is_ship_size = cruiser
										is_ship_size = military_station_medium
										is_ship_size = military_station_small_fallen_empire
									}
								}
							}
							random_country = {
								limit = {
									is_at_war_with = from
									energy > 150
								}
								add_energy = -150
								root = {
									add_energy = 150
									add_event_chain_counter = {
										event_chain = human_fallen_empires_discovery_kill_count
										counter = human_fallen_empires_discovery_kill_count_reward
										amount = 1
									}
								}
							}
							else = {
								if = {
									limit = {
										fromfromfrom = {
											or = {
												is_ship_size = battleship
												is_ship_size = military_station_large
												is_ship_size = orbital_station
												is_ship_size = large_ship_fallen_empire
												is_ship_size = military_station_large_fallen_empire
											}
										}
									}
									random_country = {
										limit = {
											is_at_war_with = from
											energy > 200
										}
										add_energy = -200
										root = {
											add_energy = 200
											add_event_chain_counter = {
												event_chain = human_fallen_empires_discovery_kill_count
												counter = human_fallen_empires_discovery_kill_count_reward
												amount = 1
											}
										}
									}
									else = {
										if = {
											limit = {
												fromfromfrom = {
													is_ship_size = massive_ship_fallen_empire
												}
											}
											random_country = {
												limit = {
													is_at_war_with = from
													energy > 1000
												}
												add_energy = -1000
												root = {
													add_energy = 1000
													add_event_chain_counter = {
														event_chain = human_fallen_empires_discovery_kill_count
														counter = human_fallen_empires_discovery_kill_count_reward
														amount = 1
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				from = {
					or = {
						is_country_type = cloud
						is_country_type = extradimensional
						is_country_type = extradimensional_2
						is_country_type = extradimensional_3
					}
				}
			}
			add_energy = @human_fallen_empires_discovery_kill_energy
			add_event_chain_counter = {
				event_chain = human_fallen_empires_discovery_kill_count
				counter = human_fallen_empires_discovery_kill_count_energy
				amount = 1
			}
		}
		fromfrom = {
			solar_system = {
				if = {
					limit = {
						exists = space_owner
						exists = from
						space_owner = {
							energy > @human_fallen_empires_discovery_kill_reward
							nor = {
								is_country = root
								is_hostile = root
								is_country = from
							}
							is_hostile = from
						}
					}
					space_owner = {
						add_opinion_modifier = {
							who = root
							modifier = human_fallen_empires_option_discovery_kill_enemy
						}
						add_energy = @human_fallen_empires_discovery_kill_reward
						root = {
							add_energy = @human_fallen_empires_discovery_kill_reward
							add_event_chain_counter = {
								event_chain = human_fallen_empires_discovery_kill_count
								counter = human_fallen_empires_discovery_kill_count_reward
								amount = 1
							}
						}
					}
				}
			}
		}
	}
}

# kill check for contract pirate hunt for on_ship_destroyed_perp
country_event = {
	id = human_fallen_empires.15051
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		has_event_chain = human_fallen_empires_discovery_contract_pirate_hunt
		exists = fromfromfrom
		fromfromfrom = {
			is_ship_size = orbital_station
			fleet = {
				has_fleet_flag = human_fallen_empires_discovery_pirate_hunt_target
			}
		}
	}

	immediate = {
		end_event_chain = human_fallen_empires_discovery_contract_pirate_hunt
		random_country = {
			limit = {
				has_relation_flag = {
					who = root
					flag = human_fallen_empires_discovery_contract_pirate_hunt_hirer
				}
			}
			add_energy = @human_fallen_empires_discovery_contract_pirate_hunt_reward_minus
			log = "321"
		}
		add_energy = @human_fallen_empires_discovery_contract_pirate_hunt_reward
	}
}

# kill check for contract clear system for on_ship_destroyed_perp
country_event = {
	id = human_fallen_empires.15052
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_discovery
		has_event_chain = human_fallen_empires_discovery_contract_clear_system
		exists = fromfromfrom
		fromfromfrom = {
			solar_system = {
				has_star_flag = human_fallen_empires_discovery_contract_clear_system_target
				not = {
					any_ship_in_system = {
						exists = owner
						owner = {
							is_hostile = root
						}
					}
				}
			}
		}
	}

	immediate = {
		end_event_chain = human_fallen_empires_discovery_contract_clear_system
		fromfromfrom = {
			solar_system = {
				remove_star_flag = human_fallen_empires_discovery_contract_clear_system_target
			}
		}
	}
}

# check enemys in target system, for on_entering_system
ship_event = {
	id = human_fallen_empires.15053
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_discovery
			has_event_chain = human_fallen_empires_discovery_contract_clear_system
		}
		exists = from
		from = {
			has_star_flag = human_fallen_empires_discovery_contract_clear_system_target
			not = {
				any_ship_in_system = {
					exists = owner
					owner = {
						is_hostile = root.owner
					}
				}
			}
		}
	}

	immediate = {
		owner = {
			end_event_chain = human_fallen_empires_discovery_contract_clear_system
		}
		from = {
			remove_star_flag = human_fallen_empires_discovery_contract_clear_system_target
		}
	}
}

# trade and update on planet
# from = docking planet
fleet_event = {
	id = human_fallen_empires.15100
	show_sound = event_airlock
	hide_window = yes
    is_triggered_only = yes

	trigger = {
		is_ship_size = human_fallen_empires_deepvoid
		exists = owner
		owner = {
			is_country_type = human_fallen_empires_discovery
		}
		from = {
			exists = owner
			has_spaceport = yes
			owner = {
				is_country_type = default
				not = {
					is_hostile = root.owner
				}
			}
		}
	}

	immediate = {
		from = {
			save_event_target_as = human_fallen_empires_discovery_docking_planet
			owner = {
				save_event_target_as = human_fallen_empires_discovery_docking_planet_owner
			}
		}
		random_owned_ship = {
			limit = {
				has_ship_flag = human_fallen_empires_discovery_ship
			}
			save_event_target_as = human_fallen_empires_discovery_docking_ship
		}
		if = {
			limit = {
				from = {
					has_planet_flag = human_fallen_empires_discovery_contract_embassy_target
				}
				owner = {
					has_event_chain = human_fallen_empires_discovery_contract_embassy
				}
			}
			from = {
				remove_planet_flag = human_fallen_empires_discovery_contract_embassy_target
			}
			owner = {
				random_country = {
					limit = {
						has_relation_flag = {
							who = root.owner
							flag = human_fallen_empires_discovery_contract_embassy_hirer
						}
					}
					save_event_target_as = human_fallen_empires_discovery_contract_embassy_hirer
					add_energy = @human_fallen_empires_discovery_contract_embassy_reward_minus
					log = "embassy reward minus"
				}
				random_list = {
					1 = {
						set_timed_country_flag = { flag = human_fallen_empires_discovery_contract_embassy_success days = 1 }
						event_target:human_fallen_empires_discovery_contract_embassy_hirer = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_docking_planet_owner
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_success
							}
						}
						event_target:human_fallen_empires_discovery_docking_planet_owner = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_contract_embassy_hirer
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_success
							}
						}
					}
					1 = {
						set_timed_country_flag = { flag = human_fallen_empires_discovery_contract_embassy_fail days = 1 }
						event_target:human_fallen_empires_discovery_contract_embassy_hirer = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_docking_planet_owner
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_fail
							}
						}
						event_target:human_fallen_empires_discovery_docking_planet_owner = {
							add_opinion_modifier = {
								who = event_target:human_fallen_empires_discovery_contract_embassy_hirer
								modifier = human_fallen_empires_opinion_discovery_contract_embassy_fail
							}
						}
					}
				}
				end_event_chain = human_fallen_empires_discovery_contract_embassy
				add_energy = @human_fallen_empires_discovery_contract_embassy_reward
			}
		}
		owner = {
			country_event = { id = human_fallen_empires.15101 }
		}
	}
}

# discovery docking menu
country_event = {
	id = human_fallen_empires.15101
	title = human_fallen_empires.15101.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.15101.desc.0.0
				#	text = human_fallen_empires.15101.desc.0.1
				human_fallen_empires_trigger_discovery_docking_any_menu = no
			}
			success_text = {
				text = human_fallen_empires.15101.weapon_menu.desc.0
				has_country_flag = human_fallen_empires.15101.weapon_menu
			}
			success_text = {
				text = human_fallen_empires.15101.defense_menu.desc.0
				has_country_flag = human_fallen_empires.15101.defense_menu
			}
			success_text = {
				text = human_fallen_empires.15101.engine_menu.desc.0
				has_country_flag = human_fallen_empires.15101.engine_menu
			}
			success_text = {
				text = human_fallen_empires.15101.other_menu.desc.0
				has_country_flag = human_fallen_empires.15101.other_menu
			}
			success_text = {
				text = human_fallen_empires.15101.crew_menu.desc.0
				has_country_flag = human_fallen_empires.15101.crew_menu
			}
			success_text = {
				text = human_fallen_empires.15101.contract_menu.desc.0
				has_country_flag = human_fallen_empires.15101.contract_menu
			}
			# quests
			# no quest
			success_text = {
				text = human_fallen_empires.15101.1.0
				human_fallen_empires_trigger_discovery_docking_any_menu = no
				human_fallen_empires_trigger_discovery_docking_any_quest = no
			}
			# embassy
			# embassy success
			success_text = {
				text = human_fallen_empires.15101.contract_menu.desc.1.0
				human_fallen_empires_trigger_discovery_docking_any_menu = no
				has_country_flag = human_fallen_empires_discovery_contract_embassy_success
			}
			# embassy fail
			success_text = {
				text = human_fallen_empires.15101.contract_menu.desc.1.1
				human_fallen_empires_trigger_discovery_docking_any_menu = no
				has_country_flag = human_fallen_empires_discovery_contract_embassy_fail
			}
		}
	}
	location = root
	is_triggered_only = yes
	diplomatic = yes
	#force_open = yes что это значит?

	picture_event_data = {
		room = human_fallen_empires_docking_room
	}

	# update weapons menu
	option = {
		name = human_fallen_empires.15101.0
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.15101.weapon_menu
			country_event = { id = human_fallen_empires.15101 }
		}
	}
	# damage lvl 1
	option = {
		name = human_fallen_empires.15101.weapon_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.0.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = 300
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 2
	option = {
		name = human_fallen_empires.15101.weapon_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.0.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 3
	option = {
		name = human_fallen_empires.15101.weapon_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.0.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 4
	option = {
		name = human_fallen_empires.15101.weapon_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.0.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 5
	option = {
		name = human_fallen_empires.15101.weapon_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.0.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# damage lvl 6
	option = {
		name = human_fallen_empires.15101.weapon_menu.0.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_damage_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.0.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_damage_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 1
	option = {
		name = human_fallen_empires.15101.weapon_menu.1.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.1.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 2
	option = {
		name = human_fallen_empires.15101.weapon_menu.1.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.1.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 3
	option = {
		name = human_fallen_empires.15101.weapon_menu.1.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.1.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 4
	option = {
		name = human_fallen_empires.15101.weapon_menu.1.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.1.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 5
	option = {
		name = human_fallen_empires.15101.weapon_menu.1.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.1.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# fire rate lvl 6
	option = {
		name = human_fallen_empires.15101.weapon_menu.1.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_fire_rate_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.1.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_fire_rate_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 1
	option = {
		name = human_fallen_empires.15101.weapon_menu.2.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.2.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 2
	option = {
		name = human_fallen_empires.15101.weapon_menu.2.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.2.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 3
	option = {
		name = human_fallen_empires.15101.weapon_menu.2.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.2.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 4
	option = {
		name = human_fallen_empires.15101.weapon_menu.2.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.2.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 5
	option = {
		name = human_fallen_empires.15101.weapon_menu.2.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.2.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# accuracy lvl 6
	option = {
		name = human_fallen_empires.15101.weapon_menu.2.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_accuracy_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.2.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_accuracy_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 1
	option = {
		name = human_fallen_empires.15101.weapon_menu.3.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.3.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 2
	option = {
		name = human_fallen_empires.15101.weapon_menu.3.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.3.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 3
	option = {
		name = human_fallen_empires.15101.weapon_menu.3.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.3.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 4
	option = {
		name = human_fallen_empires.15101.weapon_menu.3.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.3.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 5
	option = {
		name = human_fallen_empires.15101.weapon_menu.3.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.3.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# range lvl 6
	option = {
		name = human_fallen_empires.15101.weapon_menu.3.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.weapon_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.3.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_range_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# update defenses menu
	option = {
		name = human_fallen_empires.15101.1
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.15101.defense_menu
			country_event = { id = human_fallen_empires.15101 }
		}
	}
	# hp lvl 1
	option = {
		name = human_fallen_empires.15101.defense_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.0.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 2
	option = {
		name = human_fallen_empires.15101.defense_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.0.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 3
	option = {
		name = human_fallen_empires.15101.defense_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.0.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 4
	option = {
		name = human_fallen_empires.15101.defense_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.0.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 5
	option = {
		name = human_fallen_empires.15101.defense_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_hp_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.0.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# hp lvl 6
	option = {
		name = human_fallen_empires.15101.defense_menu.0.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				custom_tooltip_fail = {
					text = human_fallen_empires.15101.fail_already_installed
					event_target:human_fallen_empires_discovery_docking_ship = {
						not = {
							has_modifier = human_fallen_empires_discovery_hp_6
						}
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				custom_tooltip_fail = {
					text = human_fallen_empires.15101.fail_already_installed
					event_target:human_fallen_empires_discovery_docking_ship = {
						not = {
							has_modifier = human_fallen_empires_discovery_hp_6
						}
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.0.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_hp_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 1
	option = {
		name = human_fallen_empires.15101.defense_menu.1.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.1.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 2
	option = {
		name = human_fallen_empires.15101.defense_menu.1.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.1.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 3
	option = {
		name = human_fallen_empires.15101.defense_menu.1.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.1.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 4
	option = {
		name = human_fallen_empires.15101.defense_menu.1.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.1.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 5
	option = {
		name = human_fallen_empires.15101.defense_menu.1.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.1.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# armor lvl 6
	option = {
		name = human_fallen_empires.15101.defense_menu.1.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_armor_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.1.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_armor_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 1
	option = {
		name = human_fallen_empires.15101.defense_menu.2.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.2.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 2
	option = {
		name = human_fallen_empires.15101.defense_menu.2.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.2.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 3
	option = {
		name = human_fallen_empires.15101.defense_menu.2.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.2.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 4
	option = {
		name = human_fallen_empires.15101.defense_menu.2.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.2.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 5
	option = {
		name = human_fallen_empires.15101.defense_menu.2.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.defense_menu.2.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# shield lvl 6
	option = {
		name = human_fallen_empires.15101.defense_menu.2.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.defense_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_shield_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.weapon_menu.3.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_shield_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# update engine menu
	option = {
		name = human_fallen_empires.15101.2
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.15101.engine_menu
			country_event = { id = human_fallen_empires.15101 }
		}
	}
	# subspase speed lvl 1
	option = {
		name = human_fallen_empires.15101.engine_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 2
	option = {
		name = human_fallen_empires.15101.engine_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 3
	option = {
		name = human_fallen_empires.15101.engine_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 4
	option = {
		name = human_fallen_empires.15101.engine_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 5
	option = {
		name = human_fallen_empires.15101.engine_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# subspase speed lvl 6
	option = {
		name = human_fallen_empires.15101.engine_menu.0.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_speed_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 1
	option = {
		name = human_fallen_empires.15101.engine_menu.1.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.1.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 2
	option = {
		name = human_fallen_empires.15101.engine_menu.1.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.1.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 3
	option = {
		name = human_fallen_empires.15101.engine_menu.1.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.1.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 4
	option = {
		name = human_fallen_empires.15101.engine_menu.1.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.1.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 5
	option = {
		name = human_fallen_empires.15101.engine_menu.1.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.1.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# warp range lvl 6
	option = {
		name = human_fallen_empires.15101.engine_menu.1.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_warp_range_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.1.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_warp_range_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 1
	option = {
		name = human_fallen_empires.15101.engine_menu.2.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.2.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 2
	option = {
		name = human_fallen_empires.15101.engine_menu.2.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.2.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 3
	option = {
		name = human_fallen_empires.15101.engine_menu.2.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.2.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 4
	option = {
		name = human_fallen_empires.15101.engine_menu.2.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.2.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# inerstellar speed lvl 5
	option = {
		name = human_fallen_empires.15101.engine_menu.2.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.2.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}

	# inerstellar speed lvl 6
	option = {
		name = human_fallen_empires.15101.engine_menu.2.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_interstellar_speed_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.2.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_interstellar_speed_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 1
	option = {
		name = human_fallen_empires.15101.engine_menu.3.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_1
					}
				}
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_1
					}
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.3.0.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_1
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 2
	option = {
		name = human_fallen_empires.15101.engine_menu.3.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_2
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 1
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.3.1.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_2
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 3
	option = {
		name = human_fallen_empires.15101.engine_menu.3.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_3
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 2
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.3.2.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_3
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 4
	option = {
		name = human_fallen_empires.15101.engine_menu.3.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_4
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 3
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.3.3.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_4
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 5
	option = {
		name = human_fallen_empires.15101.engine_menu.3.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_5
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.3.4.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_5
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# winddown lvl 6
	option = {
		name = human_fallen_empires.15101.engine_menu.3.5
		trigger = {
			has_country_flag = human_fallen_empires.15101.engine_menu
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}
		allow = {
			minerals > @human_fallen_empires_discovery_docking_update_minerals_cos
			energy > @human_fallen_empires_discovery_docking_update_energy_cost
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_already_installed
				event_target:human_fallen_empires_discovery_docking_ship = {
					not = {
						has_modifier = human_fallen_empires_discovery_winddown_6
					}
				}
			}
			event_target:human_fallen_empires_discovery_docking_planet = {
				num_spaceport_modules > 5
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.3.5.response

		add_minerals = @human_fallen_empires_discovery_docking_update_minerals_cost_minus
		add_energy = @human_fallen_empires_discovery_docking_update_energy_cost_minus
		event_target:human_fallen_empires_discovery_docking_ship = {
			add_modifier = {
				modifier = human_fallen_empires_discovery_winddown_6
				days = -1
			}
		}

		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_minerals = @human_fallen_empires_discovery_docking_update_minerals_dock_owner
			add_energy = @human_fallen_empires_discovery_docking_update_energy_dock_owner
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# other menu
	option = {
		name = human_fallen_empires.15101.3
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.15101.other_menu
			country_event = { id = human_fallen_empires.15101 }
		}
	}
	option = {
		name = human_fallen_empires.15101.other_menu.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.other_menu
		}
		allow = {
			minerals > 100
			energy > 100
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.other_menu.0.response

		add_minerals = -100
		add_energy = -100
		create_ship_design = {
			design = Prototype
			ftl = warp
		}
		create_fleet = {
			name = "Science Ship"
			effect = {
				set_owner = event_target:human_fallen_empires_discovery_docking_ship.owner
				create_ship = {
					name = random
					design = last_created_design
				}
				set_location = event_target:human_fallen_empires_discovery_docking_ship
			}
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
			add_trust = {
				who = root
				amount = 5
			}
		}
		add_trust = {
			who = event_target:human_fallen_empires_discovery_docking_planet_owner
			amount = 5
		}
	}
	# crew menu
	option = {
		name = human_fallen_empires.15101.crew_menu
		trigger = {
			has_country_flag = human_fallen_empires.15101.other_menu
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.15101.other_menu
			set_country_flag = human_fallen_empires.15101.crew_menu
			country_event = { id = human_fallen_empires.15101 }
		}
	}
	# crew lvl 1
	option = {
		name = human_fallen_empires.15101.crew_menu.0.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.crew_menu
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_1
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 200
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_1
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.1.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_1
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew lvl 2
	option = {
		name = human_fallen_empires.15101.crew_menu.0.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.crew_menu
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 200
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.2.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_2
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew lvl 3
	option = {
		name = human_fallen_empires.15101.crew_menu.0.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.crew_menu
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 200
			nor = {
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.3.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_3
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew lvl 4
	option = {
		name = human_fallen_empires.15101.crew_menu.0.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.crew_menu
			not = {
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}
		allow = {
			energy > 100
			not = {
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.4.response

		add_energy = -200
		human_fallen_empires_effect_clean_crew_modifier = yes
		add_modifier = {
			modifier = human_fallen_empires_discovery_crew_4
			days = -1
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# crew freeze
	option = {
		name = human_fallen_empires.15101.crew_menu.0.4
		trigger = {
			has_country_flag = human_fallen_empires.15101.crew_menu
		}
		allow = {
			energy > 100
			or = {
				has_modifier = human_fallen_empires_discovery_crew_1
				has_modifier = human_fallen_empires_discovery_crew_2
				has_modifier = human_fallen_empires_discovery_crew_3
				has_modifier = human_fallen_empires_discovery_crew_4
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.engine_menu.0.4.response

		add_energy = -200
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_1
			}
			remove_modifier = human_fallen_empires_discovery_crew_1
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_2
			}
			remove_modifier = human_fallen_empires_discovery_crew_2
			add_modifier = {
				modifier = human_fallen_empires_discovery_crew_1
				days = -1
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_3
			}
			remove_modifier = human_fallen_empires_discovery_crew_3
			add_modifier = {
				modifier = human_fallen_empires_discovery_crew_2
				days = -1
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_discovery_crew_4
			}
			remove_modifier = human_fallen_empires_discovery_crew_4
			add_modifier = {
				modifier = human_fallen_empires_discovery_crew_3
				days = -1
			}
		}
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = 100
		}
	}
	# contract menu
	option = {
		name = human_fallen_empires.15101.contract_menu
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.15101.contract_menu
			country_event = { id = human_fallen_empires.15101 }
		}
	}
	# pirate hunt contract
	option = {
		name = human_fallen_empires.15101.contract_menu.0
		trigger = {
			has_country_flag = human_fallen_empires.15101.contract_menu
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				has_country_flag = human_fallen_empires_attacked_by_pirate
			}
		}
		allow = {
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_has_contract_pirate_hunt
				not = {
					has_event_chain = human_fallen_empires_discovery_contract_pirate_hunt
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.contract_menu.0.response

		begin_event_chain = {
			event_chain = human_fallen_empires_discovery_contract_pirate_hunt
			target = root
		}
		hidden_effect = {
			event_target:human_fallen_empires_discovery_docking_planet = {
				owner = {
					save_event_target_as = human_fallen_empires_discovery_pirate_hunt_hirer
					set_relation_flag = {
						who = root
						flag = human_fallen_empires_discovery_contract_pirate_hunt_hirer
					}
				}
				closest_system = {
					limit = {
						any_planet = {
							exists = owner
							owner = {
								is_country_type = human_fallen_empires_pirate
							}
						}
					}
					every_fleet_in_system = {
						limit = {
							is_ship_size = orbital_station
						}
						set_fleet_flag = human_fallen_empires_discovery_pirate_hunt_target
					}
					random_system_planet = {
						limit = {
							exists = owner
							owner = {
								is_country_type = human_fallen_empires_pirate
							}
						}
						save_event_target_as = human_fallen_empires_discovery_pirate_hunt_target
					}
				}
			}
			create_point_of_interest = {
				id = human_fallen_empires_discovery_pirate_hunt_point.0
				name = human_fallen_empires_discovery_contract_pirate_hunt.name
				desc = human_fallen_empires_discovery_contract_pirate_hunt.desc
				event_chain = human_fallen_empires_discovery_contract_pirate_hunt
				location = event_target:human_fallen_empires_discovery_pirate_hunt_target
			}
		}
	}
	# contract embassy mission
	option = {
		name = human_fallen_empires.15101.contract_menu.1
		trigger = {
			has_country_flag = human_fallen_empires.15101.contract_menu
			any_country = {
				or = {
					is_hostile_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_dismissive_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_angry_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_unfriendly_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_rival = event_target:human_fallen_empires_discovery_docking_planet_owner
					is_disloyal_to = event_target:human_fallen_empires_discovery_docking_planet_owner
				}
				nor = {
					is_hostile = root
					has_closed_borders = root
				}
			}
		}
		allow = {
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_has_contract_embassy
				not = {
					has_event_chain = human_fallen_empires_discovery_contract_embassy
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.contract_menu.1.response

		begin_event_chain = {
			event_chain = human_fallen_empires_discovery_contract_embassy
			target = root
		}
		hidden_effect = {
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				set_relation_flag = {
					who = root
					flag = human_fallen_empires_discovery_contract_embassy_hirer
				}
			}
			random_country = {
				limit = {
					or = {
						is_hostile_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_dismissive_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_angry_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_unfriendly_to = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_rival = event_target:human_fallen_empires_discovery_docking_planet_owner
						is_disloyal_to = event_target:human_fallen_empires_discovery_docking_planet_owner
					}
					nor = {
						is_hostile = root
						has_closed_borders = root
					}
				}
				#	save_event_target_as = human_fallen_empires_discovery_embassy_target_country
				capital_scope = {
					set_planet_flag = human_fallen_empires_discovery_contract_embassy_target
					save_event_target_as = human_fallen_empires_discovery_embassy_target
				}
			}
			create_point_of_interest = {
				id = human_fallen_empires_discovery_contract_embassy_point.0
				name = human_fallen_empires_discovery_contract_embassy.name
				desc = human_fallen_empires_discovery_contract_embassy.desc
				event_chain = human_fallen_empires_discovery_contract_embassy
				location = event_target:human_fallen_empires_discovery_embassy_target
			}
		}
	}
	# contract clear system
	option = {
		name = human_fallen_empires.15101.contract_menu.2
		trigger = {
			has_country_flag = human_fallen_empires.15101.contract_menu
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				any_system_within_border = {
					any_ship_in_system = {
						exists = owner
						owner = {
							is_hostile = root
							is_hostile = event_target:human_fallen_empires_discovery_docking_planet_owner
						}
					}
				}
			}
		}
		allow = {
			custom_tooltip_fail = {
				text = human_fallen_empires.15101.fail_has_contract_clear_system
				not = {
					has_event_chain = human_fallen_empires_discovery_contract_clear_system
				}
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.contract_menu.2.response

		begin_event_chain = {
			event_chain = human_fallen_empires_discovery_contract_clear_system
			target = root
		}
		hidden_effect = {
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				set_relation_flag = {
					who = root
					flag = human_fallen_empires_discovery_contract_clear_system_hirer
				}
				random_system_within_border = {
					limit = {
						any_ship_in_system = {
							exists = owner
							owner = {
								is_hostile = root
								is_hostile = event_target:human_fallen_empires_discovery_docking_planet_owner
							}
						}
					}
					save_event_target_as = human_fallen_empires_discovery_clear_system_target
				}
			}
			create_point_of_interest = {
				id = human_fallen_empires_discovery_contract_clear_system_point.0
				name = human_fallen_empires_discovery_contract_clear_system.name
				desc = human_fallen_empires_discovery_contract_clear_system.desc
				event_chain = human_fallen_empires_discovery_contract_clear_system
				location = event_target:human_fallen_empires_discovery_clear_system_target
			}
		}
	}
	# contract join war
	option = {
		name = human_fallen_empires.15101.contract_menu.3
		trigger = {
			has_country_flag = human_fallen_empires.15101.contract_menu
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				is_at_war = yes
			}
			human_fallen_empires_trigger_discovery_docking_any_menu = no
		}
		allow = {
			is_at_war = no
			event_target:human_fallen_empires_discovery_docking_planet_owner = {
				energy > 100
			}
		}

		is_dialog_only = yes
		response_text = human_fallen_empires.15101.contract_menu.3

		add_energy = 100
		join_war = event_target:human_fallen_empires_discovery_docking_planet_owner
		event_target:human_fallen_empires_discovery_docking_planet_owner = {
			add_energy = -100
		}
		hidden_effect = {
			every_country = {
				limit = {
					is_at_war_with = root
				}
				set_country_flag = human_fallen_empires_discovery_war_target
			}
		}
	}
	# return
	option = {
		name =  modmenu_return
		trigger = {
			human_fallen_empires_trigger_discovery_docking_any_menu = yes
		}
		hidden_effect = {
			human_fallen_empires_effect_discovery_diplomacy_remove_flags = yes
			country_event = { id = human_fallen_empires.15101 }
		}
	}
	# exit
	option = {
		name =  human_fallen_empires.15101.exit
		hidden_effect = {
			human_fallen_empires_effect_discovery_diplomacy_remove_flags = yes
		}
	}
}
