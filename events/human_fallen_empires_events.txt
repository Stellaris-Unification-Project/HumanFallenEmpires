#
namespace = human_fallen_empires

# functional section 0 - 50

# functional events and features
# functional events for yearly pulse
event = {
	id = human_fallen_empires.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# leaders module
		every_country = {
			country_event = {
				id = human_fallen_empires_leaders.0
				days = 1
				random = 355
			}
			country_event = {
				id = human_fallen_empires_leaders.101
				days = 1
				random = 355
			}
		}
		every_playable_country = {
			country_event = {
				id = human_fallen_empires_maintenance.5
				days = 1
				random = 355
			}
		}
		# pirate module
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_disable_pirate
				}
			}
			# pirate life
			every_country = {
				limit = {
					is_country_type = human_fallen_empires_pirate
				}
				country_event = {
					id = human_fallen_empires_pirate.2
					days = 1
					random = 355
				}
			}
			# every_playable_country = {
			# 	limit = {
			# 		not = {
			# 			has_country_flag = human_fallen_empires_pirate_spawned
			# 		}
			# 		num_owned_planets > 2
			# 		human_fallen_empires_trigger_is_human_fallen = no
			# 		human_fallen_empires_trigger_is_hive = no
			# 		is_country_type = default
			# 	}
			# 	# spawn pirate
			# 	random_list = {
			# 		9 = {
			# 		}
			# 		1 = {
			# 			modifier = {
			# 				factor = 2
			# 				or = {
			# 					is_difficulty > 0
			# 					is_difficulty > 1
			# 				}
			# 			}
			# 			modifier = {
			# 				factor = 2
			# 				or = {
			# 					is_difficulty > 2
			# 					is_difficulty > 3
			# 				}
			# 			}
			# 			modifier = {
			# 				factor = 2
			# 				or = {
			# 					is_at_war = yes
			# 					recently_lost_war = yes
			# 				}
			# 			}
			# 			modifier = {
			# 				factor = 2
			# 				or = {
			# 					is_militarist = yes
			# 					is_egalitarian = yes
			# 				}
			# 			}
			# 			modifier = {
			# 				factor = 0.5
			# 				or = {
			# 					is_pacifist = yes
			# 					is_authoritarian = yes
			# 				}
			# 			}
			# 			modifier = {
			# 				factor = 2
			# 				any_owned_planet = {
			# 					is_occupied_flag = yes
			# 				}
			# 			}
			# 			modifier = {
			# 				factor = 2
			# 				exists = capital_scope
			# 				capital_scope = {
			# 					is_occupied_flag = yes
			# 				}
			# 			}
			# 			country_event = {
			# 				id = human_fallen_empires_pirate.0
			# 				days = 1
			# 				random = 355
			# 			}
			# 		}
			# 	}
			# }
		}
	}
}

# functional events for bi yearly pulse
event = {
	id = human_fallen_empires.2
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# change main species
		every_country = {
			country_event = {
				id = human_fallen_empires_population.50
				days = 1
				random = 700
			}
		}
		random_country = {
			limit = {
				has_modifier = human_fallen_empires_discovery_research
				has_country_flag = human_fallen_empires_discovery
				num_owned_planets > 0
			}
			remove_modifier = human_fallen_empires_discovery_research
		}
		# assimilation event for coalition
		if = {
			limit = {
				exists = event_target:human_fallen_empires_coalition_leader
			}
			event_target:human_fallen_empires_coalition_leader = {
				country_event = {
					id = human_fallen_empires.5020
					days = 1
					random = 700
				}
			}
		}
		# egypt change vassal type
		if = {
			limit = {
				exists = event_target:human_fallen_empires_egypt_country
			}
			event_target:human_fallen_empires_egypt_country = {
				country_event = {
					id = human_fallen_empires_maintenance.51
					days = 1
					random = 700
				}
			}
		}
		# varelse mehanicus event
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_varelse_mehanicus
				}
			}
			random_country = {
				limit = {
					is_country_type = primitive
					any_owned_planet = {
						has_planet_flag = human_fallen_empires_varelse_colony
					}
				}
				random_owned_planet = {
					limit = {
						has_planet_flag = human_fallen_empires_varelse_colony
						has_observation_outpost = yes
					}
					planet_event = {
						id = human_fallen_empires.101
						days = 1
						random = 700
					}
				}
			}
		}
		# copernicus observation event
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_has_event.362
				}
			}
			random_country = {
				limit = {
					is_country_type = primitive
					any_owned_planet = {
						has_planet_flag = human_fallen_empires_copernicus.0
					}
				}
				random_owned_planet = {
					limit = {
						has_planet_flag = human_fallen_empires_copernicus.0
						has_observation_outpost = yes
						not = {
							has_planet_flag = human_fallen_empires_has_event.362
						}
					}
					planet_event = {
						id = human_fallen_empires.361
						days = 1
						random = 700
					}
				}
			}
		}
		random_playable_country = {
			limit = {
				is_country_type = default
				not = {
					has_authority = auth_machine_intelligence
				}
			}
			random_list = {
				10 = {
				}
				10 = {
					country_event = {
						id = human_fallen_empires_plague.160
						days = 1
						random = 700
					}
				}
			}
		}
		# fallen empire drain recurses from vassals
		# need to test
		if = {
			limit = {
				has_global_flag = human_fallen_empires_war_in_heaven_started
			}
			random_country = {
				limit = {
					is_country_type = awakened_fallen_empire
					is_at_war = yes
					is_war_leader = yes
					is_overlord = yes
					any_war = {
						or = {
							and = {
								any_defender = {
									is_country = prevprev
								}
								defender_war_exhaustion > 20
							}
							and = {
								any_attacker = {
									is_country = prevprev
								}
								attacker_war_exhaustion > 20
							}
						}
					}
				}
				every_subject = {
					country_event = {
						id = human_fallen_empires_total_war.50
						days = 1
						random = 700
					}
				}
			}
		}
	}
}

# functional events for decade pulse
event = {
	id = human_fallen_empires.3
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# planet decay feature
		if = {
			limit = {
				mid_game_years_passed > 0
				not = {
					has_global_flag = human_fallen_empires_disable_planet_decay
				}
			}
			every_playable_country = {
				every_owned_planet = {
					planet_event = {
						id = human_fallen_empires_decay.0
						days = 1
						random = 3600
					}
				}
				every_controlled_planet = {
					planet_event = {
						id = human_fallen_empires_decay.5
						days = 1
						random = 3600
					}
				}
			}
		}
		# kad republic buy robots dialog
		if = {
			limit = {
				not = {
					has_global_flag = human_fallen_empires_future_take_robot
				}
				exists = event_target:human_fallen_empires_future_country
				event_target:human_fallen_empires_future_country = {
					any_owned_planet = {
						free_pop_tiles > 0
					}
				}
				any_country = {
					is_ai = no
					any_owned_pop = {
						has_trait = trait_mechanical
					}
					not = {
						has_country_flag = human_fallen_empires_future_try_take_robot
					}
					event_target:human_fallen_empires_future_country = {
						has_communications = prev
					}
				}
			}
			random_list = {
				2 = {
				}
				1 = {
					random_country = {
						limit = {
							is_ai = no
							any_owned_pop = {
								has_trait = trait_mechanical
							}
							not = {
								has_country_flag = human_fallen_empires_future_try_take_robot
							}
						}
						country_event = {
							id = human_fallen_empires.5100
							days = 1
							random = 3600
						}
					}
				}
			}
		}
		# future is in expansion
		if = {
			limit = {
				exists = event_target:human_fallen_empires_future_country
			}
			event_target:human_fallen_empires_future_country = {
				country_event = {
					id = human_fallen_empires.5010
					days = 1
					random = 3600
				}
			}
		}
		# egypt is in expansion
		if = {
			limit = {
				exists = event_target:human_fallen_empires_egypt_country
			}
			event_target:human_fallen_empires_egypt_country = {
				country_event = {
					id = human_fallen_empires.48
					days = 1
					random = 3600
				}
			}
		}
		random_country = {
			# plague start
			country_event = {
				id = human_fallen_empires_plague.0
				days = 1
				random = 3600
			}
			# awake fallen
			country_event = {
				id = human_fallen_empires_total_war.1000
				days = 1
				random = 3600
			}
			# war in heavens trigger
			country_event = {
				id = human_fallen_empires_total_war.1010
				days = 1
				random = 3600
			}
			# drone awake
			country_event = {
				id = human_fallen_empires.606
				days = 1
				random = 3600
			}
		}
	}
}

# egypt features 10 - 46
# assimilator policy notification
country_event = {
	id = human_fallen_empires.10
	title = human_fallen_empires.10.name
	desc = human_fallen_empires.10.desc
	picture = GFX_evt_human_fallen_empires_fallen_3
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.10.0
	}
}

# contact with egypt 46 - 47
country_event = {
	id = human_fallen_empires.46
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		from = {
			has_country_flag = human_fallen_empires_egypt
			is_country_type = human_fallen_empire
		}
	}

	immediate = {
		establish_communications = from
		set_country_flag = human_fallen_empires_egypt_contacted
		if = {
			limit = {
				is_ai = no
			}
			set_country_flag = human_fallen_empires.47.step0
			country_event = {
				id = human_fallen_empires.47
			}
		}
	}
}

# meeting dialog egypt
country_event = {
	id = human_fallen_empires.47
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.47.desc.0.0
				has_country_flag = human_fallen_empires.47.step0
			}
			success_text = {
				text = human_fallen_empires.47.desc.0.1
				has_country_flag = human_fallen_empires.47.step0
				has_country_flag = human_fallen_empires_egypt_wormhole
			}
			success_text = {
				text = human_fallen_empires.47.desc.1
				has_country_flag = human_fallen_empires.47.step1
			}
			success_text = {
				text = human_fallen_empires.47.desc.2
				has_country_flag = human_fallen_empires.47.step2
			}
			success_text = {
				text = human_fallen_empires.47.desc.3.0.0.0
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step3_bad_news.0
			}
			success_text = {
				text = human_fallen_empires.47.desc.3.0.0.1
				has_country_flag = human_fallen_empires.47.step3
				has_country_flag = human_fallen_empires.47.step3_bad_news.1
			}
			success_text = {
				text = human_fallen_empires.47.desc.3.0.1
				has_country_flag = human_fallen_empires.47.step3
				or = {
					has_country_flag = human_fallen_empires.47.step3_bad_news.0
					has_country_flag = human_fallen_empires.47.step3_bad_news.1
				}
			}
			success_text = {
				text = human_fallen_empires.47.desc.3.1
				has_country_flag = human_fallen_empires.47.step3
			}
			success_text = {
				text = human_fallen_empires.47.desc.4
				has_country_flag = human_fallen_empires.47.step4
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_country
		room = human_fallen_empires_egypt_room
	}

	# step 0
	option = {
		name = human_fallen_empires.47.0.0
		response_text = human_fallen_empires.47.desc.badend
		trigger = {
			has_country_flag = human_fallen_empires.47.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.2 = yes
		human_fallen_empires_effect_event_47_clear_flags = yes
		event_target:human_fallen_empires_egypt_country = {
			add_opinion_modifier = {
				who = root
				modifier = human_fallen_empires_opinion_egypt_first_contact_bad
			}
		}
	}
	option = {
		name = human_fallen_empires.47.0.1
		trigger = {
			any_relation = {
				has_country_flag = human_fallen_empires_future
			}
			has_country_flag = human_fallen_empires.47.step0
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.0.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step0
			has_country_flag = human_fallen_empires_marked_as_human
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.0.3
		trigger = {
			has_country_flag = human_fallen_empires.47.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.0.4
		trigger = {
			has_country_flag = human_fallen_empires.47.step0
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.2 = yes
		human_fallen_empires_effect_event_47_next = yes
		# добавить плюс к отношениям
	}
	option = {
		name = human_fallen_empires.47.0.5
		response_text = human_fallen_empires.47.desc.badend
		trigger = {
			has_country_flag = human_fallen_empires.47.step0
			is_militarist = yes
			fleet_power > 40000
		}
		human_fallen_empires_effect_militarist_attraction.2 = yes
		human_fallen_empires_effect_event_47_clear_flags = yes
		event_target:human_fallen_empires_egypt_country = {
			add_opinion_modifier = {
				who = root
				modifier = human_fallen_empires_opinion_egypt_first_contact_bad
			}
		}
		# добавить объявление войны
	}
	option = {
		name = human_fallen_empires.47.0.6
		trigger = {
			has_country_flag = human_fallen_empires.47.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			any_relation = {
				or = {
					has_country_flag = human_fallen_empires_future
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	# step 1
	option = {
		name = human_fallen_empires.47.1.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.1.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.1.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.1.3
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.1.4
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.1.5
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.1.6
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.1.7
		trigger = {
			has_country_flag = human_fallen_empires.47.step1
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	# step 2
	option = {
		name = human_fallen_empires.47.2.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			or = {
				has_country_flag = human_1
				and = {
					has_country_flag = human_fallen_empires_marked_as_human
					exists = event_target:human_fallen_empires_earth
					event_target:human_fallen_empires_earth = {
						is_owned_by = root
					}
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			has_country_flag = human_fallen_empires_marked_as_human
			nand = {
				exists = event_target:human_fallen_empires_earth
				event_target:human_fallen_empires_earth = {
					is_surveyed = {
						who = root
						status = yes
					}
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	# Земля уже не та скажет не только ксенофоб
	option = {
		name = human_fallen_empires.47.2.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			has_country_flag = human_fallen_empires_marked_as_human
			exists = event_target:human_fallen_empires_earth
			event_target:human_fallen_empires_earth = {
				is_surveyed = {
					who = root
					status = yes
				}
				not = {
					is_owned_by = root
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.3
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			has_country_flag = human_fallen_empires_marked_as_human
			nor = {
				has_country_flag = human_1
				has_country_flag = human_2
			}
			nand = {
				exists = event_target:human_fallen_empires_earth
				event_target:human_fallen_empires_earth = {
					is_surveyed = {
						who = root
						status = yes
					}
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.4
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			any_relation = {
				is_country_type = default
				has_country_flag = human_fallen_empires_marked_as_human
				exists = event_target:human_fallen_empires_earth
				event_target:human_fallen_empires_earth = {
					is_owned_by = root
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.5
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			nand = {
				exists = event_target:human_fallen_empires_earth
				event_target:human_fallen_empires_earth = {
					is_surveyed = {
						who = root
						status = yes
					}
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.6
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			exists = event_target:human_fallen_empires_earth
			event_target:human_fallen_empires_earth = {
				has_planet_flag = nuked_earth
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step3_bad_news.0
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.7
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			exists = event_target:human_fallen_empires_earth
			event_target:human_fallen_empires_earth = {
				exists = owner
				owner = {
					is_country_type = primitive
				}
				is_surveyed = {
					who = root
					status = yes
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.8
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			or = {
				has_country_flag = human_fallen_empires_marked_as_human
				is_xenophile = yes
			}
			exists = event_target:human_fallen_empires_earth
			event_target:human_fallen_empires_earth = {
				is_surveyed = {
					who = root
					status = no
				}
			}
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
		hidden_effect = {
			begin_event_chain = {
				event_chain = human_fallen_empires_chain_find_sol
				target = root
			}
			# проверить
			event_target:human_fallen_empires_earth.solar_system = {
				save_event_target_as = human_fallen_empires_sol
				set_star_flag = human_fallen_empires_sol_target@root
			}
			create_point_of_interest = {
				id = human_fallen_empires_chain_find_sol.0
				name = sol_1_poi
				desc = human_fallen_empires_chain_find_sol_desc.0
				event_chain = human_fallen_empires_chain_find_sol
				location = event_target:human_fallen_empires_sol
			}
		}
	}
	option = {
		name = human_fallen_empires.47.2.9
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			exists = event_target:human_fallen_empires_earth
			event_target:human_fallen_empires_earth = {
				exists = owner
				nor = {
					is_original_owner = owner
					is_owned_by = root
				}
				# any_owned_pop = {
					# is_species_class = HUM
				# }
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step3_bad_news.1
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.10
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			exists = event_target:human_fallen_empires_earth
			event_target:human_fallen_empires_earth = {
				not = {
					exists = owner
				}
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.47.step3_bad_news.0
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.2.11
		trigger = {
			has_country_flag = human_fallen_empires.47.step2
			exists = event_target:human_fallen_empires_earth
			event_target:human_fallen_empires_earth = {
				is_owned_by = root
				nand = {
					is_original_owner = owner
					root = {
						has_country_flag = human_fallen_empires_marked_as_human
					}
				}
			}
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	#step 3
	option = {
		name = human_fallen_empires.47.3.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.3.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.3.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.3.3
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.3.4
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.3.5
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.3.6
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.3.7
		trigger = {
			has_country_flag = human_fallen_empires.47.step3
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
	}
	#step 4
	option = {
		name = human_fallen_empires.47.4.0
		trigger = {
			has_country_flag = human_fallen_empires.47.step4
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_47_next = yes
		#добавить бонус к счастью
	}
	option = {
		name = human_fallen_empires.47.4.1
		trigger = {
			has_country_flag = human_fallen_empires.47.step4
			has_country_flag = human_fallen_empires_marked_as_human
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	option = {
		name = human_fallen_empires.47.4.2
		trigger = {
			has_country_flag = human_fallen_empires.47.step4
		}
		human_fallen_empires_effect_event_47_next = yes
	}
	#сделать бонусную ветку если хорошие отношения с каким-то мини подарком
}

# awake make egypt default country 48
country_event = {
	id = human_fallen_empires.48
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_egypt_in_expansion
		}
		or = {
			mid_game_years_passed > 50
			end_game_years_passed > 0
		}
		or = {
			has_global_flag = galactic_crisis_happened
			has_global_flag = human_fallen_empires_war_in_heaven_started
			recently_lost_war = yes
			any_country = {
				is_country_type = default
				or = {
					and = {
						is_difficulty > 0
						relative_power = {
							who = root
							category = fleet
							value >= inferior
						}
					}
					relative_power = {
						who = root
						category = fleet
						value >= equivalent
					}
				}
			}
		}
	}

	immediate = {
		# проверить будет ли 2 модификатора
		add_modifier = {
			modifier = human_fallen_empires_navy_size
			days = 3600
		}
		country_add_ethic = ethic_xenophobe
		set_country_type = default
		set_global_flag = human_fallen_empires_egypt_in_expansion
		every_playable_country = {
			establish_communications_no_message = root
			if = {
				limit = {
					is_ai = no
				}
				country_event = {
					id = human_fallen_empires.49
				}
				set_country_flag = human_fallen_empires_egypt_contacted
			}
		}
	}
}

# dialog awake
country_event = {
	id = human_fallen_empires.49
	title = human_fallen_empires.49.name
	desc = human_fallen_empires.49.desc.0
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_country.ruler
		room = human_fallen_empires_egypt_room
	}

	option = {
		name = human_fallen_empires.49.0
		default_hide_option = yes
	}
}

# anomalies and after survey on actions 50 - 100
# wormhole to ju ahet 50
ship_event = {
	id = human_fallen_empires.50
	title = human_fallen_empires.50.name
	desc = human_fallen_empires.50.desc
	picture = GFX_evt_human_fallen_empires_wormhole
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	immediate = {
		from = {
			human_fallen_empires_effect_remove_signal_object_from_this = yes
		}
		event_target:human_fallen_empires_egypt_country.capital_scope = {
			save_event_target_as = human_fallen_empires_ra_home
		}
		owner = {
			set_country_flag = human_fallen_empires_egypt_wormhole
		}
	}

	option = {
		name = human_fallen_empires.50.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		hidden_effect = {
			fleet = {
				set_location = {
					target = event_target:human_fallen_empires_ra_home
					distance = 5
					angle = random
				}
			}
			#	remove_country_flag = human_fallen_empires_egypt_wormhole
		}
	}
}

# varelse fleet in time trap 51-53
# start event
ship_event = {
	id = human_fallen_empires.51
	title = human_fallen_empires.51.name
	desc = human_fallen_empires.51.desc
	picture = GFX_evt_human_fallen_empires_station
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_varelse_fleet_location
	trackable = yes
	is_triggered_only = yes

	trigger = {
		human_fallen_empires_trigger_story_enabled = yes
		not = {
			has_global_flag = human_fallen_empires_has_event.51
		}
		exists = owner
		owner = {
			is_ai = no
		}
		not = {
			exists = solar_system.owner
		}
	}

	immediate = {
		set_global_flag = human_fallen_empires_has_event.51
		create_ambient_object = {
			type = ancient_battlefield_object
			location = solar_system
			#use_3d_location = yes
			# entity_offset_height = {
			# 	min = -0
			# 	max = -25
			# }
		}
		last_created_ambient_object = {
			save_event_target_as = human_fallen_empires_varelse_fleet_location
			human_fallen_empires_effect_create_signal_object = yes
		}
		enable_special_project = {
			name = human_fallen_empires_project_varelse_fleet
			location = event_target:human_fallen_empires_varelse_fleet_location
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires.51.0
		trigger = {
			is_ship_size = science
		}
	}
	option = {
		name = human_fallen_empires.51.1
		trigger = {
			not = {
				is_ship_size = science
			}
		}
	}
}

# project complete
ship_event = {
	id = human_fallen_empires.52
	title = human_fallen_empires.52.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.52.desc.0
				owner = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
			text = human_fallen_empires.52.desc.1
		}
	}
	picture = GFX_evt_human_fallen_empires_wormhole
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_fleet_location = {
			human_fallen_empires_effect_remove_signal_object_from_this = yes
		}
		create_country = {
			name = "Varelse Hegemony"
			type = faction
			species = event_target:human_fallen_empires_varelse_species
			ignore_initial_colony_error = yes
			effect = {
				human_fallen_empires_effect_init_give_tech_t3 = yes
				establish_communications_no_message = root.owner
				set_faction_hostility = {
					set_hostile = no
				}
				create_leader = {
					type = admiral
					species = event_target:human_fallen_empires_varelse_species
					skill = 5
				}
				create_fleet = {
					name = "11th Strike Force"
					settings = {
						can_change_composition = no
						uses_naval_capacity = no
					}
					effect = {
						set_owner = prev
						while = {
							count = 10
							create_ship = {
								random_existing_design = cruiser
							}
						}
						assign_leader = last_created_leader
						while = {
							count = 40
							create_ship = {
								random_existing_design = corvette
							}
						}
						set_location = event_target:human_fallen_empires_varelse_fleet_location
						save_event_target_as = human_fallen_empires_varelse_fleet
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		custom_tooltip = human_fallen_empires.53.0.tooltip
		human_fallen_empires_effect_leader_add_exp_100 = yes
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.53
				}
				set_country_flag = human_fallen_empires.53.0
			}
		}
	}
}

# dialog with fleet
country_event = {
	id = human_fallen_empires.53
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.53.desc.0.0
				has_country_flag = human_fallen_empires.53.0
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.0
				has_country_flag = human_fallen_empires.53.0.0
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.1
				or = {
					has_country_flag = human_fallen_empires.53.0.1
					has_country_flag = human_fallen_empires.53.0.2
				}
			}
			success_text = {
				text = human_fallen_empires.53.desc.1.2
				or = {
					has_country_flag = human_fallen_empires.53.0.3
					has_country_flag = human_fallen_empires.53.0.4
				}
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_varelse_species
		room = human_fallen_empires_varelse_room
	}

	option = {
		name = human_fallen_empires.53.0.0
		trigger = {
			has_country_flag = human_fallen_empires.53.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.0
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.1
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.1
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.2
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.0 = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.2
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.3
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			has_country_flag = human_fallen_empires_egypt_contacted
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.3
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires.53.0.4
		trigger = {
			has_country_flag = human_fallen_empires.53.0
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction.0 = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.53.0
			set_country_flag = human_fallen_empires.53.0.4
			country_event = {
				id = human_fallen_empires.53
			}
		}
	}
	option = {
		name = human_fallen_empires_end_transmission
		default_hide_option = yes
		trigger = {
			or = {
				has_country_flag = human_fallen_empires.53.0.0
				has_country_flag = human_fallen_empires.53.0.1
				has_country_flag = human_fallen_empires.53.0.2
				has_country_flag = human_fallen_empires.53.0.3
				has_country_flag = human_fallen_empires.53.0.4
			}
		}
		hidden_effect = {
			# attack home of light
			if = {
				limit = {
					or = {
						has_country_flag = human_fallen_empires.53.0.0
						has_country_flag = human_fallen_empires.53.0.1
						has_country_flag = human_fallen_empires.53.0.2
					}
				}
				remove_country_flag = human_fallen_empires.53.0.0
				remove_country_flag = human_fallen_empires.53.0.1
				remove_country_flag = human_fallen_empires.53.0.2
				event_target:human_fallen_empires_varelse_fleet = {
					human_fallen_empires_effect_varelse_fleet_attack_home_of_light = yes
				}
			}
			# found new home
			if = {
				limit = {
					or = {
						has_country_flag = human_fallen_empires.53.0.3
						has_country_flag = human_fallen_empires.53.0.4
					}
				}
				remove_country_flag = human_fallen_empires.53.0.3
				remove_country_flag = human_fallen_empires.53.0.4
				event_target:human_fallen_empires_varelse_fleet = {
					human_fallen_empires_effect_varelse_fleet_find_new_home = yes
				}
			}
		}
	}
}

# varelse section 100 - 150
# varelse colony after survey 100
ship_event = {
	id = human_fallen_empires.100
	title = human_fallen_empires.100.name
	desc = human_fallen_empires.100.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	location = root
	is_triggered_only = yes

	trigger = {
		exists = owner
		owner = {
			is_ai = no
		}
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_varelse_colony
		}
		exists = from.owner
		from.owner = {
			is_country_type = primitive
		}
	}

	option = {
		name = human_fallen_empires.100.0
	}
}

# observation outpost events
# varelse mehanicus
# start event
planet_event = {
	id = human_fallen_empires.101
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_observation_outpost = yes
	}

	immediate = {
		set_global_flag = human_fallen_empires_varelse_mehanicus
		save_event_target_as = human_fallen_empires_varelse_colony
		observation_outpost_owner = {
			country_event = {
				id = human_fallen_empires.102
			}
		}
	}
}

# choice
country_event = {
	id = human_fallen_empires.102
	title = human_fallen_empires.102.name
	desc = human_fallen_empires.102.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	#lets go to artifact
	option = {
		name = human_fallen_empires.102.0
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.103 days = 12 random = 4
			}
		}
		custom_tooltip = human_fallen_empires.102.0.tooltip
	}
	# lets go to factory
	option = {
		name = human_fallen_empires.102.1
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.105 days = 10 random = 5
			}
		}
		custom_tooltip = human_fallen_empires.102.1.tooltip
	}
	# lets revolt (materialist)
	option = {
		name = human_fallen_empires.102.2
		trigger = {
			is_materialist = yes
		}
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.107 days = 100 random = 20
			}
		}
	}
	# lets infiltrat
	option = {
		name = human_fallen_empires.102.3
		trigger = {
			from = {
				observation_outpost = {
					has_mission = covert_infiltration
				}
			}
		}
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.108 days = 10 random = 20
			}
		}
	}
	option = {
		name = human_fallen_empires.102.4
	}
}

# lets go to artifact
country_event = {
	id = human_fallen_empires.103
	title = human_fallen_empires.103.name
	desc = human_fallen_empires.103.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	option = {
		name = human_fallen_empires_at_the_sreen
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.104
			}
		}
	}
}

# history of varelse
country_event = {
	id = human_fallen_empires.104
	title = human_fallen_empires.104.name
	desc = human_fallen_empires.104.desc
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		room = human_fallen_empires_varelse_room
	}

	option = {
		name = human_fallen_empires.104.0
		response_text = human_fallen_empires.104.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.104.1
		response_text = human_fallen_empires.104.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.104.2
		response_text = human_fallen_empires.104.2.response
		default_hide_option = yes
		human_fallen_empires_effect_add_physics_research.2 = yes
	}
}

# lets go to factory
country_event = {
	id = human_fallen_empires.105
	title = human_fallen_empires.105.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.105.desc.0
				is_xenophobe = no
			}
			success_text = {
				text = human_fallen_empires.105.desc.1
				is_xenophobe = yes
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_cityscape
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				is_xenophobe = yes
			}
			event_target:human_fallen_empires_varelse_colony = {
				owner = {
					human_fallen_empires_effect_primitive_down = yes
				}
				every_tile = {
					limit = {
						has_building = yes
					}
					set_ruined = yes
				}
				random_pop = {
					kill_pop = yes
				}
				random_pop = {
					kill_pop = yes
				}
			}
		}
	}

	option = {
		name = human_fallen_empires_good_job
		trigger = {
			is_xenophobe = no
		}
		human_fallen_empires_effect_add_engineering_research.2 = yes
	}
	option = {
		name = human_fallen_empires.105.1
		trigger = {
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.2 = yes
		human_fallen_empires_effect_add_engineering_research.2 = yes
		human_fallen_empires_effect_add_society_research.1 = yes
	}
}

# materialist result lets revolt
country_event = {
	id = human_fallen_empires.107
	title = human_fallen_empires.107.name
	desc = human_fallen_empires.107.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_planetary_riot
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_colony = {
			owner = {
				country_remove_ethic = ethic_spiritualist
				country_add_ethic = ethic_materialist
				human_fallen_empires_effect_primitive_up = yes
			}
		}
	}

	option = {
		name = human_fallen_empires.107.0
		trigger = {
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.2 = yes
		human_fallen_empires_effect_add_society_research.3 = yes
	}
}

# lets infiltrate
country_event = {
	id = human_fallen_empires.108
	title = human_fallen_empires.108.name
	desc = human_fallen_empires.108.desc
	picture = GFX_evt_human_fallen_empires_varelse_planet
	show_sound = event_primitive_civilization
	location = event_target:human_fallen_empires_varelse_colony
	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_varelse_colony = {
			observation_outpost = {
				add_mission_progress = 0.5
			}
		}
	}

	option = {
		name = human_fallen_empires_good_job
	}
}

# memorial section 150 - 350
# pyramid events 150 - 200
# start
planet_event = {
	id = human_fallen_empires.150
	title = human_fallen_empires.150.name
	desc = human_fallen_empires.150.desc
	picture = GFX_evt_human_fallen_empires_temple
	show_sound = event_mystic_reveal
	location = root
	trackable = yes
	is_triggered_only = yes

	trigger = {
		is_planet_class = human_fallen_empires_pc_memorial
		exists = owner
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_planet_pyramid
	}

	option = {
		name = human_fallen_empires.150.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_project_pyramid
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_project_pyramid
			location = root
			owner = root.owner
		}
	}
	option = {
		name = human_fallen_empires_not_interested
	}
}

# golocube
ship_event = {
	id = human_fallen_empires.151
	title = human_fallen_empires.151.name
	desc = human_fallen_empires.151.desc
	picture = GFX_evt_human_fallen_empires_temple
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	option = {
		name = human_fallen_empires.151.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.152
				}
				set_country_flag = human_fallen_empires_has_event.151
			}
		}
	}
}

# memorial story
country_event = {
	id = human_fallen_empires.152
	title = human_fallen_empires.152.name
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				human_fallen_empires.152.0 = {
					text = human_fallen_empires.152.desc.1
				}
				default = {
					text = human_fallen_empires.152.desc.0
				}
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_memorial_story_room
	}

	option = {
		name = human_fallen_empires.152.0
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.152.0
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.152.0
			country_event = {
				id = human_fallen_empires.152
			}
		}
	}
	option = {
		name = human_fallen_empires.152.1
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		default_hide_option = yes
		hidden_effect = {
			create_leader = {
				type = governor
				species = event_target:human_fallen_empires_egypt_species
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
				event_leader = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.152.2
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = scientist
				species = event_target:human_fallen_empires_egypt_species
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
				event_leader = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.152.3
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = admiral
				species = event_target:human_fallen_empires_egypt_species
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
				event_leader = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.152.4
		trigger = {
			has_country_flag = human_fallen_empires.152.0
		}
		hidden_effect = {
			create_leader = {
				type = general
				species = event_target:human_fallen_empires_egypt_species
				leader_age_min = 50
				leader_age_max = 650
				skill = 5
				event_leader = yes
			}
		}
	}
	#	option = {
	#		name = human_fallen_empires.152.5
	#		trigger = {
	#			has_country_flag = human_fallen_empires.152.0
	#		}
	#		hidden_effect = {
	#		# добавить технологию
	#		}
	#	}

	after = {
		hidden_effect = {
			remove_country_flag = human_fallen_empires.152
		}
	}
}

# obelisk
ship_event = {
	id = human_fallen_empires.153
	title = human_fallen_empires.153.name
	desc = human_fallen_empires.153.desc
	picture = GFX_evt_human_fallen_empires_obelisk
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.153
		}
		# need to rewrite it
		event_target:human_fallen_empires_memorial_planet = {
			create_country = {
				name = Gnosis
				type = faction
				species = root.owner
				effect = {
					establish_communications_no_message = root.owner
				}
			}
			create_species = {
				name = Gnosis
				class = random_non_machine
			}
			# запилить новый тип армии
			create_army = {
				name = Gnosis
				owner = last_created_country
				species = owner
				type = titanic_guardian_army
			}
			create_army = {
				name = Gnosis
				owner = last_created_country
				species = owner
				type = titanic_assault_army
			}
			create_army = {
				name = Gnosis
				owner = last_created_country
				species = owner
				type = titanic_assault_army
			}
		}
	}

	option = {
		name = human_fallen_empires.153.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
	}
}

# mutant cloud
ship_event = {
	id = human_fallen_empires.154
	title = human_fallen_empires.154.name
	desc = human_fallen_empires.154.desc
	picture = GFX_evt_human_fallen_empires_city_cloud
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.154
		}
		event_target:human_fallen_empires_memorial_planet = {
			planet_event = {
				id = human_fallen_empires.155
				days = 15
			}
		}
	}

	option = {
		name = human_fallen_empires.155.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
	}
}

# lets mutate
planet_event = {
	id = human_fallen_empires.155
	title = human_fallen_empires.154.name
	desc = human_fallen_empires.155.desc
	picture = GFX_evt_human_fallen_empires_city_cloud
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		every_owned_pop = {
			limit = {
				#is_robot_pop = no
			}
			modify_species = {
		 		add_trait = human_fallen_empires_species_trait_test
		 	}
		}
		random_owned_pop = {
			limit = {
				has_trait = human_fallen_empires_species_trait_test
			}
			species = {
				mutate_species = yes
			}
		}
		every_owned_pop = {
			limit = {
				has_trait = human_fallen_empires_species_trait_test
			}
			modify_species = {
		 		remove_trait = human_fallen_empires_species_trait_test
		 	}
		}
	}

	option = {
		name = human_fallen_empires.155.0
		custom_tooltip = human_fallen_empires.155.tooltip
	}
}

# tomb
ship_event = {
	id = human_fallen_empires.156
	title = human_fallen_empires.156.name
	desc = human_fallen_empires.156.desc
	picture = GFX_evt_human_fallen_empires_strange_tech
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.156
		}
	}

	option = {
		name = human_fallen_empires.156.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		hidden_effect = {
			owner = {
				human_fallen_empires_effect_media_random = yes
			}
		}
	}
}

# military warehouse events 200 - 250
# start
planet_event = {
	id = human_fallen_empires.200
	title = human_fallen_empires.200.name
	desc = human_fallen_empires.200.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_mystic_reveal
	location = root
	trackable = yes
	is_triggered_only = yes

	trigger = {
		is_planet_class = human_fallen_empires_pc_memorial
		exists = owner
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_military_warehouse_planet
	}

	option = {
		name = human_fallen_empires.200.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_project_military_warehouse
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_project_military_warehouse
			location = root
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires_not_interested
	}
}

# defense system
ship_event = {
	id = human_fallen_empires.201
	title = human_fallen_empires.201.name
	desc = human_fallen_empires.201.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.201
		}
	}

	option = {
		name = human_fallen_empires.201.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_army_planet_defense_damage_mult
			}
		}
	}
}

# abandoned armory
ship_event = {
	id = human_fallen_empires.202
	title = human_fallen_empires.202.name
	desc = human_fallen_empires.202.desc
	picture = GFX_evt_engineering_research
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.202
		}
	}

	option = {
		name = human_fallen_empires.202.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			add_modifier = {
				modifier = human_fallen_empires_army_attack_damage_mult
			}
		}
	}
}

# abandoned librariy
ship_event = {
	id = human_fallen_empires.203
	title = human_fallen_empires.203.name
	desc = human_fallen_empires.203.desc
	picture = GFX_evt_human_fallen_empires_library_old
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.203
		}
	}

	option = {
		name = human_fallen_empires.203.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			add_modifier = {
				modifier = human_fallen_empires_army_defense_damage_mult
			}
		}
	}
}

# abandoned military academy
ship_event = {
	id = human_fallen_empires.204
	title = human_fallen_empires.204.name
	desc = human_fallen_empires.204.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.204
		}
	}

	option = {
		name = human_fallen_empires.204.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_army_academy
			}
		}
	}
}

# explosion of the warehouse
country_event = {
	id = human_fallen_empires.205
	title = human_fallen_empires.205.name
	desc = {
		trigger = {
			# scientist survived
			success_text = {
				text = human_fallen_empires.205.desc.0
				has_country_flag = human_fallen_empires_random_0
			}
			# scientist dead
			success_text = {
				text = human_fallen_empires.205.desc.1
				has_country_flag = human_fallen_empires_random_1
			}
			# scientist wounded
			success_text = {
				text = human_fallen_empires.205.desc.2
				has_country_flag = human_fallen_empires_random_2
			}
			# scientist recovered
			success_text = {
				text = human_fallen_empires.205.desc.3
				nor = {
					has_country_flag = human_fallen_empires_random_0
					has_country_flag = human_fallen_empires_random_1
					has_country_flag = human_fallen_empires_random_2
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_explosion
	show_sound = event_ship_explosion
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	immediate = {
		set_country_flag = human_fallen_empires_has_event.205
	}

	option = {
		name = human_fallen_empires.205.0
		exclusive_trigger = {
			has_country_flag = human_fallen_empires_random_0
		}
	}
	option = {
		name = human_fallen_empires.205.1
		exclusive_trigger = {
			has_country_flag = human_fallen_empires_random_1
		}
		hidden_effect = {
			event_target:human_fallen_empires_ship = {
				fleet = {
					kill_leader = {
						type = scientist
						show_notification = no
					}
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.205.2
		exclusive_trigger = {
			has_country_flag = human_fallen_empires_random_2
		}
		hidden_effect = {
			event_target:human_fallen_empires_ship = {
				fleet = {
					exile_leader_as = human_fallen_empires_scientist_wounded
				}
			}
			country_event = {
				id = human_fallen_empires.205
				days = 60
				random = 120
			}
		}
	}
	option = {
		name = human_fallen_empires.205.3
		hidden_effect = {
			if = {
				limit = {
					exists = event_target:human_fallen_empires_ship
					event_target:human_fallen_empires_ship = {
						not = {
							exists = leader
						}
					}
				}
				event_target:human_fallen_empires_ship = {
					fleet = {
						set_leader = human_fallen_empires_scientist_wounded
						leader = {
							save_event_target_as = human_fallen_empires_205_scientist
						}
					}
				}
			}
			else = {
				create_fleet = {
					effect = {
						set_owner = root
						create_ship = {
							random_existing_design = science
						}
						set_location = root.capital_scope
						set_leader = human_fallen_empires_scientist_wounded
						leader = {
							save_event_target_as = human_fallen_empires_205_scientist
							unassign_leader = this
						}
						delete_fleet = this
					}
				}
			}
		}
		event_target:human_fallen_empires_205_scientist = {
			add_trait = leader_trait_resilient
		}
	}
}

# scientific bonus of the warehouse
ship_event = {
	id = human_fallen_empires.206
	title = human_fallen_empires.206.name
	desc = human_fallen_empires.206.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.206
		}
	}

	option = {
		name = human_fallen_empires.206.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			human_fallen_empires_effect_add_engineering_research.3 = yes
		}
	}
}

# dr moro
ship_event = {
	id = human_fallen_empires.207
	title = human_fallen_empires.207.name
	desc = human_fallen_empires.207.desc
	picture = GFX_evt_human_fallen_empires_weapon_storage
	show_sound = event_alien_nature
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.207
		}
	}

	option = {
		name = human_fallen_empires.207.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			human_fallen_empires_effect_media_negative = yes
		}
	}
}

# found cruiser 250 - 300
# start
planet_event = {
	id = human_fallen_empires.250
	title = human_fallen_empires.250.name
	desc = human_fallen_empires.250.desc
	picture = GFX_evt_human_fallen_empires_ship_old
	show_sound = event_mystic_reveal
	location = root
	trackable = yes
	is_triggered_only = yes

	trigger = {
		is_planet_class = human_fallen_empires_pc_memorial
		exists = owner
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_found_cruiser_planet
	}

	option = {
		name = human_fallen_empires.250.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_project_found_cruiser_planet
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_project_found_cruiser
			location = root
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires_not_interested
	}
}

# rotten skeleton
ship_event = {
	id = human_fallen_empires.251
	title = human_fallen_empires.251.name
	desc = human_fallen_empires.251.desc
	picture = GFX_evt_human_fallen_empires_ship_old
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.251
		}
	}

	option = {
		name = human_fallen_empires.251.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			human_fallen_empires_effect_add_minerals.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.251.1
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			human_fallen_empires_effect_add_energy.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.251.2
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			human_fallen_empires_effect_add_physics_research.2 = yes
		}
	}
}

# explosion on the cruiser scientist dead
ship_event = {
	id = human_fallen_empires.252
	title = human_fallen_empires.252.name
	desc = human_fallen_empires.252.desc
	picture = GFX_evt_archaeological_dig
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.252
		}
	}

	option = {
		name = human_fallen_empires.252.0
		hidden_effect = {
			kill_leader = {
				type = scientist
				show_notification = no
			}
		}
	}
}

# runaway cruiser
ship_event = {
	id = human_fallen_empires.253
	title = human_fallen_empires.253.name
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.253.desc.0
				owner = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
			success_text = {
				text = human_fallen_empires.253.desc.1
				owner = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_ship
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.253
		}
		create_country = {
			name = "Cruiser"
			type = neutral_faction
			species = root.owner
			effect = {
				establish_communications_no_message = root.owner
				#		set_faction_hostility = {
				#			set_hostile = no
				#		}
				create_fleet = {
					name = "Cruiser"
					effect = {
						#save_event_target_as = human_fallen_empires_cruiser # убрать, если работает owner
						set_owner = event_target:human_fallen_empires_egypt_country
						create_ship = {
							random_existing_design = titan
							prefix = no
						}
						set_owner = prev
						set_location = root
						set_fleet_stance = aggressive
						queue_actions = {
							find_closest_system = {
								trigger = {
									id = human_fallen_empires.253.trigger.0
									any_planet = {
										has_planet_flag = human_fallen_empires_varelse_colony
									}
								}
								found_system = {
									move_to = this
								}
							}
							find_closest_planet = {
								trigger = {
									id = human_fallen_empires.253.trigger.1
									has_planet_flag = human_fallen_empires_varelse_colony
								}
								found_planet = {
									orbit_planet = this
									effect = {
										id = human_fallen_empires.253.effect.0
										# need test it
										prev.owner = {
											set_faction_hostility = {
												set_hostile = yes
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.253.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
	}
}

# cruiser became aggressive
ship_event = {
	id = human_fallen_empires.254
	title = human_fallen_empires.254.name
	desc = human_fallen_empires.254.desc
	picture = GFX_evt_human_fallen_empires_ship
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.254
		}
		create_country = {
			name = "Mad Cruiser"
			type = human_fallen_empires_berserk
			species = root.owner
			effect = {
				every_country = {
					establish_communications_no_message = prev
				}
				create_fleet = {
					name = "Mad Cruiser"
					effect = {
						set_owner = event_target:human_fallen_empires_egypt_country
						create_ship = {
							random_existing_design = titan
							prefix = no
						}
						set_owner = prev
						set_fleet_stance = aggressive
						set_location = root
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.254.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
	}
}

# love is
ship_event = {
	id = human_fallen_empires.255
	title = human_fallen_empires.255.name
	desc = human_fallen_empires.255.desc
	picture = GFX_evt_human_fallen_empires_ship_new
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.255
		}
		create_fleet = {
			name = "Marvin"
			effect = {
				set_owner = event_target:human_fallen_empires_egypt_country
				create_ship = {
					name = "Marvin"
					random_existing_design = titan
				}
				set_owner = root.owner
				set_location = root
				set_fleet_stance = aggressive
			}
		}
	}

	option = {
		name = human_fallen_empires.255.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
	}
}


# sputnik 300 - 350
# start
planet_event = {
	id = human_fallen_empires.300
	title = human_fallen_empires.300.name
	desc = human_fallen_empires.300.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_mystic_reveal
	location = root
	trackable = yes
	is_triggered_only = yes

	trigger = {
		is_planet_class = human_fallen_empires_pc_memorial
		exists = owner
		owner = {
			nand = {
				has_country_flag = human_fallen_empires_has_event.301
				has_country_flag = human_fallen_empires_has_event.302
				has_country_flag = human_fallen_empires_has_event.304
			}
		}
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		set_planet_flag = human_fallen_empires_sputnik_planet
	}

	option = {
		name = human_fallen_empires.300.0
		hidden_effect = {
			set_planet_flag = human_fallen_empires_project_sputnik
			save_event_target_as = human_fallen_empires_memorial_planet
		}
		enable_special_project = {
			name = human_fallen_empires_project_sputnik
			location = root
			owner = root.owner
		}
	}

	option = {
		name = human_fallen_empires_not_interested
	}
}

# bonus to the sensors
ship_event = {
	id = human_fallen_empires.301
	title = human_fallen_empires.301.name
	desc = human_fallen_empires.301.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.301
		}
	}

	option = {
		name = human_fallen_empires.301.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		event_target:human_fallen_empires_memorial_planet = {
			add_modifier = {
				modifier = human_fallen_empires_planet_sensor_range_mult
			}
		}
	}
}

# go to another events
ship_event = {
	id = human_fallen_empires.302
	title = human_fallen_empires.302.name
	desc = human_fallen_empires.302.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.302
		}
	}

	option = {
		name = human_fallen_empires.302.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		hidden_effect = {
			event_target:human_fallen_empires_memorial_planet = {
				random_list = {
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_planet_pyramid
						}
						planet_event = {
							id = human_fallen_empires.150
							days = 1
							random = 10
						}
					}
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_military_warehouse_planet
						}
						planet_event = {
							id = human_fallen_empires.200
							days = 1
							random = 10
						}
					}
					33 = {
						modifier = {
							factor = 0
							has_planet_flag = human_fallen_empires_found_cruiser_planet
						}
						planet_event = {
							id = human_fallen_empires.250
							days = 1
							random = 10
						}
					}
					1 = {
						root = {
							ship_event = {
								id = human_fallen_empires.303
								days = 15
								random = 10
							}
						}
					}
				}
			}
		}
	}
	option = {
		name = human_fallen_empires.302.1
	}
}

# go to nothing
ship_event = {
	id = human_fallen_empires.303
	title = human_fallen_empires.303.name
	desc = human_fallen_empires.303.desc
	picture = GFX_evt_human_fallen_empires_satellite_2
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	option = {
		name = human_fallen_empires.303.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			human_fallen_empires_effect_add_engineering_research.1 = yes
		}
	}
}

# engineering bonus
ship_event = {
	id = human_fallen_empires.304
	title = human_fallen_empires.304.name
	desc = human_fallen_empires.304.desc
	picture = GFX_evt_human_fallen_empires_satellite
	show_sound = event_airlock
	location = event_target:human_fallen_empires_memorial_planet
	is_triggered_only = yes

	trigger = {
		exists = owner
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_has_event.304
		}
	}

	option = {
		name = human_fallen_empires.304.0
		human_fallen_empires_effect_leader_add_exp_100 = yes
		owner = {
			human_fallen_empires_effect_add_engineering_research.3 = yes
		}
	}
}

# find sol 350
fleet_event = {
	id = human_fallen_empires.350
	title = human_fallen_empires.350.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.350.desc.0.0
				owner = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			fail_text = {
				text = human_fallen_empires.350.desc.0.1
				owner = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			success_text = {
				text = human_fallen_empires.350.desc.1.0
				exists = event_target:human_fallen_empires_earth
				event_target:human_fallen_empires_earth = {
					not = {
						is_planet_class = pc_nuked
					}
					or = {
						not = {
							exists = owner
						}
						owner = {
							is_country_type = primitive
						}
					}
				}
			}
			success_text = {
				text = human_fallen_empires.350.desc.1.1
				exists = event_target:human_fallen_empires_earth
				event_target:human_fallen_empires_earth = {
					is_planet_class = pc_nuked
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_sol_system
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_star_flag = human_fallen_empires_sol_target@root.owner
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_find_sol
		}
	}

	immediate = {
		from = {
			remove_star_flag = human_fallen_empires_sol_target@root.owner
		}
		owner = {
			end_event_chain = human_fallen_empires_chain_find_sol
		}
	}

	option = {
		name = human_fallen_empires.350.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			from = {
				not = {
					has_star_flag = nuked_sol
				}
			}
		}
		owner = {
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.350.1
		trigger = {
			from = {
				has_star_flag = nuked_sol
			}
		}
		owner = {
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.350.1
		trigger = {
			owner = {
				is_xenophile = yes
				is_authoritarian = no
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			from = {
				not = {
					has_star_flag = nuked_sol
				}
			}
		}
		owner = {
			human_fallen_empires_effect_xenophile_attraction.0 = yes
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
	option = {
		name = human_fallen_empires.350.2
		trigger = {
			owner = {
				is_xenophile = yes
				is_authoritarian = yes
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
			}
			from = {
				not = {
					has_star_flag = nuked_sol
				}
			}
		}
		owner = {
			human_fallen_empires_effect_xenophile_attraction.0 = yes
			human_fallen_empires_effect_authoritarian_attraction.0 = yes
			human_fallen_empires_effect_add_influence.2 = yes
		}
	}
}

# abort chain if contacted with sol owner 351
country_event = {
	id = human_fallen_empires.351
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_event_chain = human_fallen_empires_chain_find_sol
		exists = from
		from = {
			or = {
				has_country_flag = human_1
				event_target:human_fallen_empires_earth = {
					is_owned_by = prev
				}
			}
		}
	}

	immediate = {
		end_event_chain = human_fallen_empires_chain_find_sol
		random_system = {
			limit = {
				has_star_flag = human_fallen_empires_sol_target@root
			}
			remove_star_flag = human_fallen_empires_sol_target@root
		}
	}
}

# copernicus event 355 - 365
# enter system
# в теории планета может быть исследована при отсутствии хозяина системы
ship_event = {
	id = human_fallen_empires.355
	title = human_fallen_empires.355.name
	desc = {
		trigger = {
			text = human_fallen_empires.355.desc.0
			fail_text = {
				text = human_fallen_empires.355.desc.1.0
				exists = event_target:human_fallen_empires_copernicus_owner
			}
			success_text = {
				text = human_fallen_empires.355.desc.1.1
				exists = event_target:human_fallen_empires_copernicus_owner
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_star_flag = human_fallen_empires_copernicus
		}
		exists = owner
		owner = {
			or = {
				is_ai = no
				is_country_type = default
			}
		}
	}

	immediate = {
		from = {
			save_global_event_target_as = human_fallen_empires_copernicus
			random_system_planet = {
				limit = {
					has_planet_flag = human_fallen_empires_copernicus.0
				}
				if = {
					limit = {
						is_surveyed = {
							who = root.owner
							status = yes
						}
					}
					if = {
						limit = {
							exists = solar_system.owner
						}
						solar_system.owner = {
							save_event_target_as = human_fallen_empires_copernicus_owner
						}
					}
				}
				else = {
					begin_event_chain = {
						event_chain = human_fallen_empires_chain_copernicus
						target = root.owner
					}
					if = {
						limit = {
							owner = {
								is_country_type = primitive
							}
						}
						owner = {
							species = {
								save_global_event_target_as = human_fallen_empires_copernicus_species
							}
						}
						root.owner = {
							set_country_flag = human_fallen_empires_copernicus_has_primitive
						}
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.355.0
		trigger = {
			owner = {
				has_event_chain = human_fallen_empires_chain_copernicus
			}
		}
		tooltip = {
			begin_event_chain = {
				event_chain = human_fallen_empires_chain_copernicus
				target = root.owner
			}
		}
	}
	option = {
		name = human_fallen_empires.355.1
		trigger = {
			owner = {
				not = {
					has_event_chain = human_fallen_empires_chain_copernicus
				}
			}
		}
		tooltip = {
			owner = {
				end_event_chain = human_fallen_empires_chain_copernicus
			}
		}
	}
}

# scan planet
ship_event = {
	id = human_fallen_empires.356
	title = human_fallen_empires.356.name
	desc = {
		trigger = {
			text = human_fallen_empires.356.desc.0
			success_text = {
				text = human_fallen_empires.356.desc.1
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_primitive
				}
			}
			success_text = {
				text = human_fallen_empires.356.desc.2
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_primitive
					has_completed_event_chain_counter = {
						event_chain = human_fallen_empires_chain_copernicus
						counter = human_fallen_empires_scans
					}
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_copernicus.0
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_copernicus
		}
	}

	immediate = {
		owner = {
			add_event_chain_counter = {
				event_chain = human_fallen_empires_chain_copernicus
				counter = human_fallen_empires_scans
				amount = 1
			}
		}
	}

	option = {
		name = INTERESTING
		hidden_effect = {
			owner = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = human_fallen_empires_chain_copernicus
							counter = human_fallen_empires_scans
						}
					}
					country_event = {
						id = human_fallen_empires.359
						days = 5
					}
				}
			}
		}
	}
}

# scan asteroid
ship_event = {
	id = human_fallen_empires.357
	title = human_fallen_empires.357.name
	desc = {
		trigger = {
			text = human_fallen_empires.357.desc.0
			success_text = {
				text = human_fallen_empires.357.desc.1
				owner = {
					has_country_flag = human_fallen_empires_copernicus_has_primitive
					has_completed_event_chain_counter = {
						event_chain = human_fallen_empires_chain_copernicus
						counter = human_fallen_empires_scans
					}
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_copernicus.1
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_copernicus
		}
	}

	immediate = {
		owner = {
			add_event_chain_counter = {
				event_chain = human_fallen_empires_chain_copernicus
				counter = human_fallen_empires_scans
				amount = 1
			}
		}
	}

	option = {
		name = CURIOUS
		hidden_effect = {
			owner = {
				remove_country_flag = human_fallen_empires_has_event.356
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = human_fallen_empires_chain_copernicus
							counter = human_fallen_empires_scans
						}
					}
					country_event = {
						id = human_fallen_empires.359
						days = 5
					}
				}
			}
		}
	}
}

# scan star
ship_event = {
	id = human_fallen_empires.358
	title = human_fallen_empires.358.name
	desc = human_fallen_empires.358.desc
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			has_planet_flag = human_fallen_empires_copernicus.2
		}
		exists = owner
		owner = {
			has_event_chain = human_fallen_empires_chain_copernicus
		}
	}

	option = {
		name = ASTOUNDING
	}
}

# start project
country_event = {
	id = human_fallen_empires.359
	title = human_fallen_empires.359.name
	desc = human_fallen_empires.359.desc
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	trackable = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_special_project = human_fallen_empires_project_copernicus
		}
	}

	immediate = {
		enable_special_project = {
			name = human_fallen_empires_project_copernicus
			location = root.capital_scope
			owner = root
		}
	}


	option = {
		name = human_fallen_empires.359.0
		tooltip = {
			enable_special_project = {
				name = human_fallen_empires_project_copernicus
				location = root.capital_scope
				owner = root
			}
		}
	}
}

# project complete
country_event = {
	id = human_fallen_empires.360
	title = human_fallen_empires.360.name
	desc = {
		trigger = {
			text = human_fallen_empires.360.desc.0
			success_text = {
				text = human_fallen_empires.360.desc.1.0
				has_country_flag = human_fallen_empires_copernicus_has_primitive
			}
			fail_text = {
				text = human_fallen_empires.360.desc.1.1
				has_country_flag = human_fallen_empires_copernicus_has_primitive
			}
			success_text = {
				text = human_fallen_empires.360.desc.2.0
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			fail_text = {
				text = human_fallen_empires.360.desc.2.1
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			success_text = {
				text = human_fallen_empires.360.desc.3.0
				is_xenophile = yes
			}
			success_text = {
				text = human_fallen_empires.360.desc.3.1
				is_xenophobe = yes
			}
			success_text = {
				text = human_fallen_empires.360.desc.4
				has_country_flag = human_fallen_empires_copernicus_has_primitive
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_copernicus
	show_sound = event_scanner
	is_triggered_only = yes

	option = {
		name = AMAZING
		human_fallen_empires_effect_add_influence.2 = yes
		end_event_chain = human_fallen_empires_chain_copernicus
		hidden_effect = {
			remove_country_flag = human_fallen_empires_copernicus_has_primitive
		}
	}
}

# observation outpost event
# start
planet_event = {
	id = human_fallen_empires.361
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_observation_outpost = yes
		observation_outpost = {
			or = {
				has_mission = specimen_collection
				has_mission = passive_observation
				has_mission = technological_enlightenment_1
				has_mission = technological_enlightenment_2
				has_mission = technological_enlightenment_3
				has_mission = technological_enlightenment_4
				has_mission = technological_enlightenment_5
				has_mission = technological_enlightenment_6
				has_mission = technological_enlightenment_7
				has_mission = technological_enlightenment_8
				has_mission = technological_enlightenment_9
			}
		}
		not = {
			has_planet_flag = human_fallen_empires_has_event.362
		}
		observation_outpost_owner = {
			not = {
				has_country_flag = human_fallen_empires_has_event.362
			}
		}
	}

	immediate = {
		observation_outpost_owner = {
			country_event = {
				id = human_fallen_empires.362
			}
		}
	}
}

country_event = {
	id = human_fallen_empires.362
	title = human_fallen_empires.362.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.362.desc.0
				from = {
					observation_outpost = {
						has_mission = passive_observation
					}
				}
			}
			success_text = {
				text = human_fallen_empires.362.desc.1
				from = {
					observation_outpost = {
						has_mission = specimen_collection
					}
				}
			}
			success_text = {
				text = human_fallen_empires.362.desc.2
				from = {
					observation_outpost = {
						or = {
							has_mission = technological_enlightenment_1
							has_mission = technological_enlightenment_2
							has_mission = technological_enlightenment_3
							has_mission = technological_enlightenment_4
							has_mission = technological_enlightenment_5
							has_mission = technological_enlightenment_6
							has_mission = technological_enlightenment_7
							has_mission = technological_enlightenment_8
							has_mission = technological_enlightenment_9
						}
					}
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	is_triggered_only = yes

	immediate = {
		set_country_flag = human_fallen_empires_has_event.362
	}

	# return
	option = {
		name = human_fallen_empires.362.0
		trigger = {
			is_xenophobe = no
			from = {
				observation_outpost = {
					has_mission = passive_observation
				}
			}
		}
		human_fallen_empires_effect_xenophile_attraction.2 = yes
	}
	# use
	option = {
		name = human_fallen_empires.362.1
		trigger = {
			is_xenophile = no
			from = {
				observation_outpost = {
					has_mission = passive_observation
				}
			}
		}
		human_fallen_empires_effect_add_engineering_research.3 = yes
		hidden_effect = {
			from = {
				set_planet_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
	# good job
	option = {
		name = human_fallen_empires_good_job
		trigger = {
			from = {
				observation_outpost = {
					has_mission = specimen_collection
				}
			}
		}
		human_fallen_empires_effect_add_engineering_research.3 = yes
		hidden_effect = {
			from = {
				set_planet_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
	option = {
		name = human_fallen_empires_good_job
		trigger = {
			from = {
				observation_outpost = {
					or = {
						has_mission = technological_enlightenment_1
						has_mission = technological_enlightenment_2
						has_mission = technological_enlightenment_3
						has_mission = technological_enlightenment_4
						has_mission = technological_enlightenment_5
						has_mission = technological_enlightenment_6
						has_mission = technological_enlightenment_7
						has_mission = technological_enlightenment_8
						has_mission = technological_enlightenment_9
					}
				}
			}
		}
		human_fallen_empires_effect_add_engineering_research.3 = yes
		from = {
			observation_outpost = {
				add_mission_progress = 0.5
			}
		}
		hidden_effect = {
			from = {
				set_planet_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
}

# then gain planet
planet_event = {
	id = human_fallen_empires.363
	title = human_fallen_empires.362.name
	desc = human_fallen_empires.363.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	is_triggered_only = yes

	trigger = {
		has_planet_flag = human_fallen_empires_copernicus.0
		not = {
			has_planet_flag = human_fallen_empires_has_event.362
		}
		exists = owner
	}

	immediate = {
		set_planet_flag = human_fallen_empires_has_event.362
	}

	option = {
		name = human_fallen_empires_good_job
		owner = {
			human_fallen_empires_effect_add_engineering_research.3 = yes
			hidden_effect = {
				set_country_flag = human_fallen_empires_has_event.362
				set_global_flag = human_fallen_empires_has_event.362
			}
		}
	}
}

# ahet events section 400 - 401
# ahet colonys after survey
# сolony 1 400
ship_event = {
	id = human_fallen_empires.400
	title = human_fallen_empires.400.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.400.desc.0
				has_country_flag = human_fallen_empires_ahet_found
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			success_text = {
				text = human_fallen_empires.400.desc.1
				has_country_flag = human_fallen_empires_ahet_found
				not = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
			success_text = {
				text = human_fallen_empires.400.desc.2
				not = {
					has_country_flag = human_fallen_empires_ahet_found
				}
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			success_text = {
				text = human_fallen_empires.400.desc.3
				nor = {
					has_country_flag = human_fallen_empires_ahet_found
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
		}
	}
	picture = {
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_random_0
			}
		}
		picture = GFX_evt_human_fallen_empires_ship_old_jungle
	}
	picture = {
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_random_1
			}
		}
		picture = GFX_evt_human_fallen_empires_ship_old_jungle_2
	}
	picture = {
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_random_2
			}
		}
		picture = GFX_evt_human_fallen_empires_ship_old_jungle_3
	}
	location = from
	is_triggered_only = yes

	trigger = {
		exists = owner
		exists = from.owner
		from = {
			has_planet_flag = human_fallen_empires_ahet_colony_0
			owner = {
				is_country_type = primitive
			}
		}
	}

	immediate = {
		owner = {
			human_fallen_empires_effect_random_roll_flags_3_country = yes
		}
	}

	option = {
		name = human_fallen_empires.400.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	option = {
		name = human_fallen_empires.400.1
		trigger = {
			owner = {
				is_materialist = no
			}
		}
	}
	option = {
		name = human_fallen_empires.400.2
		trigger = {
			owner = {
				is_materialist = yes
			}
		}
		owner = {
			human_fallen_empires_effect_materialist_attraction.0 = yes
		}
	}
	after = {
		hidden_effect = {
			owner = {
				set_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
}

# colony 2 401
ship_event = {
	id = human_fallen_empires.401
	title = human_fallen_empires.401.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.401.desc.0
				has_country_flag = human_fallen_empires_ahet_found
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			success_text = {
				text = human_fallen_empires.401.desc.1
				has_country_flag = human_fallen_empires_ahet_found
				not = {
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
			success_text = {
				text = human_fallen_empires.401.desc.2
				not = {
					has_country_flag = human_fallen_empires_ahet_found
				}
				has_country_flag = human_fallen_empires_egypt_contacted
			}
			success_text = {
				text = human_fallen_empires.401.desc.3
				nor = {
					has_country_flag = human_fallen_empires_ahet_found
					has_country_flag = human_fallen_empires_egypt_contacted
				}
			}
		}
	}
	picture = {
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_random_0
			}
		}
		picture = GFX_evt_human_fallen_empires_ship_old_jungle
	}
	picture = {
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_random_1
			}
		}
		picture = GFX_evt_human_fallen_empires_ship_old_jungle_2
	}
	picture = {
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_random_2
			}
		}
		picture = GFX_evt_human_fallen_empires_ship_old_jungle_3
	}
	location = from
	is_triggered_only = yes

	trigger = {
		exists = owner
		exists = from.owner
		from = {
			has_planet_flag = human_fallen_empires_ahet_colony_1
			owner = {
				is_country_type = primitive
			}
		}
	}

	immediate = {
		owner = {
			human_fallen_empires_effect_random_roll_flags_3_country = yes
		}
	}

	option = {
		name = human_fallen_empires.401.0
		trigger = {
			owner = {
				has_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
	option = {
		name = human_fallen_empires.401.1
		trigger = {
			owner = {
				is_xenophile = yes
			}
		}
		owner = {
			human_fallen_empires_effect_xenophile_attraction.0 = yes
		}
	}
	option = {
		name = human_fallen_empires.401.2
		trigger = {
			owner = {
				is_xenophobe = yes
			}
		}
		owner = {
			human_fallen_empires_effect_xenophobe_attraction.0 = yes
		}
	}
	option = {
		name = human_fallen_empires.401.3
		trigger = {
			owner = {
				is_xenophile = no
				is_xenophobe = no
			}
		}
	}
	after = {
		hidden_effect = {
			owner = {
				set_country_flag = human_fallen_empires_ahet_found
			}
		}
	}
}

# ahet home events 410 - 413
# enter system
ship_event = {
	id = human_fallen_empires.410
	title = human_fallen_empires.410.name
	desc = human_fallen_empires.410.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		exists = owner
		from = {
			has_star_flag = human_fallen_empires_ahet_home
		}
		owner = {
			is_ai = no
		}
	}

	immediate = {
		begin_event_chain = {
			event_chain = human_fallen_empires_chain_ahet_home
			target = root.owner
		}
	}

	option = {
		name = human_fallen_empires.410.0
		from = {
			if = {
				limit = {
					any_planet = {
						has_planet_flag = human_fallen_empires_ahet_home
						is_surveyed = {
							who = root.owner
							status = yes
						}
					}
				}
				random_system_planet = {
					limit = {
						has_planet_flag = human_fallen_empires_ahet_home
					}
					save_event_target_as = human_fallen_empires_target_ahet_home
					enable_special_project = {
						name = human_fallen_empires_project_ahet_home
						location = this
						owner = root.owner
					}
				}
			}
		}
	}
}

# explore planet
ship_event = {
	id = human_fallen_empires.411
	title = human_fallen_empires.411.name
	desc = human_fallen_empires.411.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = root
	trackable = yes
	is_triggered_only = yes

	trigger = {
		exists = from
		exists = owner
		from = {
			has_planet_flag = human_fallen_empires_ahet_home
		}
		owner = {
			is_ai = no
		}
	}

	immediate = {
		from = {
			save_event_target_as = human_fallen_empires_target_ahet_home
		}
	}

	option = {
		name = human_fallen_empires.411.0
		enable_special_project = {
			name = human_fallen_empires_project_ahet_home
			location = from
			owner = root.owner
		}
	}
	option = {
		name = human_fallen_empires.411.1
		owner = {
			end_event_chain = human_fallen_empires_chain_ahet_home
		}
	}
}

# project complete remove scientist
ship_event = {
	id = human_fallen_empires.412
	title = human_fallen_empires.412.name
	desc = human_fallen_empires.412.desc
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = root
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.412.0
		hidden_effect = {
			leader = {
				exile_leader_as = human_fallen_empires_412_scientist
			}
			owner = {
				country_event = {
					id = human_fallen_empires.413
					days = 18250
					random = 3600
				}
				#country_event = { id = human_fallen_empires.413 days = 1 }
			}
		}
	}
}

# scientist returns after 50 - 60 years
country_event = {
	id = human_fallen_empires.413
	title = human_fallen_empires.413.name
	desc = {
		trigger = {
			text = human_fallen_empires.413.desc.0
			success_text = {
				text = human_fallen_empires.413.desc.1.0
				or = {
					is_xenophobe = yes
					is_militarist = yes
					human_fallen_empires_trigger_is_authoritarian = yes
				}
			}
			fail_text = {
				text = human_fallen_empires.413.desc.1.1
				or = {
					is_xenophobe = yes
					is_militarist = yes
					human_fallen_empires_trigger_is_authoritarian = yes
				}
			}
			text = human_fallen_empires.413.desc.2
		}
	}
	picture = GFX_evt_human_fallen_empires_black_hole
	show_sound = event_scanner
	location = event_target:human_fallen_empires_target_ahet_home
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.413.0
		hidden_effect = {
			create_fleet = {
				effect = {
					set_owner = root
					create_ship = {
						random_existing_design = science
					}
					set_location = root.capital_scope
					set_leader = human_fallen_empires_412_scientist
					leader = {
						save_event_target_as = human_fallen_empires_413_scientist
						unassign_leader = this
					}
					delete_fleet = this
				}
			}
			event_target:human_fallen_empires_target_ahet_home = {
				set_planet_entity = {
					entity = human_fallen_empires_entity_gaia_red_shield
				}
			}
		}
		event_target:human_fallen_empires_413_scientist = {
			add_trait = leader_trait_maniacal
		}
		if = {
			limit = {
				or = {
					is_xenophobe = yes
					is_militarist = yes
					human_fallen_empires_trigger_is_authoritarian = yes
				}
			}
			human_fallen_empires_effect_xenophobe_attraction.2 = yes
		}
		else = {
			human_fallen_empires_effect_xenophile_attraction.2 = yes
		}
		if = {
			limit = {
				is_materialist = no
				not = {
					has_technology = tech_psionic_theory
				}
			}
			if = {
				limit = {
					has_tech_option = tech_psionic_theory
				}
				add_tech_progress = {
					tech = tech_psionic_theory
					progress = 0.5
				}
			}
			else = {
				add_research_option = tech_psionic_theory
			}
		}
		else_if = {
			limit = {
				is_spiritualist = no
				not = {
					has_technology = tech_sapient_ai
				}
			}
			if = {
				limit = {
					has_tech_option = tech_sapient_ai
				}
				add_tech_progress = {
					tech = tech_sapient_ai
					progress = 0.5
				}
			}
			else = {
				add_research_option = tech_sapient_ai
			}
		}
		else_if = {
			limit = {
				is_spiritualist = no
				not = {
					has_technology = tech_synthetic_workers
				}
			}
			if = {
				limit = {
					has_tech_option = tech_synthetic_workers
				}
				add_tech_progress = {
					tech = tech_synthetic_workers
					progress = 0.5
				}
			}
			else = {
				add_research_option = tech_synthetic_workers
			}
		}
		else_if = {
			limit = {
				not = {
					has_technology = tech_epigenetic_triggers
				}
			}
			if = {
				limit = {
					has_tech_option = tech_epigenetic_triggers
				}
				add_tech_progress = {
					tech = tech_epigenetic_triggers
					progress = 0.5
				}
			}
			else = {
				add_research_option = tech_epigenetic_triggers
			}
		}
		else_if = {
			limit = {
				not = {
					has_technology = tech_gene_tailoring
				}
			}
			if = {
				limit = {
					has_tech_option = tech_gene_tailoring
				}
				add_tech_progress = {
					tech = tech_gene_tailoring
					progress = 0.5
				}
			}
			else = {
				add_research_option = tech_gene_tailoring
			}
		}
		end_event_chain = human_fallen_empires_chain_ahet_home
	}
}

# Ra'ar story (then home of light captured) 500 - 501
# start event
planet_event = {
	id = human_fallen_empires.500
	title = human_fallen_empires.500.name
	desc = human_fallen_empires.500.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = root
	is_triggered_only = yes

	trigger = {
		has_planet_flag = human_fallen_empires_home_of_light
		exists = owner
		owner = {
			is_ai = no
		}
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.501
				}
			}
		}
	}
}

# raar story
country_event = {
	id = human_fallen_empires.501
	title = human_fallen_empires.501.name
	desc = human_fallen_empires.501.desc
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_raar_room
	}

	option = {
		name = human_fallen_empires.501.0
		response_text = human_fallen_empires.501.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.1
		response_text = human_fallen_empires.501.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.2
		response_text = human_fallen_empires.501.2.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.3
		response_text = human_fallen_empires.501.3.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.4
		response_text = human_fallen_empires.501.4.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.5
		response_text = human_fallen_empires.501.5.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.6
		response_text = human_fallen_empires.501.6.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.7
		response_text = human_fallen_empires.501.7.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.8
		response_text = human_fallen_empires.501.8.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.9
		response_text = human_fallen_empires.501.9.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.10
		response_text = human_fallen_empires.501.10.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.11
		response_text = human_fallen_empires.501.11.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.12
		response_text = human_fallen_empires.501.12.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.501.13
		default_hide_option = yes
		custom_tooltip = human_fallen_empires.501.13.tooltip
	}
}

# stargate anomaly 510 - 550
# after anomaly 510
ship_event = {
	id = human_fallen_empires.510
	title = human_fallen_empires.510.name
	desc = {
		trigger = {
			# non hive
			# all
			success_text = {
				text = human_fallen_empires.510.desc.0.0
				owner = {
					human_fallen_empires_trigger_is_hive = no
				}
			}
			# have discovered L gate
			success_text = {
				text = human_fallen_empires.510.desc.0.1.0
				owner = {
					human_fallen_empires_trigger_is_hive = no
					has_seen_any_bypass = lgate
				}
			}
			# have discovered regular gateway
			success_text = {
				text = human_fallen_empires.510.desc.0.1.1
				owner = {
					human_fallen_empires_trigger_is_hive = no
					not = {
						has_seen_any_bypass = lgate
					}
					has_seen_any_bypass = gateway
				}
			}
			# not L gateway and not regular gateway
			success_text = {
				text = human_fallen_empires.510.desc.0.1.2
				owner = {
					human_fallen_empires_trigger_is_hive = no
					nor = {
						has_seen_any_bypass = lgate
						has_seen_any_bypass = gateway
					}
				}
			}
			# all
			success_text = {
				text = human_fallen_empires.510.desc.0.2
				owner = {
					human_fallen_empires_trigger_is_hive = no
				}
			}
			# have discovered L gate
			success_text = {
				text = human_fallen_empires.510.desc.0.3.0
				owner = {
					human_fallen_empires_trigger_is_hive = no
					has_seen_any_bypass = lgate
				}
			}
			# have discovered regular gateway
			success_text = {
				text = human_fallen_empires.510.desc.0.3.1
				owner = {
					human_fallen_empires_trigger_is_hive = no
					not = {
						has_seen_any_bypass = lgate
					}
					has_seen_any_bypass = gateway
				}
			}
			# not L gateway and not regular gateway
			success_text = {
				text = human_fallen_empires.510.desc.0.3.2
				owner = {
					human_fallen_empires_trigger_is_hive = no
					nor = {
						has_seen_any_bypass = lgate
						has_seen_any_bypass = gateway
					}
				}
			}
			# all
			success_text = {
				text = human_fallen_empires.510.desc.0.4
				owner = {
					human_fallen_empires_trigger_is_hive = no
				}
			}
			# non synth
			success_text = {
				text = human_fallen_empires.510.desc.0.5.0
				owner = {
					human_fallen_empires_trigger_is_hive = no
					not = {
						has_trait = trait_robotic_3
					}
				}
			}
			# synth
			success_text = {
				text = human_fallen_empires.510.desc.0.5.1
				owner = {
					human_fallen_empires_trigger_is_hive = no
					has_trait = trait_robotic_3
				}
			}
			# robo hive
			success_text = {
				text = human_fallen_empires.510.desc.1.0
				owner = {
					has_authority = auth_machine_intelligence
				}
			}
			# have discovered L gate
			success_text = {
				text = human_fallen_empires.510.desc.1.1.0
				owner = {
					has_authority = auth_machine_intelligence
					has_seen_any_bypass = lgate
				}
			}
			# have discovered regular gateway
			success_text = {
				text = human_fallen_empires.510.desc.1.1.1
				owner = {
					has_authority = auth_machine_intelligence
					not = {
						has_seen_any_bypass = lgate
					}
					has_seen_any_bypass = gateway
				}
			}
			# not L gateway and not regular gateway
			success_text = {
				text = human_fallen_empires.510.desc.1.1.2
				owner = {
					has_authority = auth_machine_intelligence
					nor = {
						has_seen_any_bypass = lgate
						has_seen_any_bypass = gateway
					}
				}
			}
			success_text = {
				text = human_fallen_empires.510.desc.1.2
				owner = {
					has_authority = auth_machine_intelligence
				}
			}
			# bio hive
			success_text = {
				text = human_fallen_empires.510.desc.2
				owner = {
					has_authority = auth_machine_intelligence
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_ship_explosion
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		exists = owner
	}

	immediate = {
		fleet = {
			set_event_locked = yes
		}
		from = {
			human_fallen_empires_effect_remove_signal_object_from_this = yes
			set_planet_flag = human_fallen_empires_stargate_planet
			save_event_target_as = human_fallen_empires_stargate_planet
		}
	}

	option = {
		name = human_fallen_empires.510.0
		exclusive_trigger = {
			owner = {
				has_authority = auth_machine_intelligence
			}
		}
	}
	option = {
		name = human_fallen_empires.510.1
		exclusive_trigger = {
			owner = {
				has_authority = auth_hive_mind
			}
		}
	}
	option = {
		name = human_fallen_empires.510.2
	}
	after = {
		begin_event_chain = {
			event_chain = human_fallen_empires_chain_stargate
			target = owner
		}
		create_point_of_interest = {
			id = human_fallen_empires_chain_stargate.0
			name = human_fallen_empires_chain_stargate_name.0
			desc = human_fallen_empires_chain_stargate_desc.0
			event_chain = human_fallen_empires_chain_stargate
			location = from
		}
		hidden_effect = {
			fleet = {
				set_event_locked = no
			}
			create_country = {
				name = "Drontection"
				type = human_fallen_empires_berserk
				species = root.owner
				effect = {
					set_graphical_culture = human_fallen_empires_graphical_culture_drone
					every_country = {
						establish_communications_no_message = prev
					}
					human_fallen_empires_effect_init_give_tech_t2 = yes
					create_fleet = {
						name = "Drontection"
						effect = {
							set_owner = prev
							while = {
								count = 20
								create_ship = {
									random_existing_design = corvette
									prefix = no
								}
							}
							while = {
								count = 20
								create_ship = {
									random_existing_design = destroyer
									prefix = no
								}
							}
							set_fleet_stance = aggressive
							set_location = root
						}
					}
				}
			}
			destroy_fleet = fleet
		}
	}
}

# after colonisation 511
planet_event = {
	id = human_fallen_empires.511
	title = human_fallen_empires.511.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.511.desc.0
				owner = {
					human_fallen_empires_trigger_is_hive = no
				}
			}
			success_text = {
				text = human_fallen_empires.511.desc.1
				owner = {
					human_fallen_empires_trigger_is_hive = yes
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_conversation
	location = root
	is_triggered_only = yes

	trigger = {
		exists = owner
		has_planet_flag = human_fallen_empires_stargate_planet
	}

	immediate = {
		remove_planet_flag = human_fallen_empires_stargate_planet
		save_event_target_as = human_fallen_empires_stargate_planet
		owner = {
			add_event_chain_counter = {
				event_chain = human_fallen_empires_chain_stargate
				counter = colony_established
				amount = 1
			}
			remove_point_of_interest = human_fallen_empires_chain_stargate.0
		}
	}

	option = {
		name = human_fallen_empires.511.0
		enable_special_project = {
			name = human_fallen_empires_project_stargate
			owner = owner
			location = this
		}
	}
	option = {
		name = human_fallen_empires.511.1
		trigger = {
			owner = {
				is_materialist = no
				human_fallen_empires_trigger_is_hive = no
			}
		}
		add_modifier = {
			modifier = human_fallen_empires.511
		}
		owner = {
			end_event_chain = human_fallen_empires_chain_stargate
		}
	}
	option = {
		name = human_fallen_empires.511.2
		trigger = {
			owner = {
				is_materialist = yes
			}
		}
		add_modifier = {
			modifier = human_fallen_empires.511
		}
		owner = {
			end_event_chain = human_fallen_empires_chain_stargate
		}
	}
	option = {
		name = human_fallen_empires.511.3
		trigger = {
			owner = {
				human_fallen_empires_trigger_is_hive = yes
			}
		}
		add_modifier = {
			modifier = human_fallen_empires.511
		}
		owner = {
			end_event_chain = human_fallen_empires_chain_stargate
		}
	}
}

# after special project gateway event 512
ship_event = {
	id = human_fallen_empires.512
	title = human_fallen_empires.512.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.512.desc.0
				owner = {
					human_fallen_empires_trigger_is_hive = no
				}
			}
			success_text = {
				text = human_fallen_empires.512.desc.1
				owner = {
					human_fallen_empires_trigger_is_hive = yes
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		exists = leader
		exists = owner
	}

	immediate = {
		leader = {
			save_event_target_as = human_fallen_empires_stargate_scientist
		}
	}

	option = {
		name = human_fallen_empires.512.0
		custom_tooltip = human_fallen_empires.512.tooltip
		exclusive_trigger = {
			owner = {
				is_spiritualist = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.512.1
		custom_tooltip = human_fallen_empires.512.tooltip
		exclusive_trigger = {
			owner = {
				is_materialist = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.512.2
		custom_tooltip = human_fallen_empires.512.tooltip
		exclusive_trigger = {
			owner = {
				human_fallen_empires_trigger_is_hive = yes
			}
		}
	}
	option = {
		name = human_fallen_empires.512.3
		custom_tooltip = human_fallen_empires.512.tooltip
	}
	after = {
		hidden_effect = {
			owner = {
				random_list = {
					10 = {
						country_event = {
							id = human_fallen_empires.520
						}
					}
					10 = {
						modifier = {
							factor = 0
							human_fallen_empires_trigger_is_hive = no
						}
						country_event = {
							id = human_fallen_empires.522
						}
					}
					10 = {
						country_event = {
							id = human_fallen_empires.523
						}
					}
					10 = {
						country_event = {
							id = human_fallen_empires.524
						}
					}
					10 = {
						modifier = {
							factor = 0
							not = {
								is_species_class = HUM
							}
						}
						country_event = {
							id = human_fallen_empires.525
						}
					}
					10 = {
						modifier = {
							factor = 0
							not = {
								is_species_class = HUM
							}
						}
						country_event = {
							id = human_fallen_empires.527
						}
					}
					10 = {
						country_event = {
							id = human_fallen_empires.528
						}
					}
					10 = {
						modifier = {
							factor = 0
							not = {
								is_species_class = FUN
							}
						}
						country_event = {
							id = human_fallen_empires.529
						}
					}
					10 = {
						country_event = {
							id = human_fallen_empires.531
						}
					}
					10 = {
						modifier = {
							factor = 0
							has_authority = auth_machine_intelligence
							not = {
								has_valid_civic = civic_machine_servitor
							}
						}
						country_event = {
							id = human_fallen_empires.532
						}
					}
				}
			}
		}
	}
}

# outcomes, country events 520-550
# 1
country_event = {
	id = human_fallen_empires.520
	title = human_fallen_empires.520.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.520.desc.0
				human_fallen_empires_trigger_is_hive = no
			}
			success_text = {
				text = human_fallen_empires.520.desc.1
				human_fallen_empires_trigger_is_hive = yes
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_laboratory_sound
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		event_target:human_fallen_empires_stargate_scientist = {
			kill_leader = { show_notification = yes }
		}
		destroy_fleet = from.fleet
		human_fallen_empires_effect_stargate_off = yes
		random = {
			chance = 50
			country_event = {
				id = human_fallen_empires.521
				days = 180
				random = 30
			}
		}
	}

	option = {
		name = human_fallen_empires.520.0
		exclusive_trigger = {
			human_fallen_empires_trigger_is_hive = no
		}
	}
	option = {
		name = human_fallen_empires.520.1
	}
}

# 1.1 Forsakens
country_event = {
	id = human_fallen_empires.521
	title = human_fallen_empires.521.name
	desc = human_fallen_empires.521.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_space_battle
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		human_fallen_empires_trigger_is_hive = no
		exists = event_target:human_fallen_empires_stargate
		exists = event_target:human_fallen_empires_stargate_planet.starbase
	}

	immediate = {
		create_country = {
			name = "Forsakens"
			type = default
			species = root
			#auto_delete = no
			authority = auth_dictatorial
			ignore_initial_colony_error = yes
			ethos = {
				ethic = ethic_authoritarian
				ethic = ethic_fanatic_militarist
			}
			effect = {
				human_fallen_empires_effect_gov_fix = yes
				set_country_flag = human_fallen_empires_forsaken
				set_graphical_culture = human_fallen_empires_graphical_culture_pirate
				event_target:human_fallen_empires_stargate_planet = {
					conquer = prev
					starbase = {
						set_owner = prevprev
					}
					while = {
						limit = {
							num_pops < 10
						}
						create_pop = {
							species = root
						}
					}
				}
				copy_techs_from = {
					target = root
				}
				establish_communications_no_message = root
				add_opinion_modifier = {
					who = root
					modifier = human_fallen_empires_opinion_forsaken
				}
				add_modifier = {
					modifier = human_fallen_empires_navy_size
				}
				create_fleet_from_naval_cap = 1
				create_leader = {
					type = admiral
				}
				last_created_fleet = {
					add_modifier = {
						modifier = human_fallen_empires_unkeep_80
					}
					assign_leader = last_created_leader
				}
				create_leader = {
					type = general
				}
				create_fleet = {
					effect = {
						set_owner = prev
						while = {
							count = 20
							create_army_transport = {
								army_type = assault_army
							}
						}
						assign_leader = last_created_leader
						set_location = event_target:human_fallen_empires_stargate
					}
				}
				add_minerals = 5000
				add_energy = 5000
				declare_war = {
					target = root
					name = "War with Forsakens"
					attacker_war_goal = human_fallen_empires_wg_annex
				}
				set_war_goal = {
					type = human_fallen_empires_wg_annex
					target = root
					enemy = this
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.521.0
	}
}

# 2 horror confirmed
country_event = {
	id = human_fallen_empires.522
	title = human_fallen_empires.522.name
	desc = human_fallen_empires.522.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_laboratory_sound
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		event_target:human_fallen_empires_stargate_scientist = {
			kill_leader = { show_notification = yes }
		}
		destroy_fleet = from.fleet
		human_fallen_empires_effect_stargate_off = yes
	}

	option = {
		name = human_fallen_empires.522.0
	}
}

# 3 drone evolution
country_event = {
	id = human_fallen_empires.523
	title = human_fallen_empires.523.name
	desc = human_fallen_empires.523.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_laboratory_sound
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		human_fallen_empires_effect_stargate_off = yes
	}

	option = {
		name = human_fallen_empires.523.0
		human_fallen_empires_effect_media_negative = yes
	}
}

# 4 start of universe
country_event = {
	id = human_fallen_empires.524
	title = human_fallen_empires.524.name
	desc = human_fallen_empires.524.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_laboratory_sound
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	option = {
		name = human_fallen_empires.524.0
		human_fallen_empires_effect_add_physics_research.5 = yes
		# добавить модификатор на энергию из другой вселенной, там же много водорода и тд
	}
}

# 5 exodus
country_event = {
	id = human_fallen_empires.525
	title = human_fallen_empires.525.name
	desc = human_fallen_empires.525.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_radio_chatter_02
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		event_target:human_fallen_empires_stargate_scientist = {
			kill_leader = { show_notification = yes }
		}
		destroy_fleet = from.fleet
		human_fallen_empires_effect_stargate_off = yes
		create_fleet = {
			effect = {
				set_owner = root
				create_ship = {
					random_existing_design = colonizer
				}
				set_location = event_target:human_fallen_empires_stargate
				add_modifier = {
				 	modifier = human_fallen_empires_unkeep_80
				}
				save_event_target_as = human_fallen_empires_stargate_exodus_fleet
			}
		}
	}

	# niarest planet
	option = {
		name = human_fallen_empires.525.0
		custom_tooltip = human_fallen_empires.525.0.tooltip
		human_fallen_empires_effect_add_physics_research.2 = yes
		human_fallen_empires_effect_add_society_research.2 = yes
		hidden_effect = {
			event_target:human_fallen_empires_stargate_exodus_fleet = {
				queue_actions = {
					find_closest_system = {
						trigger = {
							id = human_fallen_empires_stargate_exodus_fleet_trigger.0.0
							any_planet = {
								is_owned_by = root
								free_pop_tiles > 0
								habitability = {
									who = root.species
									value > 0.7
								}
							}
						}
						found_system = {
							move_to = this
						}
					}
					find_closest_planet = {
						trigger = {
							id = human_fallen_empires_stargate_exodus_fleet_trigger.0.1
							is_owned_by = root
							free_pop_tiles > 0
							habitability = {
								who = root.species
								value > 0.7
							}
						}
						found_planet = {
							move_to = this
							effect = {
								id = human_fallen_empires_stargate_exodus_fleet_effect.0.1
								create_pop = {
									species = root
								}
								delete_fleet = event_target:human_fallen_empires_stargate_exodus_fleet
							}
						}
					}
				}
			}
		}
	}
	# make new colony
	option = {
		name = human_fallen_empires.525.1
		custom_tooltip = human_fallen_empires.525.0.tooltip
		human_fallen_empires_effect_add_physics_research.2 = yes
		human_fallen_empires_effect_add_society_research.2 = yes
		hidden_effect = {
			event_target:human_fallen_empires_stargate_exodus_fleet = {
				queue_actions = {
					find_closest_system = {
						trigger = {
							id = human_fallen_empires_stargate_exodus_fleet_trigger.1.0
							any_planet = {
								not = {
									exists = owner
								}
								habitability = {
									who = root.species
									value > 0.7
								}
							}
						}
						found_system = {
							move_to = this
						}
					}
					find_closest_planet = {
						trigger = {
							id = human_fallen_empires_stargate_exodus_fleet_trigger.1.1
							not = {
								exists = owner
							}
							habitability = {
								who = root.species
								value > 0.7
							}
						}
						found_planet = {
							move_to = this
							effect = {
								id = human_fallen_empires_stargate_exodus_fleet_effect.1.1
								start_colony = {
									owner = root
								}
								planet_event = {
									id = human_fallen_empires.526
								}
								delete_fleet = event_target:human_fallen_empires_stargate_exodus_fleet
							}
						}
					}
				}
			}
		}
	}
	# kill them
	option = {
		name = human_fallen_empires.525.2
		trigger = {
			is_xenophobe = yes
		}
		custom_tooltip = human_fallen_empires.525.0.tooltip
		destroy_fleet = event_target:human_fallen_empires_stargate_exodus_fleet
		human_fallen_empires_effect_add_physics_research.2 = yes
		human_fallen_empires_effect_add_society_research.2 = yes
		human_fallen_empires_effect_xenophobe_attraction.3 = yes
	}
}

# 5.1 live long and prosper
planet_event = {
	id = human_fallen_empires.526
	title = human_fallen_empires.526.name
	desc = human_fallen_empires.526.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_celebration
	location = root
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.526.0
	}
}

# 6 records from empty ship
country_event = {
	id = human_fallen_empires.527
	title = human_fallen_empires.527.name
	desc = human_fallen_empires.527.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		event_target:human_fallen_empires_stargate_scientist = {
			kill_leader = {
				show_notification = yes
			}
		}
		destroy_fleet = from.fleet
		human_fallen_empires_effect_stargate_off = yes
	}

	option = {
		name = human_fallen_empires.527.0
	}
	option = {
		name = human_fallen_empires.527.1
		exclusive_trigger = {
			allows_slavery = yes
		}
		add_modifier = {
			modifier = human_fallen_empires_event_527
		}
	}
	after = {
		if = {
			limit = {
				exists = ruler
			}
			ruler = {
				add_trait = human_fallen_empires_generic_trait_nightmare
			}
		}
	}
}

# 7 Shambhala
country_event = {
	id = human_fallen_empires.528
	title = human_fallen_empires.528.name
	desc = human_fallen_empires.528.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	option = {
		name = human_fallen_empires.528.0
		custom_tooltip = human_fallen_empires.528.0.tooltip
		if = {
			limit = {
				has_ethic = ethic_fanatic_spiritualist
			}
			human_fallen_empires_effect_add_unity.5 = yes
		}
		else_if = {
			limit = {
				is_spiritualist = yes
			}
			shift_ethic = ethic_spiritualist
			human_fallen_empires_effect_add_unity.4 = yes
		}
		else = {
			shift_ethic = ethic_spiritualist
			shift_ethic = ethic_spiritualist
			human_fallen_empires_effect_add_unity.3 = yes
		}
		add_modifier = {
			modifier = human_fallen_empires_event_528.0.0
		}
		event_target:human_fallen_empires_stargate_planet = {
			add_modifier = {
				modifier = human_fallen_empires_event_528.0.1
			}
		}
	}
	option = {
		name = human_fallen_empires.528.1
		custom_tooltip = human_fallen_empires.528.1.tooltip
		exclusive_trigger = {
			is_materialist = yes
		}
		add_modifier = {
			modifier = human_fallen_empires_event_528.1
		}
		hidden_effect = {
			event_target:human_fallen_empires_stargate_scientist = {
				kill_leader = { show_notification = yes }
			}
			play_sound = amb_super_explosion
			human_fallen_empires_effect_stargate_off = yes
		}
	}
	option = {
		name = human_fallen_empires.528.2
		custom_tooltip = human_fallen_empires.528.2.tooltip
		exclusive_trigger = {
			is_xenophobe = yes
		}
		add_modifier = {
			modifier = human_fallen_empires_event_528.2
		}
		hidden_effect = {
			event_target:human_fallen_empires_stargate_scientist = {
				kill_leader = { show_notification = yes }
			}
			play_sound = amb_super_explosion
			human_fallen_empires_effect_stargate_off = yes
		}
	}
}

# 8 hands from portal
country_event = {
	id = human_fallen_empires.529
	title = human_fallen_empires.529.name
	desc = {
		trigger = {
			text = human_fallen_empires.529.desc.0
			success_text = {
				text = human_fallen_empires.529.desc.1.0
				has_country_flag = human_fallen_empires_marked_as_human
			}
			fail_text = {
				text = human_fallen_empires.529.desc.1.1
				has_country_flag = human_fallen_empires_marked_as_human
			}
			text = human_fallen_empires.529.desc.2
		}
	}
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		event_target:human_fallen_empires_stargate_scientist = {
			kill_leader = { show_notification = yes }
		}
		destroy_fleet = from.fleet
	}

	option = {
		name = human_fallen_empires_next
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.530
			}
		}
	}
}

# 8.1
country_event = {
	id = human_fallen_empires.530
	title = human_fallen_empires.530.name
	desc = human_fallen_empires.530.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		human_fallen_empires_effect_stargate_off = yes
	}

	option = {
		name = human_fallen_empires.530.0
		exclusive_trigger = {
			is_xenophobe = no
		}
		add_modifier = {
			modifier = human_fallen_empires_event_530
		}
	}
	option = {
		name = human_fallen_empires.530.1
		add_modifier = {
			modifier = human_fallen_empires_event_530
		}
	}
}

# 9 galaxy war
country_event = {
	id = human_fallen_empires.531
	title = human_fallen_empires.531.name
	desc = human_fallen_empires.531.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_space_battle
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		human_fallen_empires_effect_stargate_off = yes
	}

	option = {
		name = FASCINATING
		# какая-то награда, простите потомки, не придумал ничего лучше
		human_fallen_empires_effect_add_engineering_research.4 = yes
	}
}

# 10 geck
country_event = {
	id = human_fallen_empires.532
	title = human_fallen_empires.532.name
	desc = human_fallen_empires.532.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_activating_unknown_technology
	location = event_target:human_fallen_empires_stargate
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_stargate
	}

	immediate = {
		human_fallen_empires_effect_stargate_off = yes
		set_country_flag = human_fallen_empires_has_event_532
	}

	option = {
		name = human_fallen_empires.532.0
	}
	option = {
		name = human_fallen_empires.532.1
	}
	option = {
		name = human_fallen_empires.532.2
	}
}

# terminator event part of memorial events 550 - 600
# есть правитель человек. есть пустынная планета. столица одного из классов. есть дружественная империя
# start event nothing, complitly nothing
ship_event = {
	id = human_fallen_empires.550
	title = human_fallen_empires.550.name
	desc = human_fallen_empires.550.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = root
	is_triggered_only = yes

	trigger = {
		exists = owner
		exists = leader
	}

	immediate = {
		leader = {
			save_event_target_as = human_fallen_empires_550_scientist
		}
		owner = {
			country_event = {
				id = human_fallen_empires.551
				#days = 50
				#random = 150
			}
		}
	}

	option = {
		name = human_fallen_empires.550.0
	}
}

# check scientist position
country_event = {
	id = human_fallen_empires.551
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = capital_scope
		any_owned_leader = {
			is_same_value = event_target:human_fallen_empires_550_scientist
		}
	}

	immediate = {
		random_owned_leader = {
			limit = {
				is_same_value = event_target:human_fallen_empires_550_scientist
			}
			if = {
				limit = {
					exists = fleet
				}
				# branch 1
				fleet = {
					random_list = {
						# kill ship
						10 = {
							fleet_event = {
								id = human_fallen_empires.552
							}
						}
						# disappeared, move to branch 2
						10 = {
							fleet_event = {
								id = human_fallen_empires.553
							}
						}
					}
				}
			}
			else = {
				root = {
					# branch 2
					random_list = {
						# attempt failed
						10 = {
							country_event = {
								id = human_fallen_empires.554
							}
						}
						# main event
						10 = {
							capital_scope = {
								planet_event = {
									id = human_fallen_empires.555
								}
							}
						}
					}
				}
			}
		}
	}
}

# branch 1 ship
# kill ship
fleet_event = {
	id = human_fallen_empires.552
	title = human_fallen_empires.552.name
	desc = human_fallen_empires.552.desc
	show_sound = event_ship_explosion
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = root
	is_triggered_only = yes

	immediate = {
		kill_leader = {
			type = scientist
			show_notification = no
		}
		destroy_fleet = this
	}

	option = {
		name = human_fallen_empires.552.0
	}
}

# branch 2 planet
# disappeared, move to branch 2
fleet_event = {
	id = human_fallen_empires.553
	title = human_fallen_empires.553.name
	desc = human_fallen_empires.553.desc
	picture = GFX_evt_human_fallen_empires_holocube_2
	show_sound = event_mystic_reveal
	is_triggered_only = yes

	trigger = {
		exists = owner
		exists = owner.capital_scope
		exists = leader
	}

	immediate = {
		leader = {
			exile_leader_as = human_fallen_empires_553_scientist
		}
		owner = {
			random_list = {
				# attempt failed
				10 = {
					country_event = {
						id = human_fallen_empires.554
						days = 80
						random = 100
					}
				}
				# main event
				10 = {
					capital_scope = {
						planet_event = {
							id = human_fallen_empires.555
							days = 180
							random = 100
						}
					}
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.553.0
	}
}

# attempt failed
country_event = {
	id = human_fallen_empires.554
	title = human_fallen_empires.554.name
	desc = human_fallen_empires.554.desc
	show_sound = event_structural_collapse
	picture = GFX_evt_human_fallen_empires_holocube_2
	location = capital_scope
	is_triggered_only = yes

	option = {
		name = human_fallen_empires.554.0
	}
}

# main event planet desc
planet_event = {
	id = human_fallen_empires.555
	title = human_fallen_empires.555.name
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.555.desc.0.0
				or = {
					habitable_structure = yes
					solar_system.system_star = {
						is_planet_class = pc_black_hole
					}
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.0.1
				or = {
					habitable_structure = yes
					solar_system.system_star = {
						is_planet_class = pc_black_hole
					}
				}
			}
			text = newline
			success_text = {
				text = human_fallen_empires.555.desc.1.0
				or = {
					is_planet_class = pc_tropical
					is_planet_class = pc_continental
					is_planet_class = pc_ocean
					is_planet_class = pc_gaia
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.1
				or = {
					is_planet_class = pc_desert
					is_planet_class = pc_arid
					is_planet_class = pc_savannah
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.2
				or = {
					is_planet_class = pc_tundra
					is_planet_class = pc_arctic
					is_planet_class = pc_alpine
				}
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.3
				habitable_structure = yes
			}
			success_text = {
				text = human_fallen_empires.555.desc.1.4
				is_planet_class = pc_nuked
			}
			text = newline
			success_text = {
				text = human_fallen_empires.555.desc.2.0
				is_moon = no
				has_moon = yes
				not = {
					is_planet_class = pc_nuked
				}
				habitable_structure = no
			}
			success_text = {
				text = human_fallen_empires.555.desc.2.1
				is_moon = no
				num_moons < 1
				# has_moon = no seems broken
				not = {
					is_planet_class = pc_nuked
				}
				habitable_structure = no
			}
			success_text = {
				text = human_fallen_empires.555.desc.2.2
				is_moon = yes
				not = {
					is_planet_class = pc_nuked
				}
				habitable_structure = no
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = event_target:human_fallen_empires_555_room.ruler
	}

	immediate = {
		# set up all needed targets
		save_global_event_target_as = human_fallen_empires_555_planet
		create_country = {
			type = human_fallen_empires_placeholder
			species = root.owner
			effect = {
				set_country_flag = human_fallen_empires_555_room
				save_event_target_as = human_fallen_empires_555_room
			}
		}
		owner = {
			random_planet_within_border = {
				limit = {
					or = {
						is_planet_class = pc_desert
						is_planet_class = pc_arid
						is_planet_class = pc_savannah
					}
					not = {
						is_planet = root
					}
				}
				save_event_target_as = human_fallen_empires_555_dry_planet
			}
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_ocean
					not = {
						is_planet = root
					}
				}
				save_event_target_as = human_fallen_empires_555_ocean_planet
			}
			random_relation = {
				limit = {
					opinion = {
						who = prev
						value > 100
					}
				}
				save_event_target_as = human_fallen_empires_555_friendly_relation
			}
		}
		if = {
			limit = {
				is_moon = yes
			}
			solar_system = {
				random_system_planet = {
					limit = {
						any_moon = {
							is_planet = root
						}
					}
					save_event_target_as = human_fallen_empires_555_orbiting_planet
				}
			}
		}
	}

	option = {
		name = human_fallen_empires_next
		default_hide_option = yes
		hidden_effect = {
			clear_global_event_target = human_fallen_empires_555_planet
			event_target:human_fallen_empires_555_room = {
				destroy_country = yes
			}
			owner = {
				country_event = {
					id = human_fallen_empires.556
				}
				set_country_flag = human_fallen_empires_556.0
			}
		}
	}
}

# main event ruler desc, switch to country scope
country_event = {
	id = human_fallen_empires.556
	title = human_fallen_empires.556.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.556.desc.0
				has_country_flag = human_fallen_empires_556.0
			}
			success_text = {
				text = human_fallen_empires.556.desc.1
				has_country_flag = human_fallen_empires_556.1
			}
			# option 0
			success_text = {
				text = human_fallen_empires.556.desc.2.0
				or = {
					has_country_flag = human_fallen_empires_556.2.0.0
					has_country_flag = human_fallen_empires_556.2.0.1
				}
			}
			success_text = {
				text = human_fallen_empires.556.desc.2.0.0
				has_country_flag = human_fallen_empires_556.2.0.0
			}
			success_text = {
				text = human_fallen_empires.556.desc.2.0.1
				has_country_flag = human_fallen_empires_556.2.0.1
			}
			# option 1
			success_text = {
				text = human_fallen_empires.556.desc.2.1
				or = {
					has_country_flag = human_fallen_empires_556.2.1.0.0
					has_country_flag = human_fallen_empires_556.2.1.1
				}
			}
			success_text = {
				text = human_fallen_empires.556.desc.2.1.0.0
				has_country_flag = human_fallen_empires_556.2.1.0.0
			}
			success_text = {
				text = human_fallen_empires.556.desc.2.1.0.1
				has_country_flag = human_fallen_empires_556.2.1.0.1
			}
			success_text = {
				text = human_fallen_empires.556.desc.2.1.1
				has_country_flag = human_fallen_empires_556.2.1.1
			}
			# option 2
			success_text = {
				text = human_fallen_empires.556.desc.2.2
				has_country_flag = human_fallen_empires_556.2.2
			}
			success_text = {
				text = human_fallen_empires.556.desc.3
				or = {
					has_country_flag = human_fallen_empires_556.3.0
					has_country_flag = human_fallen_empires_556.3.1
				}
			}
			success_text = {
				text = human_fallen_empires.556.desc.3.0
				has_country_flag = human_fallen_empires_556.3.0
			}
			success_text = {
				text = human_fallen_empires.556.desc.3.1
				has_country_flag = human_fallen_empires_556.3.1
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room # event_target:human_fallen_empires_555_room.ruler
	}

	# step 0
	option = {
		name = human_fallen_empires_next
		trigger = {
			has_country_flag = human_fallen_empires_556.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.0
			set_country_flag = human_fallen_empires_556.1
			country_event = {
				id = human_fallen_empires.556
			}
		}
	}
	# step 1 left pekar and run away
	option = {
		name = human_fallen_empires_556.1.0
		custom_tooltip = human_fallen_empires_556.1.0.tooltip
		trigger = {
			has_country_flag = human_fallen_empires_556.1
			is_militarist = no
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.1
			random_list = {
				# fail
				100 = {
					set_country_flag = human_fallen_empires_556.2.0.0
				}
				# success
				50 = {
					set_country_flag = human_fallen_empires_556.2.0.1
				}
			}
			country_event = {
				id = human_fallen_empires.556
			}
		}
	}
	# step 2 left pekar and run away
	option = {
		name = human_fallen_empires_556.2.0.0
		trigger = {
			has_country_flag = human_fallen_empires_556.2.0.0
		}
		kill_leader = {
			type = ruler
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.2.0.0
		}
	}
	option = {
		name = human_fallen_empires_556.2.0.1
		trigger = {
			has_country_flag = human_fallen_empires_556.2.0.1
		}
		ruler = {
			add_trait = human_fallen_empires_ruler_trait_imperialist
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.2.0.1
		}
	}
	# step 1 dont left pekar and run away
	option = {
		name = human_fallen_empires_556.1.1
		custom_tooltip = human_fallen_empires_556.1.1.tooltip
		trigger = {
			has_country_flag = human_fallen_empires_556.1
			is_militarist = no
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.1
			random_list = {
				# fail
				100 = {
					set_country_flag = human_fallen_empires_556.2.1.0.0
				}
				# success
				100 = {
					set_country_flag = human_fallen_empires_556.2.1.1
				}
			}
			country_event = {
				id = human_fallen_empires.556
			}
		}
	}
	# step 2 dont left pekar and run away
	option = {
		name = human_fallen_empires_next
		trigger = {
			has_country_flag = human_fallen_empires_556.2.1.0.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.2.1.0.0
			set_country_flag = human_fallen_empires_556.2.1.0.1
			country_event = {
				id = human_fallen_empires.556
			}
		}
	}
	option = {
		name = human_fallen_empires_556.2.1.0.1
		trigger = {
			has_country_flag = human_fallen_empires_556.2.1.0.1
		}
		kill_leader = {
			type = ruler
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.2.1.0.1
		}
	}
	option = {
		name = human_fallen_empires_556.2.1.1
		trigger = {
			has_country_flag = human_fallen_empires_556.2.1.1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.2.1.1
		}
	}
	# step 1 attack
	option = {
		name = human_fallen_empires_556.1.2
		custom_tooltip = human_fallen_empires_556.1.2.tooltip
		trigger = {
			has_country_flag = human_fallen_empires_556.1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.1
			set_country_flag = human_fallen_empires_556.2.2
			country_event = {
				id = human_fallen_empires.556
			}
		}
	}
	# step 2 attack
	option = {
		name = human_fallen_empires_next
		trigger = {
			has_country_flag = human_fallen_empires_556.2.2
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.2.2
			random_list = {
				# fail
				50 = {
					set_country_flag = human_fallen_empires_556.3.0
				}
				# success
				100 = {
					set_country_flag = human_fallen_empires_556.3.1
				}
			}
			country_event = {
				id = human_fallen_empires.556
			}
		}
	}
	# step 3 attack
	option = {
		name = human_fallen_empires_556.3
		trigger = {
			or = {
				has_country_flag = human_fallen_empires_556.3.0
				has_country_flag = human_fallen_empires_556.3.1
			}
		}
		if = {
			limit = {
				has_country_flag = human_fallen_empires_556.3.0
			}
			kill_leader = {
				type = ruler
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires_556.3.0
			remove_country_flag = human_fallen_empires_556.3.1
		}
	}
}

# drone country section 600
# contact event
country_event = {
	id = human_fallen_empires.604
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = human_fallen_empires_drone
		exists = from
	}

	immediate = {
		establish_communications = from
		from = {
			if = {
				limit = {
					is_ai = no
				}
				country_event = {
					id = human_fallen_empires.605
				}
				set_country_flag = human_fallen_empires.605.step0
			}
		}
	}
}

# diplomatic contact event
country_event = {
	id = human_fallen_empires.605
	title = TRANSMISSION
	desc = {
		trigger = {
			# start
			fail_text = {
				text = human_fallen_empires.605.desc.0
				has_country_flag = human_fallen_empires.605.step3
			}
			success_text = {
				text = human_fallen_empires.605.desc.1
				has_country_flag = human_fallen_empires.605.step3
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	# step 0
	option = {
		name = human_fallen_empires.605.0.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step0
			set_country_flag = human_fallen_empires.605.step1
			country_event = {
				id = human_fallen_empires.605
			}
		}
	}
	# step 1
	option = {
		name = human_fallen_empires.605.1.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step1
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step1
			set_country_flag = human_fallen_empires.605.step2
			country_event = {
				id = human_fallen_empires.605
			}
		}
	}
	# step 2
	option = {
		name = human_fallen_empires.605.2.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step2
			human_fallen_empires_trigger_is_clever_for_event = yes
		}
		human_fallen_empires_effect_materialist_attraction.1 = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step2
			set_country_flag = human_fallen_empires.605.step3
			country_event = {
				id = human_fallen_empires.605
			}
		}
	}
	# step 3
	option = {
		name = human_fallen_empires.605.3.0
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.0.response
	}
	option = {
		name = human_fallen_empires.605.3.1
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.1.response
	}
	option = {
		name = human_fallen_empires.605.3.2
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.2.response
	}
	option = {
		name = human_fallen_empires.605.3.3
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.3.response
	}
	option = {
		name = human_fallen_empires.605.3.4
		trigger = {
			has_country_flag = human_fallen_empires.605.step3
		}
		is_dialog_only = yes
		response_text = human_fallen_empires.605.3.4.response
	}
	option = {
		name = human_fallen_empires_end_transmission
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.605.step0
			remove_country_flag = human_fallen_empires.605.step1
			remove_country_flag = human_fallen_empires.605.step2
			remove_country_flag = human_fallen_empires.605.step3
		}
	}
}

# drone awake
country_event = {
	id = human_fallen_empires.606
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		human_fallen_empires_trigger_story_enabled = yes
		exists = event_target:human_fallen_empires_drone_country
		nor = {
			has_global_flag = human_fallen_empires_drone_awake
			has_global_flag = human_fallen_empires_has_event.606
		}
		years_passed > 10
	}

	immediate = {
		random_playable_country = {
			weights = {
				base = 1
				modifier = {
					add = 1000
					is_ai = no
				}
			}
			save_event_target_as = human_fallen_empires_606_target_country
		}
		if = {
			limit = {
				exists = event_target:human_fallen_empires_606_target_country
			}
			random_system = {
				limit = {
					has_presence = no
					distance_to_empire = {
						who = event_target:human_fallen_empires_606_target_country
						distance <= 50
					}
					any_planet = {
						is_planet_class = pc_gas_giant
					}
				}
				random_system_planet = {
					limit = {
						is_planet_class = pc_gas_giant
					}
					save_event_target_as = human_fallen_empires_606_target
				}
			}
			if = {
				limit = {
					not = {
						exists = event_target:human_fallen_empires_606_target
					}
				}
				event_target:human_fallen_empires_606_target_country = {
					random_system_within_border = {
						limit = {
							any_planet = {
								not = {
									exists = owner
								}
								is_planet_class = pc_gas_giant
							}
						}
						random_system_planet = {
							limit = {
								not = {
									exists = owner
								}
							}
							save_event_target_as = human_fallen_empires_606_target
						}
					}
				}
			}
			if = {
				limit = {
					exists = event_target:human_fallen_empires_606_target
				}
				set_global_flag = human_fallen_empires_has_event.606
				event_target:human_fallen_empires_606_target_country = {
					country_event = {
						id = human_fallen_empires.607
					}
				}
			}
		}
	}
}

# start special project
country_event = {
	id = human_fallen_empires.607
	title = human_fallen_empires.607.name
	desc = human_fallen_empires.607.desc
	picture = GFX_evt_gas_giant
	show_sound = event_sensor_ping
	location = event_target:human_fallen_empires_606_target
	trackable = yes
	is_triggered_only = yes

	immediate = {
		enable_special_project = {
			name = human_fallen_empires_project_drone_awake
			location = event_target:human_fallen_empires_606_target
			owner = root
		}
	}

	option = {
		name = human_fallen_empires.607.0
		tooltip = {
			enable_special_project = {
				name = human_fallen_empires_project_drone_awake
				location = event_target:human_fallen_empires_606_target
				owner = root
			}
		}
	}
}

# project complete
ship_event = {
	id = human_fallen_empires.608
	title = human_fallen_empires.608.name
	desc = human_fallen_empires.608.desc
	picture = GFX_evt_gas_giant
	show_sound = event_ship_thrusters
	location = event_target:human_fallen_empires_606_target
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_drone_country
	}

	immediate = {
		event_target:human_fallen_empires_drone_country = {
			country_event = {
				id = human_fallen_empires.611
			}
		}
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.609
				}
			}
		}
	}
}

# diplo event
country_event = {
	id = human_fallen_empires.609
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.609.desc.0
				has_country_flag = human_fallen_empires_marked_as_human
			}
			fail_text = {
				text = human_fallen_empires.609.desc.1
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	option = {
		name = human_fallen_empires.609.0
		exclusive_trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
		}
		custom_tooltip = human_fallen_empires.609.0.tooltip
	}
	option = {
		name = human_fallen_empires.609.1
		exclusive_trigger = {
			exists = event_target:human_fallen_empires_drone_country
			has_communications = event_target:human_fallen_empires_drone_country
		}
		custom_tooltip = human_fallen_empires.609.0.tooltip
	}
	option = {
		name = human_fallen_empires.609.2
		exclusive_trigger = {
			has_authority = auth_machine_intelligence
		}
		custom_tooltip = human_fallen_empires.609.0.tooltip
	}
	option = {
		name = human_fallen_empires.609.3
		custom_tooltip = human_fallen_empires.609.0.tooltip
	}
}

# project failed
country_event = {
	id = human_fallen_empires.610
	title = human_fallen_empires.610.name
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.610.desc.0.0
				has_country_flag = human_fallen_empires_random_0
			}
			success_text = {
				text = human_fallen_empires.610.desc.0.1
				has_country_flag = human_fallen_empires_random_1
			}
			success_text = {
				text = human_fallen_empires.610.desc.1
				has_communications = event_target:human_fallen_empires_drone_country
			}
		}
	}
	picture = GFX_evt_gas_giant
	show_sound = event_sensor_ping
	location = event_target:human_fallen_empires_606_target
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_drone_country
	}

	immediate = {
		human_fallen_empires_effect_random_roll_flags_2_country = yes
		event_target:human_fallen_empires_drone_country = {
			country_event = {
				id = human_fallen_empires.611
			}
		}
	}

	option = {
		name = INTERESTING
	}
}

# actual awake effect
country_event = {
	id = human_fallen_empires.611
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		set_global_flag = human_fallen_empires_drone_awake
		remove_global_flag = human_fallen_empires_has_event.606
		every_system_within_border = {
			every_neighbor_system = {
				limit = {
					is_surveyed = {
						who = root.owner
						status = no
					}
				}
				every_system_planet = {
					surveyed = {
						set_surveyed = yes
						surveyor = root.owner
					}
				}
			}
		}
	}
}

# friendly ai vol 1 thoth
# start event, enable project
ship_event = {
	id = human_fallen_empires.700
	title = human_fallen_empires.700.name
	desc = human_fallen_empires.700.desc
	picture = GFX_evt_human_fallen_empires_thoth
	show_sound = event_ship_thrusters
	location = root
	trackable = yes
	is_triggered_only = yes

	trigger = {
		human_fallen_empires_trigger_story_enabled = yes
		not = {
			has_global_flag = human_fallen_empires_has_event.700
		}
		exists = owner
		owner = {
			is_ai = no
			is_country_type = default
		}
		not = {
			exists = solar_system.owner
		}
	}

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_thoth_contacted_first
		}
		set_global_flag = human_fallen_empires_has_event.700
		solar_system = {
			random_system_planet = {
				limit = {
					not = {
						exists = owner
					}
				}
				save_global_event_target_as = human_fallen_empires_thoth_location
			}
		}
		create_country = {
			name = "Station AI"
			type = human_fallen_empires_thoth
			species = root.owner
			effect = {
				set_name = human_fallen_empires_customization_notch_this_rename
				save_global_event_target_as = human_fallen_empires_thoth
				set_graphical_culture = mammalian_01
				set_country_flag = human_fallen_empires_thoth
				create_fleet = {
					name = "Station (probably gigantic)"
					settings = {
						spawn_debris = no
					}
					effect = {
						set_owner = prev
						create_ship = {
							design = NAME_Artist_Enclave_Station
							effect = {
								set_ship_flag = human_fallen_empires_thoth_station
							}
						}
						set_location = {
							target = event_target:human_fallen_empires_thoth_location
							distance = 10
						}
						set_fleet_flag = human_fallen_empires_thoth_station
						save_global_event_target_as = human_fallen_empires_thoth_station
						human_fallen_empires_effect_create_signal_object = yes
						enable_special_project = {
							name = human_fallen_empires_project_thoth_contact
							location = this
							owner = root.owner
						}
					}
				}
				set_custom_capital_location = event_target:human_fallen_empires_thoth_station
			}
		}
	}

	option = {
		name = human_fallen_empires.700.0
		trigger = {
			is_ship_size = science
		}
		tooltip = {
			enable_special_project = {
				name = human_fallen_empires_project_thoth_contact
				location = event_target:human_fallen_empires_thoth_location
				owner = root.owner
			}
		}
	}
	option = {
		name = human_fallen_empires.700.1
		trigger = {
			not = {
				is_ship_size = science
			}
		}
		tooltip = {
			enable_special_project = {
				name = human_fallen_empires_project_thoth_contact
				location = event_target:human_fallen_empires_thoth_location
				owner = root.owner
			}
		}
	}
}

# project complete
ship_event = {
	id = human_fallen_empires.701
	title = human_fallen_empires.701.name
	desc = human_fallen_empires.701.desc
	picture = GFX_evt_human_fallen_empires_thoth
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_thoth_station
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		human_fallen_empires_effect_leader_add_exp_100 = yes
		hidden_effect = {
			event_target:human_fallen_empires_thoth_station = {
				human_fallen_empires_effect_remove_signal_object_from_this = yes
			}
			owner = {
				establish_communications = event_target:human_fallen_empires_thoth
				set_country_flag = human_fallen_empires.702.0
				country_event = {
					id = human_fallen_empires.702
				}
			}
		}
	}
}

# dialog with station
country_event = {
	id = human_fallen_empires.702
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.702.desc.0
				has_country_flag = human_fallen_empires.702.0
			}
			success_text = {
				text = human_fallen_empires.702.desc.1
				has_country_flag = human_fallen_empires.702.1
			}
			success_text = {
				text = human_fallen_empires.702.desc.2
				has_country_flag = human_fallen_empires.702.2
			}
			success_text = {
				text = human_fallen_empires.702.desc.3
				has_country_flag = human_fallen_empires.702.3
			}
			success_text = {
				text = human_fallen_empires.702.desc.4
				has_country_flag = human_fallen_empires.702.4
			}
			success_text = {
				text = human_fallen_empires.702.desc.5
				has_country_flag = human_fallen_empires.702.5
			}
			success_text = {
				text = human_fallen_empires.702.desc.6
				has_country_flag = human_fallen_empires.702.6
			}
			success_text = {
				text = human_fallen_empires.702.desc.goodend
				has_country_flag = human_fallen_empires.702.goodend
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = human_fallen_empires_portrait_diplo_thoth
		room = human_fallen_empires_thoth_room
	}

	# step 0
	option = {
		name = human_fallen_empires.702.0.0
		exclusive_trigger = {
			has_country_flag = human_fallen_empires.702.0
			is_xenophile = yes
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.0.1
		trigger = {
			has_country_flag = human_fallen_empires.702.0
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.0.2
		exclusive_trigger = {
			has_country_flag = human_fallen_empires.702.0
			human_fallen_empires_trigger_is_hive = yes
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	# step 1
	option = {
		name = human_fallen_empires.702.1.0
		trigger = {
			has_country_flag = human_fallen_empires.702.1
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	# step 2
	option = {
		name = human_fallen_empires.702.2.0
		trigger = {
			has_country_flag = human_fallen_empires.702.2
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	# step 3
	option = {
		name = human_fallen_empires.702.3.0
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			human_fallen_empires_trigger_is_hive = yes
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.1
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.2
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.3
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.4
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.5
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.6
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.7
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.702.3.8
		trigger = {
			has_country_flag = human_fallen_empires.702.3
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		human_fallen_empires_effect_event_702_next = yes
	}
	# step 4
	option = {
		name = human_fallen_empires.702.4
		trigger = {
			has_country_flag = human_fallen_empires.702.4
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	# step 5 ju ahet coming
	option = {
		name = human_fallen_empires.702.5.0
		exclusive_trigger = {
			has_country_flag = human_fallen_empires.702.5
			exists = event_target:human_fallen_empires_egypt_country
			event_target:human_fallen_empires_egypt_country = {
				any_owned_fleet = {
					fleet_power > 30000
				}
			}
		}
		hidden_effect = {
			event_target:human_fallen_empires_egypt_country = {
				if = {
					limit = {
						not = {
							has_communications = root
						}
					}
					establish_communications_no_message = root
					root = {
						set_country_flag = human_fallen_empires_egypt_contacted
					}
				}
				random_owned_fleet = {
					limit = {
						fleet_power > 30000
					}
					set_location = {
						target = event_target:human_fallen_empires_thoth_location
						distance = 30
						angle = random
					}
				}
			}
			human_fallen_empires_effect_event_702_next = yes
		}
	}
	option = {
		name = human_fallen_empires.702.goodend
		trigger = {
			has_country_flag = human_fallen_empires.702.goodend
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.goodend
		}
	}
	# if haven't ju ahet
	option = {
		name = human_fallen_empires.702.5.1
		# trigger = {
		# 	has_country_flag = human_fallen_empires.702.5
		# 	not = {
		# 		any_country = {
		# 			has_country_flag = human_fallen_empires_egypt
		# 			any_owned_fleet = {
		# 				fleet_power > 30000
		# 			}
		# 		}
		# 	}
		# }
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.5
			set_country_flag = human_fallen_empires.702.6
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	# step 6
	option = {
		name = human_fallen_empires.702.6.0
		response_text = human_fallen_empires.702.6.0.response
		trigger = {
			has_country_flag = human_fallen_empires.702.6
			has_country_flag = human_fallen_empires_egypt_contacted
			not = {
				exists = event_target:human_fallen_empires_egypt_country
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
		}
	}
	option = {
		name = human_fallen_empires.702.6.1
		response_text = human_fallen_empires.702.6.0.response
		trigger = {
			has_country_flag = human_fallen_empires.702.6
			has_country_flag = human_fallen_empires_egypt_contacted
			event_target:human_fallen_empires_egypt_country = {
				not = {
					any_owned_fleet = {
						fleet_power > 20000
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
		}
	}
	option = {
		name = human_fallen_empires.702.6.2
		response_text = human_fallen_empires.702.6.0.response
		trigger = {
			has_country_flag = human_fallen_empires.702.6
			nand = {
				has_country_flag = human_fallen_empires_egypt_contacted
				exists = event_target:human_fallen_empires_egypt_country
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.6
		}
	}
}

# dialog with fleet
country_event = {
	id = human_fallen_empires.703
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.703.desc.6
				has_country_flag = human_fallen_empires.702.6
			}
			success_text = {
				text = human_fallen_empires.703.desc.7
				has_country_flag = human_fallen_empires.702.7
			}
			success_text = {
				text = human_fallen_empires.703.desc.goodend
				has_country_flag = human_fallen_empires.702.goodend
			}
			success_text = {
				text = human_fallen_empires.703.desc.badend.0
				has_country_flag = human_fallen_empires.702.badend
				not = {
					has_country_flag = human_fallen_empires.702.badend.0
				}
			}
			success_text = {
				text = human_fallen_empires.703.desc.badend.1
				has_country_flag = human_fallen_empires.702.badend
				has_country_flag = human_fallen_empires.702.badend.0
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_country.species
		room = human_fallen_empires_egypt_room
	}

	# step 6
	option = {
		name = human_fallen_empires.703.6.0
		trigger = {
			has_country_flag = human_fallen_empires.702.6
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	option = {
		name = human_fallen_empires.703.6.1
		trigger = {
			has_country_flag = human_fallen_empires.702.6
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.702.badend
			set_country_flag = human_fallen_empires.702.badend.0
		}
		human_fallen_empires_effect_event_702_next = yes
	}
	# step 7
	option = {
		name = human_fallen_empires.703.7.0
		custom_tooltip = human_fallen_empires.703.7.high.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.702.7
			event_target:human_fallen_empires_egypt_country = {
				or = {
					is_patronizing_to = root
					is_friendly_to = root
					is_cordial_to = root
					is_protective_to = root
				}
			}
		}
		hidden_effect = {
			random_list = {
				9 = {
					set_country_flag = human_fallen_empires.702.goodend
				}
				1 = {
					set_country_flag = human_fallen_empires.702.badend
				}
			}
			human_fallen_empires_effect_event_702_next = yes
		}
	}
	option = {
		name = human_fallen_empires.703.7.1
		custom_tooltip = human_fallen_empires.703.7.high.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.702.7
			relative_power = {
				who = event_target:human_fallen_empires_egypt_country
				category = fleet
				value > equivalent
			}
		}
		hidden_effect = {
			random_list = {
				9 = {
					set_country_flag = human_fallen_empires.702.goodend
				}
				1 = {
					set_country_flag = human_fallen_empires.702.badend
				}
			}
			human_fallen_empires_effect_event_702_next = yes
		}
	}
	option = {
		name = human_fallen_empires.703.7.2
		custom_tooltip = human_fallen_empires.703.7.high.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.702.7
			has_trait = trait_charismatic
		}
		hidden_effect = {
			random_list = {
				9 = {
					set_country_flag = human_fallen_empires.702.goodend
				}
				1 = {
					set_country_flag = human_fallen_empires.702.badend
				}
			}
			human_fallen_empires_effect_event_702_next = yes
		}
	}
	option = {
		name = human_fallen_empires.703.7.3
		custom_tooltip = human_fallen_empires.703.7.midle.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.702.7
			is_militarist = yes
		}
		hidden_effect = {
			random_list = {
				7 = {
					set_country_flag = human_fallen_empires.702.goodend
				}
				3 = {
					set_country_flag = human_fallen_empires.702.badend
				}
			}
			human_fallen_empires_effect_event_702_next = yes
		}
	}
	option = {
		name = human_fallen_empires.703.7.4
		custom_tooltip = human_fallen_empires.703.7.low.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.702.7
		}
		hidden_effect = {
			random_list = {
				5 = {
					set_country_flag = human_fallen_empires.702.goodend
				}
				5 = {
					set_country_flag = human_fallen_empires.702.badend
				}
			}
			human_fallen_empires_effect_event_702_next = yes
		}
	}
	# end
	option = {
		name = human_fallen_empires.703.goodend
		trigger = {
			has_country_flag = human_fallen_empires.702.goodend
		}
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.702
			}
		}
	}
	option = {
		name = human_fallen_empires.703.badend
		custom_tooltip = human_fallen_empires.703.badend.tooltip
		trigger = {
			has_country_flag = human_fallen_empires.702.badend
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.702.badend
			event_target:human_fallen_empires_thoth = {
				destroy_country = yes
			}
		}
	}
}

# not first contact
country_event = {
	id = human_fallen_empires.705
	title = TRANSMISSION
	desc = human_fallen_empires.705.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = human_fallen_empires_portrait_diplo_thoth
		room = human_fallen_empires_thoth_room
	}

	trigger = {
		not = {
			has_country_flag = human_fallen_empires_thoth_contacted_first
		}
		from = {
			is_country_type = human_fallen_empires_thoth
		}
	}

	immediate = {
		establish_communications = from
		set_country_flag = human_fallen_empires_thoth_contacted
	}

	option = {
		name = human_fallen_empires.705.0
		default_hide_option = yes
	}
}

# start event diplomacy
country_event = {
	id = human_fallen_empires.710
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = from
		from = {
			is_country_type = human_fallen_empires_thoth
		}
		not = {
			has_country_flag = human_fallen_empires.711_block
		}
	}

	immediate = {
		country_event = {
			id = human_fallen_empires.711
		}
		set_country_flag = human_fallen_empires.711_block
	}
}

# trade dialog
country_event = {
	id = human_fallen_empires.711
	title = TRANSMISSION
	desc = human_fallen_empires.711.desc.0.0
	desc = human_fallen_empires.711.desc.0.1
	desc = human_fallen_empires.711.desc.0.2
	desc = {
		exclusive_trigger = {
			or = {
				has_country_flag = human_fallen_empires.711.4.1
				has_country_flag = human_fallen_empires.711.4.2
				has_country_flag = human_fallen_empires.711.4.3
				has_country_flag = human_fallen_empires.711.4.4
				has_country_flag = human_fallen_empires.711.4.5
			}
		}
		trigger = {
			# dialog 0
			success_text = {
				text = human_fallen_empires.711.desc.4.1
				has_country_flag = human_fallen_empires.711.4.1
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.2
				has_country_flag = human_fallen_empires.711.4.2
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.3
				has_country_flag = human_fallen_empires.711.4.3
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.4
				has_country_flag = human_fallen_empires.711.4.4
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.5.0
				has_country_flag = human_fallen_empires.711.4.5
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
			success_text = {
				text = human_fallen_empires.711.desc.4.5.1
				has_country_flag = human_fallen_empires.711.4.5
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes
	force_open = yes

	picture_event_data = {
		portrait = human_fallen_empires_portrait_diplo_thoth
		room = human_fallen_empires_thoth_room
	}

	option = {
		name = human_fallen_empires.711.0
		allow = {
			energy >= @human_fallen_empires_thoth_module_cost
			minerals >= @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.0.response
		is_dialog_only = yes
		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.0.module_ordered
			country_event = {
				id = human_fallen_empires.712
				days = 365
			}
		}
	}
	option = {
		name = human_fallen_empires.711.1
		allow = {
			energy >= @human_fallen_empires_thoth_module_cost
			minerals >= @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.1.response
		is_dialog_only = yes
		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.1.module_ordered
			country_event = {
				id = human_fallen_empires.712
				days = 365
			}
		}
	}
	option = {
		name = human_fallen_empires.711.2
		allow = {
			energy >= @human_fallen_empires_thoth_module_cost
			minerals >= @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.2.response
		is_dialog_only = yes
		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.2.module_ordered
			country_event = {
				id = human_fallen_empires.712 days = 365
			}
		}
	}
	option = {
		name = human_fallen_empires.711.3
		allow = {
			energy >= @human_fallen_empires_thoth_module_cost
			minerals >= @human_fallen_empires_thoth_module_cost
			custom_tooltip = {
				fail_text = human_fallen_empires.711.module_ordered
				not = {
					has_country_flag = human_fallen_empires.711.module_ordered
				}
			}
		}
		response_text = human_fallen_empires.711.3.response
		is_dialog_only = yes
		add_energy = @human_fallen_empires_thoth_module_cost_minus
		add_minerals = @human_fallen_empires_thoth_module_cost_minus
		hidden_effect = {
			set_country_flag = human_fallen_empires.711.module_ordered
			set_country_flag = human_fallen_empires.711.3.module_ordered
			country_event = {
				id = human_fallen_empires.712
				days = 365
			}
		}
	}
	# dialog 0
	option = {
		name = human_fallen_empires.711.4.0
		trigger = {
			nor = {
				has_country_flag = human_fallen_empires.711.4.1
				has_country_flag = human_fallen_empires.711.4.2
				has_country_flag = human_fallen_empires.711.4.3
				has_country_flag = human_fallen_empires.711.4.4
				has_country_flag = human_fallen_empires.711.4.5
			}
		}
		human_fallen_empires_effect_event_711_next = yes
	}
	option = {
		name = human_fallen_empires.711.4.1
		trigger = {
			has_country_flag = human_fallen_empires.711.4.1
		}
		human_fallen_empires_effect_event_711_next = yes
	}
	option = {
		name = human_fallen_empires.711.4.2
		trigger = {
			has_country_flag = human_fallen_empires.711.4.2
		}
		human_fallen_empires_effect_event_711_next = yes
	}
	option = {
		name = human_fallen_empires.711.4.3
		trigger = {
			has_country_flag = human_fallen_empires.711.4.3
		}
		human_fallen_empires_effect_event_711_next = yes
	}
	option = {
		name = human_fallen_empires.711.4.4.0
		trigger = {
			has_country_flag = human_fallen_empires.711.4.4
			any_relation = {
				has_country_flag = human_fallen_empires_egypt
			}
		}
		human_fallen_empires_effect_event_711_next = yes
	}
	option = {
		name = human_fallen_empires.711.4.4.1
		trigger = {
			has_country_flag = human_fallen_empires.711.4.4
			not = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
		}
		human_fallen_empires_effect_event_711_next = yes
	}
	option = {
		name = human_fallen_empires.711.4.5
		trigger = {
			has_country_flag = human_fallen_empires.711.4.5
		}
		response_text = human_fallen_empires.711.4.5.response
		is_dialog_only = yes
		allow = {
			hidden_trigger = {
				not = {
					has_country_flag = human_fallen_empires.711.dialog.0.complete
				}
			}
		}
		enable_special_project = {
			name = human_fallen_empires_project_thoth_memory
			location = event_target:human_fallen_empires_thoth_location
			owner = root
		}
		if = {
			limit = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
			enable_special_project = {
				name = human_fallen_empires_project_thoth_egypt_contact
				location = root.capital_scope
				owner = root
			}
		}
		human_fallen_empires_effect_event_711_next = yes
	}
	option = {
		name = human_fallen_empires.711.5
		trigger = {
			has_country_flag = human_fallen_empires.711.dialog.0.complete
		}
		response_text = human_fallen_empires.711.5.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires_end_transmission
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711_block
		}
	}
}

# complete module
country_event = {
	id = human_fallen_empires.712
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.712.desc.0
				has_country_flag = human_fallen_empires.711.0.module_ordered
			}
			success_text = {
				text = human_fallen_empires.712.desc.1
				has_country_flag = human_fallen_empires.711.1.module_ordered
			}
			success_text = {
				text = human_fallen_empires.712.desc.2
				has_country_flag = human_fallen_empires.711.2.module_ordered
			}
			success_text = {
				text = human_fallen_empires.712.desc.3
				has_country_flag = human_fallen_empires.711.3.module_ordered
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes
	force_open = yes

	picture_event_data = {
		portrait = human_fallen_empires_portrait_diplo_thoth
		room = human_fallen_empires_thoth_room
	}

	immediate = {
		switch = {
			trigger = has_country_flag
			human_fallen_empires.711.0.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_energy
					value = 1
				}
			}
			human_fallen_empires.711.1.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_mineral
					value = 1
				}
			}
			human_fallen_empires.711.2.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_food
					value = 1
				}
			}
			human_fallen_empires.711.3.module_ordered = {
				change_variable = {
					which = human_fallen_empires_building_thoth_module_science
					value = 1
				}
			}
		}
	}

	option = {
		name = human_fallen_empires.712.0
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.module_ordered
			remove_country_flag = human_fallen_empires.711.0.module_ordered
			remove_country_flag = human_fallen_empires.711.1.module_ordered
			remove_country_flag = human_fallen_empires.711.2.module_ordered
			remove_country_flag = human_fallen_empires.711.3.module_ordered
			country_event = {
				id = human_fallen_empires.711
			}
		}
	}
	option = {
		name = human_fallen_empires.712.1
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.711.module_ordered
			remove_country_flag = human_fallen_empires.711.0.module_ordered
			remove_country_flag = human_fallen_empires.711.1.module_ordered
			remove_country_flag = human_fallen_empires.711.2.module_ordered
			remove_country_flag = human_fallen_empires.711.3.module_ordered
		}
	}
}

# memory installed
ship_event = {
	id = human_fallen_empires.720
	title = human_fallen_empires.720.name
	desc = human_fallen_empires.720.desc
	picture = GFX_evt_human_fallen_empires_thoth
	show_sound = event_ship_thrusters
	location = root
	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = human_fallen_empires_thoth_memory_installed
		}
	}

	option = {
		name = human_fallen_empires.720.0
	}
	option = {
		name = human_fallen_empires.720.1
		hidden_effect = {
			random_list = {
				1 = {
					owner = {
						set_country_flag = human_fallen_empires_thoth_memory_installed_spy
					}
				}
				1 = {
					owner = {
						country_event = {
							id = human_fallen_empires.721
							days = 10
						}
					}
				}
			}
		}
	}
}

# fail
country_event = {
	id = human_fallen_empires.721
	title = TRANSMISSION
	desc = human_fallen_empires.721.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = human_fallen_empires_portrait_diplo_thoth
		room = human_fallen_empires_thoth_room
	}

	option = {
		name = human_fallen_empires.721.0
		default_hide_option = yes
	}
}

# contact with ju ahet
country_event = {
	id = human_fallen_empires.725
	title = TRANSMISSION
	desc = human_fallen_empires.725.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_egypt_species
		room = human_fallen_empires_egypt_room
	}

	option = {
		name = human_fallen_empires.725.0
		response_text = human_fallen_empires.725.0.response
		default_hide_option = yes
	}
}

# kill country then station killed
# This = owner of ship 1 (destroyed)
# From = owner of ship 2 (combatant)
# FromFrom = ship 1
# FromFromFrom = ship 2
country_event = {
	id = human_fallen_empires.726
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_country_flag = human_fallen_empires_thoth
		fromfrom = {
			has_ship_flag = human_fallen_empires_thoth_station
		}
	}

	immediate = {
		destroy_country = yes
	}
}

# A fleet has entered a system
# Scope = Fleet
# From = System
# on_entering_system_fleet
# try to relocate if hostiles enter system 727 - 729
fleet_event = {
	id = human_fallen_empires.727
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ship_class = shipclass_military
		exists = event_target:human_fallen_empires_thoth
		exists = event_target:human_fallen_empires_thoth_station
		exists = solar_system
	}

	immediate = {
		solar_system = {
			every_fleet_in_system = {
				limit = {
					has_fleet_flag = human_fallen_empires_thoth_station
					exists = owner
					owner = {
						is_hostile = root.owner
					}
				}
				owner = {
					random_relation = {
						limit = {
							not = {
								is_hostile = event_target:human_fallen_empires_thoth
							}
							any_system_within_border = {
								not = {
									any_ship_in_system = {
										exists = owner
										owner = {
											is_hostile = event_target:human_fallen_empires_thoth
										}
									}
								}
							}
						}
						weights = {
							base = 1
							modifier = {
								add = 1000
								is_ai = no
							}
						}
						random_system_within_border = {
							limit = {
								not = {
									any_ship_in_system = {
										exists = owner
										owner = {
											is_hostile = event_target:human_fallen_empires_thoth
										}
									}
								}
							}
							random_system_planet = {
								event_target:human_fallen_empires_thoth_station = {
									set_location = {
										target = prev
										distance = 10
									}
								}
							}
						}
						country_event = {
							id = human_fallen_empires.728
						}
					}
				}
			}
		}
	}
}

# This = owner of fleet 1
# From = owner of fleet 2
# FromFrom = fleet 1
# FromFromFrom = fleet 2
# on_entering_battle
country_event = {
	id = human_fallen_empires.728
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = fromfrom
	}

	immediate = {
		fromfrom = {
			fleet_event = {
				id = human_fallen_empires.727
			}
		}
	}
}

# notification dialog
country_event = {
	id = human_fallen_empires.729
	title = human_fallen_empires.729.name
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.729.desc.0
				has_country_flag = human_fallen_empires.729.1
			}
			success_text = {
				text = human_fallen_empires.729.desc.1
				has_country_flag = human_fallen_empires.729.1
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = human_fallen_empires_portrait_diplo_thoth
		room = human_fallen_empires_thoth_room
	}

	trigger = {
		is_ai = no
	}

	option = {
		name = human_fallen_empires.729.0.0
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.729.1
			}
		}
		default_hide_option = yes
		hidden_effect = {
			set_country_flag = human_fallen_empires.729.1
			country_event = {
				id = human_fallen_empires.729
			}
		}
	}
	option = {
		name = human_fallen_empires.729.0.1
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.729.1
			}
			# проверить
			or = {
				has_ethic = ethic_gestalt_consciousness
				always = yes
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.729.1
			set_country_flag = human_fallen_empires.729.1.0
			country_event = {
				id = human_fallen_empires.729
			}
		}
	}
	option = {
		name = human_fallen_empires.729.1.0
		trigger = {
			has_country_flag = human_fallen_empires.729.1
			not = {
				has_country_flag = human_fallen_empires.729.1.0
			}
		}
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.729.1
		}
	}
	option = {
		name = human_fallen_empires.729.1.1
		trigger = {
			has_country_flag = human_fallen_empires.729.1
			has_country_flag = human_fallen_empires.729.1.0
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.729.1
			remove_country_flag = human_fallen_empires.729.1.0
		}
	}
}

# Kad Republic section
# 5000-10000
# functional on actions events 5000 - 5050
# contact dialog with future 5000 - 5002
country_event = {
	id = human_fallen_empires.5000
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		exists = from
		from = {
			is_country_type = human_fallen_empire
			has_country_flag = human_fallen_empires_future
		}
	}

	immediate = {
		from = {
			establish_communications = root
			while = {
				limit = {
					nand = {
						any_owned_leader = {
							gender = female
						}
						any_owned_leader = {
							gender = male
						}
					}
				}
				create_leader = {
					type = admiral
					species = this
					skill = 1
				}
			}
			random_owned_leader = {
				limit = {
					gender = female
				}
				save_event_target_as = human_fallen_empires_female_leader
			}
			random_owned_leader = {
				limit = {
					gender = male
					leader_class = admiral
				}
				save_event_target_as = human_fallen_empires_male_leader
			}
		}
		if = {
			limit = {
				is_ai = no
			}
			set_country_flag = human_fallen_empires.5001.step0
			country_event = {
				id = human_fallen_empires.5001
			}
		}
		set_country_flag = human_fallen_empires_future_contacted
	}
}

# main dialog
country_event = {
	id = human_fallen_empires.5001
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.5001.desc.0
				has_country_flag = human_fallen_empires.5001.step0
			}
			success_text = {
				text = human_fallen_empires.5001.desc.1
				has_country_flag = human_fallen_empires.5001.step1
			}
			success_text = {
				text = human_fallen_empires.5001.desc.2
				has_country_flag = human_fallen_empires.5001.step2
			}
			success_text = {
				text = human_fallen_empires.5001.desc.3
				has_country_flag = human_fallen_empires.5001.step3
			}
			success_text = {
				text = human_fallen_empires.5001.desc.4
				has_country_flag = human_fallen_empires.5001.step4
			}
			success_text = {
				text = human_fallen_empires.5001.desc.5
				has_country_flag = human_fallen_empires.5001.step5
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_female_leader
		room = human_fallen_empires_future_room
	}

	# step 0
	option = {
		name = human_fallen_empires.5001.0.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			any_relation = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = yes
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.0.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			any_relation = {
				has_country_flag = human_fallen_empires_egypt
			}
			has_country_flag = human_fallen_empires_marked_as_human
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.0.2
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.0.3
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				any_relation = {
					has_country_flag = human_fallen_empires_egypt
				}
			}
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.0.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.0.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step0
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.0.6
		trigger = {
			is_xenophobe = no
			is_xenophile = no
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.0.7
		trigger = {
			is_materialist = yes
			has_country_flag = human_fallen_empires.5001.step0
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		add_energy = 500
		human_fallen_empires_effect_event_5001_next = yes
	}
	# step 1
	option = {
		name = human_fallen_empires.5001.1.0
		trigger = {
			has_country_flag = human_fallen_empires_marked_as_human
			has_country_flag = human_fallen_empires.5001.step1
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.5001.step2.human
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.1.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.1.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.1.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.1.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step1
			is_xenophobe = no
			is_xenophile = no
			is_spiritualist = no
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	# step 2
	option = {
		name = human_fallen_empires.5001.2.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			has_country_flag = human_fallen_empires.5001.step2.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2.human
			set_country_flag = human_fallen_empires.5001.step3.human
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.2.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			not = {
				has_country_flag = human_fallen_empires.5001.step2.human
			}
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.2.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			is_xenophobe = yes
			not = {
				has_country_flag = human_fallen_empires.5001.step2.human
			}
		}
		human_fallen_empires_effect_xenophobe_attraction.1 = yes
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
		}
	}
	option = {
		name = human_fallen_empires.5001.2.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step2
			is_xenophobe = no
			not = {
				has_country_flag = human_fallen_empires.5001.step2.human
			}
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step2
		}
	}
	# step 3
	option = {
		name = human_fallen_empires.5001.3.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			has_country_flag = human_fallen_empires.5001.step3.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step3.human
			set_country_flag = human_fallen_empires.5001.step4.human
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.3.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step3
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	# step 4
	option = {
		name = human_fallen_empires.5001.4.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			has_country_flag = human_fallen_empires.5001.step4.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step4.human
			set_country_flag = human_fallen_empires.5001.step5.human
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.4.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step4
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	# step 5
	option = {
		name = human_fallen_empires.5001.5.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			has_country_flag = human_fallen_empires.5001.step5.human
		}
		hidden_effect = {
			remove_country_flag = human_fallen_empires.5001.step5.human
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.2
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.3
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.4
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.5
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.6
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_pacifist = yes
		}
		human_fallen_empires_effect_pacifist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.7
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_spiritualist = yes
		}
		human_fallen_empires_effect_spiritualist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.5.8
		trigger = {
			has_country_flag = human_fallen_empires.5001.step5
			is_materialist = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
		human_fallen_empires_effect_event_5001_next = yes
	}
}

# part 2 for male portrait
country_event = {
	id = human_fallen_empires.5002
	title = TRANSMISSION
	desc = {
		trigger = {
			success_text = {
				text = human_fallen_empires.5001.desc.6.1
				has_country_flag = human_fallen_empires.5001.step6
				is_species_class = HUM
			}
			success_text = {
				text = human_fallen_empires.5001.desc.6.2
				has_country_flag = human_fallen_empires.5001.step6
				not = {
					is_species_class = HUM
				}
			}
			success_text = {
				text = human_fallen_empires.5001.desc.7
				has_country_flag = human_fallen_empires.5001.step7
			}
		}
	}
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_male_leader
		room = human_fallen_empires_future_room
	}

	# step 6
	option = {
		name = human_fallen_empires.5001.6.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step6
			is_species_class = HUM
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.6.1
		trigger = {
			has_country_flag = human_fallen_empires.5001.step6
			not = {
				is_species_class = HUM
			}
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
	option = {
		name = human_fallen_empires.5001.7.0
		trigger = {
			has_country_flag = human_fallen_empires.5001.step7
		}
		human_fallen_empires_effect_event_5001_next = yes
	}
}

# awake make future default country, start expansion era 5010 - 5012
country_event = {
	id = human_fallen_empires.5010
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		not = {
			has_global_flag = human_fallen_empires_future_in_expansion
		}
		or = {
			mid_game_years_passed > 50
			end_game_years_passed > 0
		}
		or = {
			has_global_flag = galactic_crisis_happened
			has_global_flag = human_fallen_empires_war_in_heaven_started
			recently_lost_war = yes
			any_country = {
				is_country_type = default
				or = {
					and = {
						is_difficulty > 0
						relative_power = {
							who = root
							category = fleet
							value >= inferior
						}
					}
					relative_power = {
						who = root
						category = fleet
						value >= equivalent
					}
				}
			}
		}
	}

	immediate = {
		add_modifier = {
			modifier = human_fallen_empires_navy_size
			days = 3600
		}
		country_remove_ethic = ethic_fanatic_pacifist
		country_add_ethic = ethic_fanatic_militarist
		country_add_ethic = ethic_egalitarian
		change_government = {
			authority = auth_democratic
			civics = random
		}
		every_owned_pop = {
			limit = {
				has_ethic = ethic_pacifist
			}
			pop_change_ethic = ethic_militarist
		}
		kill_leader = {
			type = ruler
			show_notification = no
		}
		create_leader = {
			type = ruler
		}
		assign_leader = last_created_leader
		# добавить потом убийство лидера и добавление нового
		set_country_type = default
		set_global_flag = human_fallen_empires_future_in_expansion
		every_playable_country = {
			establish_communications_no_message = root
			if = {
				limit = {
					is_ai = no
				}
				country_event = {
					id = human_fallen_empires.5011
				}
			}
		}
	}
}

# future expansion notification
country_event = {
	id = human_fallen_empires.5011
	title = human_fallen_empires.5011.name
	desc = human_fallen_empires.5011.desc.0
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future_country.ruler
		room = human_fallen_empires_future_room
	}

	option = {
		name = human_fallen_empires.5011.0
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = human_fallen_empires_future_contacted
				}
				custom_tooltip = human_fallen_empires.5011.0.tooltip
				if = {
					limit = {
						can_be_subject = {
							overlord = event_target:human_fallen_empires_future_country
							subject_type = human_fallen_empires_future_vassal
						}
					}
					country_event = {
						id = human_fallen_empires.5012
						days = 10
						random = 15
					}
				}
			}
			else = {
				set_country_flag = human_fallen_empires_future_contacted
			}
		}
	}
}

# future expansion notification invite
country_event = {
	id = human_fallen_empires.5012
	title = TRANSMISSION
	desc = human_fallen_empires.5012.desc
	diplomatic = yes
	show_sound = placeholder_sfx
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future_country
		room = human_fallen_empires_future_room
	}

	option = {
		name = human_fallen_empires.5012.0
		set_subject_of = {
			who = event_target:human_fallen_empires_future_country
			subject_type = human_fallen_empires_future_vassal
		}
		human_fallen_empires_effect_advisor_future_on = yes
		play_sound = event_celebration
	}
	option = {
		name = human_fallen_empires.5012.1
		default_hide_option = yes
	}
}

# assimilation event (turn regular subject into coalition member subject type) 5020 - 5021
country_event = {
	id = human_fallen_empires.5020
	hide_window = yes
	is_triggered_only = yes

	# trigger = {
	# 	any_subject = {
	# 		not = {
	# 			is_subject_type = human_fallen_empires_future_vassal
	# 		}
	# 	}
	# }

	immediate = {
		every_subject = {
			limit = {
				not = {
					is_subject_type = human_fallen_empires_future_vassal
				}
			}
			set_subject_of = {
				who = root
				subject_type = human_fallen_empires_future_vassal
			}
			country_event = {
				id = human_fallen_empires.5021
			}
		}
	}
}

# inform player
country_event = {
	id = human_fallen_empires.5021
	title = human_fallen_empires.5021.name
	desc = human_fallen_empires.5021.desc
	show_sound = placeholder_sfx
	picture = {
		trigger = {
			has_country_flag = human_fallen_empires_random_0
		}
		picture = GFX_evt_human_fallen_empires_coalition
	}
	picture = {
		trigger = {
			has_country_flag = human_fallen_empires_random_1
		}
		picture = GFX_evt_galactic_senate
	}
	show_sound = event_administrative_work
	is_triggered_only = yes

	trigger = {
		is_ai = no
	}

	immediate = {
		human_fallen_empires_effect_random_roll_flags_2_country = yes
	}

	option = {
		name = human_fallen_empires.5021.0
		human_fallen_empires_effect_advisor_future_on = yes
	}
}

# anomalies and after survey on actions 5050 - 5100
# criopods anomaly 5050 - 5055
# switch to country
ship_event = {
	id = human_fallen_empires.5050
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		from = {
			human_fallen_empires_effect_remove_signal_object_from_this = yes
			save_event_target_as = human_fallen_empires_criopods_planet
		}
		owner = {
			country_event = {
				id = human_fallen_empires.5051
			}
		}
	}
}

# main event
country_event = {
	id = human_fallen_empires.5051
	title = human_fallen_empires.5051.name
	desc = {
		trigger = {
			# step 0
			# have contact
			success_text = {
				text = human_fallen_empires.5051.desc.0.0
				has_country_flag = human_fallen_empires_future_contacted
			}
			# havent contact
			fail_text = {
				text = human_fallen_empires.5051.desc.0.1
				has_country_flag = human_fallen_empires_future_contacted
			}
			# human addition
			success_text = {
				text = human_fallen_empires.5051.desc.0.2
				not = {
					has_country_flag = human_fallen_empires_future_contacted
				}
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# step 1
			text = human_fallen_empires.5051.desc.1.0
			# step 2
			# human
			# have contact
			success_text = {
				text = human_fallen_empires.5051.desc.2.0
				has_country_flag = human_fallen_empires_future_contacted
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# havent contact
			success_text = {
				text = human_fallen_empires.5051.desc.2.1
				not = {
					has_country_flag = human_fallen_empires_future_contacted
				}
				has_country_flag = human_fallen_empires_marked_as_human
			}
			# non human
			# xenophobe
			success_text = {
				text = human_fallen_empires.5051.desc.2.2
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophobe = yes
			}
			# xenophile
			success_text = {
				text = human_fallen_empires.5051.desc.2.3
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophile = yes
			}
			# authoritarian
			success_text = {
				text = human_fallen_empires.5051.desc.2.4
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophobe = no
				is_xenophile = no
				human_fallen_empires_trigger_is_authoritarian = yes
			}
			# egalitarian
			success_text = {
				text = human_fallen_empires.5051.desc.2.5
				not = {
					has_country_flag = human_fallen_empires_marked_as_human
				}
				is_xenophobe = no
				is_xenophile = no
				is_egalitarian = yes
			}
		}
	}
	picture = {
		trigger = {
			is_xenophobe = yes
		}
		picture = GFX_evt_clones
	}
	picture = {
		trigger = {
			has_country_flag = human_fallen_empires_random_0
		}
		picture = GFX_evt_human_fallen_empires_criopods
	}
	picture = {
		trigger = {
			has_country_flag = human_fallen_empires_random_1
		}
		picture = GFX_evt_human_fallen_empires_colony_new
	}
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_criopods_planet
	is_triggered_only = yes

	immediate = {
		human_fallen_empires_effect_random_roll_flags_2_country = yes
	}

	option = {
		name = human_fallen_empires.5051.0
		trigger = {
			has_country_flag = human_fallen_empires_future_contacted
			has_country_flag = human_fallen_empires_marked_as_human
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.1
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_future_contacted
			}
			has_country_flag = human_fallen_empires_marked_as_human
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.2
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = yes
			is_homicidal = no
		}
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.3
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.3 = yes
	}
	option = {
		name = human_fallen_empires.5051.4
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.5
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = no
			is_xenophile = no
			human_fallen_empires_trigger_is_authoritarian = yes
		}
		human_fallen_empires_effect_authoritarian_attraction.0 = yes
		event_target:human_fallen_empires_criopods_planet = {
			create_pop = {
				species = event_target:human_fallen_empires_future_species
			}
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5051.6
		trigger = {
			not = {
				has_country_flag = human_fallen_empires_marked_as_human
			}
			is_xenophobe = no
			is_xenophile = no
			is_egalitarian = yes
		}
		human_fallen_empires_effect_egalitarian_attraction.0 = yes
		hidden_effect = {
			human_fallen_empires_effect_random_roll_flags_3_country = yes
			country_event = {
				id = human_fallen_empires.5052
				days = 15
				random = 15
			}
		}
	}
}

# step 2 for egalitarian
country_event = {
	id = human_fallen_empires.5052
	title = human_fallen_empires.5052.name
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				human_fallen_empires_random_0 = {
					text = human_fallen_empires.5052.desc.1
				}
				human_fallen_empires_random_1 = {
					text = human_fallen_empires.5052.desc.2
				}
				human_fallen_empires_random_2 = {
					text = human_fallen_empires.5052.desc.3
				}
			}
		}
	}
	picture = GFX_evt_human_fallen_empires_colony_new
	show_sound = event_mystic_reveal
	location = event_target:human_fallen_empires_criopods_planet
	is_triggered_only = yes

	immediate = {
		event_target:human_fallen_empires_criopods_planet = {
			create_country = {
				type = default
				species = event_target:human_fallen_empires_future_species
				ethos = {
					ethic = ethic_fanatic_egalitarian
					ethic = ethic_militarist
				}
				effect = {
					human_fallen_empires_effect_gov_fix = yes
					prev = {
						create_colony = {
							owner = prev
						}
					}
					establish_communications_no_message = root
				}
			}
			# to fix create colony spawn pop of root species bug
			every_owned_pop = {
				kill_pop = yes
			}
			create_pop = {
				species = owner
			}
		}
	}

	option = {
		name = human_fallen_empires.5052.1
		trigger = {
			has_country_flag = human_fallen_empires_random_0
		}
		event_target:human_fallen_empires_criopods_planet = {
			set_owner = root
		}
	}
	option = {
		name = human_fallen_empires.5052.2
		trigger = {
			has_country_flag = human_fallen_empires_random_1
		}
		event_target:human_fallen_empires_criopods_planet.owner = {
			set_subject_of = {
				who = root
				subject_type = protectorate
			}
		}
	}
	option = {
		name = human_fallen_empires.5052.3
		trigger = {
			has_country_flag = human_fallen_empires_random_2
		}
	}
	option = {
		name = human_fallen_empires.5052.4
		trigger = {
			has_country_flag = human_fallen_empires_random_2
			is_militarist = yes
		}
		human_fallen_empires_effect_militarist_attraction.1 = yes
		declare_war = {
			target = event_target:human_fallen_empires_criopods_planet.owner
			attacker_war_goal = human_fallen_empires_wg_annex
		}
	}
}

# dead worms anomaly 5055 - 5057
# start
ship_event = {
	id = human_fallen_empires.5055
	title = human_fallen_empires.5055.name
	desc = human_fallen_empires.5055.desc
	picture = GFX_evt_human_fallen_empires_space_debris
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	immediate = {
		from = {
			human_fallen_empires_effect_remove_signal_object_from_this = yes
		}
	}

	option = {
		name = human_fallen_empires_at_the_sreen
		human_fallen_empires_effect_leader_add_exp_200 = yes
		hidden_effect = {
			owner = {
				country_event = {
					id = human_fallen_empires.5056
				}
			}
		}
	}
}

# diplo event
country_event = {
	id = human_fallen_empires.5056
	title = human_fallen_empires.5056.name
	desc = human_fallen_empires.5056.desc
	show_sound = olafur_arnalds_only_the_winds
	is_triggered_only = yes
	diplomatic = yes

	immediate = {
		#	play_sound = olafur_arnalds_only_the_winds
	}

	picture_event_data = {
		room = human_fallen_empires_dead_worms_room
	}

	option = {
		name = human_fallen_empires.5056.0
		response_text = human_fallen_empires.5056.0.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.5056.1
		response_text = human_fallen_empires.5056.1.response
		is_dialog_only = yes
	}
	option = {
		name = human_fallen_empires.5056.2
		hidden_effect = {
			country_event = {
				id = human_fallen_empires.5057
			}
		}
	}
}

# for pic
country_event = {
	id = human_fallen_empires.5057
	title = human_fallen_empires.5056.name
	desc = human_fallen_empires.5056.2.response
	#show_sound = event_space_battle
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = human_fallen_empires_bombardment_room
	}

	option = {
		name = human_fallen_empires.5056.3
		trigger = {
			is_xenophobe = yes
		}
		human_fallen_empires_effect_xenophobe_attraction.0 = yes
	}
	option = {
		name = human_fallen_empires.5056.4
		trigger = {
			is_xenophile = yes
		}
		human_fallen_empires_effect_xenophile_attraction.0 = yes
	}
	option = {
		name = human_fallen_empires.5056.5
		trigger = {
			human_fallen_empires_trigger_is_clever_for_event = yes
		}
		human_fallen_empires_effect_materialist_attraction.0 = yes
	}
	option = {
		name = human_fallen_empires.5056.6
		trigger = {
			is_xenophobe = no
			is_xenophile = no
			human_fallen_empires_trigger_is_clever_for_event = no
		}
	}
}

# necrotic autoevolution 5060
# after anomaly or if survey planet there someone get anomaly
ship_event = {
	id = human_fallen_empires.5060
	title = human_fallen_empires.5060.name
	desc = {
		trigger = {
			text = human_fallen_empires.5060.desc.0
			text = newline
			success_text = {
				text = human_fallen_empires.5060.desc.1.0
				owner = {
					has_country_flag = human_fallen_empires_future_contacted
				}
			}
			fail_text = {
				text = human_fallen_empires.5060.desc.1.1
				owner = {
					has_country_flag = human_fallen_empires_future_contacted
				}
			}
			text = newline
			text = human_fallen_empires.5060.desc.2
		}
	}
	picture = GFX_evt_human_fallen_empires_ruins_robots
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		exists = from
		exists = owner
	}

	immediate = {
		from = {
			human_fallen_empires_effect_remove_signal_object_from_this = yes
			add_modifier = {
				modifier =  human_fallen_empires_necrotic_autoevolution
			}
			orbital_deposit_tile = {
				set_deposit = human_fallen_empires_deposit_necrotic_autoevolution_0
			}
		}
		owner = {
			country_event = {
				id = human_fallen_empires.5070
			}
		}
	}

	option = {
		name = human_fallen_empires.5060.0
		trigger = {
			owner = {
				is_militarist = yes
			}
		}
		owner = {
			human_fallen_empires_effect_militarist_attraction.0 = yes
		}
	}
	option = {
		name = human_fallen_empires.5060.1
		trigger = {
			owner = {
				is_pacifist = yes
			}
		}
		owner = {
			human_fallen_empires_effect_pacifist_attraction.0 = yes
		}
	}
	option = {
		name = human_fallen_empires.5060.2
		trigger = {
			owner = {
				is_xenophobe = yes
			}
		}
		owner = {
			human_fallen_empires_effect_xenophobe_attraction.0 = yes
		}
	}
	option = {
		name = human_fallen_empires.5060.3
		trigger = {
			owner = {
				is_militarist = no
				is_pacifist = no
				is_xenophobe = no
			}
		}
	}
}

# then mining station build
ship_event = {
	id = human_fallen_empires.5061
	title = human_fallen_empires.5061.name
	desc = human_fallen_empires.5061.desc
	picture = GFX_evt_human_fallen_empires_ruins_robots
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes

	trigger = {
		exists = owner
		from = {
			has_modifier = human_fallen_empires_necrotic_autoevolution
			not = {
				orbital_deposit_tile = {
					has_deposit = human_fallen_empires_deposit_necrotic_autoevolution_1
				}
			}
		}
	}

	immediate = {
		from = {
			orbital_deposit_tile = {
				set_deposit = human_fallen_empires_deposit_necrotic_autoevolution_1
			}
		}
	}

	option = {
		name = human_fallen_empires.5061.0
		owner = {
			human_fallen_empires_effect_materialist_attraction.0 = yes
		}
	}
}

# find kad republic chain 5070
country_event = {
	id = human_fallen_empires.5070
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = event_target:human_fallen_empires_future_country
		nor = {
			has_event_chain = human_fallen_empires_chain_find_future_star
			event_target:human_fallen_empires_future_country = {
				has_communications = root
			}
		}
		is_ai = no
	}

	immediate = {
		begin_event_chain = {
			event_chain = human_fallen_empires_chain_find_future_star
			target = root
		}
		event_target:human_fallen_empires_future_country.capital_scope.solar_system = {
			set_star_flag = human_fallen_empires_chain_find_future_star@root
			root = {
				create_point_of_interest = {
					id = human_fallen_empires_chain_find_future_star.0
					name = human_fallen_empires_chain_find_future_star_name.0
					desc = human_fallen_empires_chain_find_future_star_desc.0
					event_chain = human_fallen_empires_chain_find_future_star
					location = prev
				}
			}
		}
	}
}

# end chain then contacted
country_event = {
	id = human_fallen_empires.5071
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_event_chain = human_fallen_empires_chain_find_future_star
		exists = from
		exists = event_target:human_fallen_empires_future_country
		from = {
			is_country = event_target:human_fallen_empires_future_country
		}
	}

	immediate = {
		end_event_chain = human_fallen_empires_chain_find_future_star
	}
}

# other dialogs 5100 - 5200
# buy robots 5100
country_event = {
	id = human_fallen_empires.5100
	title = TRANSMISSION
	desc = {
		trigger = {
			fail_text = {
				text = human_fallen_empires.5100.desc.0
				has_country_flag = human_fallen_empires.5100.step1
			}
			success_text = {
				text = human_fallen_empires.5100.desc.1
				has_country_flag = human_fallen_empires.5100.step1
			}
		}
	}
	#	show_sound = event_alien_signal
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		portrait = event_target:human_fallen_empires_future_country
		room = human_fallen_empires_future_room
	}

	trigger = {
		any_owned_pop = {
			has_trait = trait_mechanical
		}
		exists = event_target:human_fallen_empires_future_country
	}

	immediate = {
		set_country_flag = human_fallen_empires_future_try_take_robot
	}

	option = {
		name = human_fallen_empires.5100.0
		trigger = {
			not = {
				has_policy_flag = ai_full_rights
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_army_trained_by_future
		}
		hidden_effect = {
			set_global_flag = human_fallen_empires_future_take_robot
			random_owned_pop = {
				limit = {
					has_trait = trait_mechanical
				}
				save_event_target_as = human_fallen_empires_settle_pop_target
			}
			event_target:human_fallen_empires_future_country = {
				human_fallen_empires_effect_settle_pop = yes
			}
		}
		custom_tooltip = human_fallen_empires.5100.yes.tooltip
	}
	option = {
		name = human_fallen_empires.5100.1
		trigger = {
			or = {
				is_xenophobe = yes
				is_authoritarian = yes
			}
			has_policy_flag = ai_full_rights
		}
		add_modifier = {
			modifier = human_fallen_empires_army_trained_by_future
		}
		hidden_effect = {
			set_global_flag = human_fallen_empires_future_take_robot
			random_owned_pop = {
				limit = {
					has_trait = trait_mechanical
				}
				save_event_target_as = human_fallen_empires_settle_pop_target
			}
			event_target:human_fallen_empires_future_country = {
				human_fallen_empires_effect_settle_pop = yes
			}
		}
		custom_tooltip = human_fallen_empires.5100.yes.tooltip
	}
	option = {
		name = human_fallen_empires.5100.2
		trigger = {
			is_xenophobe = no
			is_authoritarian = no
			has_policy_flag = ai_full_rights
		}
		response_text = human_fallen_empires.5100.no.response
	}
	option = {
		name = human_fallen_empires.5100.3
		response_text = human_fallen_empires.5100.no.response
	}
	option = {
		name = human_fallen_empires.5100.4
		trigger = {
			not = {
				has_country_flag = human_fallen_empires.5100.step1
			}
		}
		hidden_effect = {
			set_country_flag = human_fallen_empires.5100.step1
			country_event = {
				id = human_fallen_empires.5100
			}
		}
	}
	option = {
		name = human_fallen_empires.5100.5
		trigger = {
			has_country_flag = human_fallen_empires.5100.step1
		}
		response_text = human_fallen_empires.5100.5.response
		is_dialog_only = yes
	}
}
