#
@tier1unityreward = 6
@tier1unitymin = 100
@tier1unitymax = 500
@tier2unityreward = 12
@tier2unitymin = 150
@tier2unitymax = 1000
@tier3unityreward = 18
@tier3unitymin = 250
@tier3unitymax = 1500
@tier4unityreward = 24
@tier4unitymin = 350
@tier4unitymax = 2000
@tier5unityreward = 48
@tier5unitymin = 700
@tier5unitymax = 4000

@tier1materialreward = 6
@tier1materialmin = 100
@tier1materialmax = 500
@tier2materialreward = 12
@tier2materialmin = 150
@tier2materialmax = 1000
@tier3materialreward = 18
@tier3materialmin = 250
@tier3materialmax = 1500
@tier4materialreward = 24
@tier4materialmin = 350
@tier4materialmax = 2000
@tier5materialreward = 48
@tier5materialmin = 700
@tier5materialmax = 4000

@tier1influencereward = 6
@tier1influencemin = 40
@tier1influencemax = 100
@tier2influencereward = 12
@tier2influencemin = 80
@tier2influencemax = 175
@tier3influencereward = 18
@tier3influencemin = 125
@tier3influencemax = 250
@tier4influencereward = 24
@tier4influencemin = 150
@tier4influencemax = 300
@tier5influencereward = 36
@tier5influencemin = 250
@tier5influencemax = 500
@tier6influencereward = 48
@tier6influencemin = 300
@tier6influencemax = 600

@tier1researchreward = 6
@tier1researchmin = 60
@tier1researchmax = 150
@tier2researchreward = 12
@tier2researchmin = 90
@tier2researchmax = 250
@tier3researchreward = 18
@tier3researchmin = 120
@tier3researchmax = 350
@tier4researchreward = 24
@tier4researchmin = 150
@tier4researchmax = 500
@tier5researchreward = 48
@tier5researchmin = 300
@tier5researchmax = 1000

# for country, primitive
human_fallen_empires_effect_down_primitive_teh_lvl = {
	owner = {
		switch = {
			trigger = has_country_flag

			stone_age = { }

			bronze_age = {
				remove_country_flag = bronze_age
				set_country_flag = stone_age
				set_primitive_age = stone_age
			}

			iron_age = {
				remove_country_flag = iron_age
				set_country_flag = bronze_age
				set_primitive_age = bronze_age
			}

			late_medieval_age = {
				remove_country_flag = late_medieval_age
				set_country_flag = iron_age
				set_primitive_age = iron_age
			}

			renaissance_age = {
				remove_country_flag = renaissance_age
				set_country_flag = late_medieval_age
				set_primitive_age = late_medieval_age
			}

			steam_age = {
				remove_country_flag = steam_age
				set_country_flag = renaissance_age
				set_primitive_age = renaissance_age
			}

			industrial_age = {
				remove_country_flag = industrial_age
				set_country_flag = steam_age
				set_primitive_age = steam_age
			}

			machine_age = {
				remove_country_flag = machine_age
				set_country_flag = industrial_age
				set_primitive_age = industrial_age
			}

			atomic_age = {
				remove_country_flag = atomic_age
				set_country_flag = machine_age
				set_primitive_age = machine_age
			}

			early_space_age = {
				remove_country_flag = early_space_age
				set_country_flag = atomic_age
				set_primitive_age = atomic_age
			}
		}
	}
}

human_fallen_empires_effect_up_primitive_teh_lvl = {
	owner = {
		switch = {
			trigger = has_country_flag

			stone_age = {
				remove_country_flag = stone_age
				set_country_flag = bronze_age
				set_primitive_age = bronze_age
			}

			bronze_age = {
				remove_country_flag = bronze_age
				set_country_flag = iron_age
				set_primitive_age = iron_age
			}

			iron_age = {
				remove_country_flag = iron_age
				set_country_flag = late_medieval_age
				set_primitive_age = late_medieval_age
			}

			late_medieval_age = {
				remove_country_flag = late_medieval_age
				set_country_flag = renaissance_age
				set_primitive_age = renaissance_age
			}

			renaissance_age = {
				remove_country_flag = renaissance_age
				set_country_flag = steam_age
				set_primitive_age = steam_age
			}

			steam_age = {
				remove_country_flag = steam_age
				set_country_flag = industrial_age
				set_primitive_age = industrial_age
			}

			industrial_age = {
				remove_country_flag = industrial_age
				set_country_flag = machine_age
				set_primitive_age = machine_age
			}

			machine_age = {
				remove_country_flag = machine_age
				set_country_flag =  atomic_age
				set_primitive_age =  atomic_age
			}

			atomic_age = {
				remove_country_flag = atomic_age
				set_country_flag = early_space_age
				set_primitive_age = early_space_age
			}

			early_space_age = {
				remove_country_flag = early_space_age
				set_country_type = default
				change_country_flag = random
				if = {
					limit = { is_species_class = MAM }
					set_graphical_culture = mammalian_01
				}
				if = {
					limit = { is_species_class = REP }
					set_graphical_culture = reptilian_01
				}
				if = {
					limit = { is_species_class = AVI }
					set_graphical_culture = avian_01
				}
				if = {
					limit = { is_species_class = ART }
					set_graphical_culture = arthropoid_01
				}
				if = {
					limit = { is_species_class = MOL }
					set_graphical_culture = molluscoid_01
				}
				if = {
					limit = { is_species_class = FUN }
					set_graphical_culture = fungoid_01
				}
				change_government = {
					authority = random
					civics = random
				}
				set_name = random
				if = {
					limit = {
						home_planet = {
							has_observation_outpost = yes
						}
					}
					home_planet = {
						observation_outpost_owner = {
							country_event = { id = primitive.17 }
						}
					}
				}
				add_minerals = 1000 # enough for a spaceport and then some
				add_energy = 500
				add_influence = 300
				capital_scope = {
					every_tile = {
						limit = {
							has_blocker = yes
							NOR = {
								has_blocker = tb_decrepit_dwellings
								has_blocker = tb_failing_infrastructure
							}
						}
						remove_blocker = yes
					}
					while = {
						limit = { num_pops < 8 }
						random_tile = {
							limit = {
								has_grown_pop = no
							}
							create_pop = {
								species = owner
							}
						}
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_mineral_food_deposit
						set_building = building_capital_2
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_mineral_deposit
						set_building = building_mining_network_1
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_mineral_deposit
						set_building = building_mining_network_1
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_farmland_deposit
						set_building = building_hydroponics_farm_1
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_farmland_deposit
						set_building = building_hydroponics_farm_1
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_energy_deposit
						set_building = building_power_plant_1
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_energy_deposit
						set_building = building_power_plant_1
					}
					random_tile = {
						limit = {
							has_pop = yes
							OR = {
								has_building = building_primitive_farm
								has_building = building_primitive_factory
								has_building = no
							}
						}
						clear_deposits = yes
						add_deposit = d_energy_deposit
						set_building = building_power_plant_1
					}
					remove_all_armies = yes
					create_army = {
						name = random
						owner = PREV
						species = owner_main_species
						type = defense_army
					}
					create_army = {
						name = random
						owner = PREV
						species = owner_main_species
						type = defense_army
					}
					create_army = {
						name = random
						owner = PREV
						species = owner_main_species
						type = defense_army
					}
					create_army = {
						name = random
						owner = PREV
						species = owner_main_species
						type = defense_army
					}
				}
				random_owned_ship = {
					limit = { is_ship_size = primitive_space_station }
					fleet = { destroy_fleet = THIS }
				}
			}
		}
	}
}

# for war in heavens
# for planet
human_fallen_empires_effect_create_primitive = {
	add_threat = {
		who = root
		amount = 1 # scales to pops
	}
	every_tile = {
		limit = {
			has_building = yes
		}
		remove_building = yes
	}
	owner.species = { save_event_target_as = human_fallen_empires_species }
	random_list = {
		# Industrial Civilization
		50 = {
			create_species = {
				name = random
				class = random
				portrait = random
				homeworld = THIS
				traits = {
					trait = random_traits
				}
			}
			create_country = {
				name = random
				authority = random
				civics = {
					civic = civic_increasing_urbanization
					civic = civic_atmospheric_pollution
				}
				species = last_created
				ethos = random
				flag = {
					icon = {
						category = "spherical"
						file = "flag_spherical_22.dds"
					}
					background= {
						category = "backgrounds"
						file = "new_dawn.dds"
					}
					colors={
						"turquoise"
						"green"
						"null"
						"null"
					}
				}
				type = primitive
			}
			last_created_country = {
				set_graphical_culture = industrial_01
				random_list = {
					25 = {
						set_country_flag = industrial_age
						set_primitive_age = industrial_age
					}
					25 = {
						set_country_flag = machine_age
						set_primitive_age = machine_age
					}
					25 = {
						set_country_flag = atomic_age
						set_primitive_age = atomic_age
					}
					25 = {
						set_country_flag = early_space_age
						set_primitive_age = early_space_age
					}
				}
			}
			set_owner = last_created_country
			set_controller = last_created_country
			while = {
				count = 3
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_grown_pop = no
					}
					set_blocker = tb_decrepit_dwellings
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_grown_pop = no
					}
					set_blocker = tb_failing_infrastructure
				}
			}
			while = {
				count = 5
				random_tile = {
					limit = {
						has_blocker = no
						has_grown_pop = no
						has_growing_pop = no
					}
					create_pop = {
						species = last_created
					}
				}
			}
			if = {
				limit = {
					last_created_country = {
						OR = {
							has_country_flag = machine_age
							has_country_flag = atomic_age
							has_country_flag = early_space_age
						}
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_grown_pop = no
						has_growing_pop = no
					}
					create_pop = {
						species = last_created
					}
				}
			}
			if = {
				limit = {
					last_created_country = {
						OR = {
							has_country_flag = machine_age
							has_country_flag = atomic_age
							has_country_flag = early_space_age
						}
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_factory"
				}
			}
			if = {
				limit = {
					last_created_country = {
						has_country_flag = early_space_age
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_grown_pop = no
						has_growing_pop = no
					}
					create_pop = {
						species = last_created
					}
				}
			}
			if = {
				limit = {
					last_created_country = {
						has_country_flag = early_space_age
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_factory"
				}
			}
			while = {
				count = 2
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_factory"
				}
			}
			while = {
				count = 4
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_farm"
				}
			}
			last_created_country = {
				if = {
					limit = { has_country_flag = industrial_age }
					PREV = {
						while = {
							count = 4
							create_army = {
								name = "Industrial Army"
								owner = last_created
								species = last_created
								type = "industrial_army"
							}
						}
					}
				}
				if = {
					limit = { has_country_flag = machine_age }
					PREV = {
						while = {
							count = 5
							create_army = {
								name = "Industrial Army"
								owner = last_created
								species = last_created
								type = "industrial_army"
							}
						}
					}
				}
				if = {
					limit = { has_country_flag = atomic_age }
					PREV = {
						while = {
							count = 4
							create_army = {
								name = "Post-Atomic Army"
								owner = last_created
								species = last_created
								type = "postatomic_army"
							}
						}
					}
				}
				if = {
					limit = { has_country_flag = early_space_age }
					PREV = {
						while = {
							count = 5
							create_army = {
								name = "Post-Atomic Army"
								owner = last_created
								species = last_created
								type = "postatomic_army"
							}
						}
						create_fleet = {
							name = "NAME_Space_Station"
							effect = {
								set_owner = last_created_country
								create_ship = {
									name = "NAME_Space_Station"
									design = "Space Station"
								}
								set_location = PREV
							}
						}
					}
				}
			}
		}
		# Medieval Civilization
		50 = {
			create_species = {
				name = random
				class = random
				portrait = random
				homeworld = THIS
				traits = {
					trait = random_traits
				}
			}
			create_country = {
				name = random
				authority = random
				civics = {
					civic = civic_landed_nobility
					civic = civic_flat_world_theory
				}
				species = last_created
				ethos = random
				flag = {
					icon = {
						category = "special"
						file = "primitive.dds"
					}
					background= {
						category = "backgrounds"
						file = "new_dawn.dds"
					}
					colors={
						"turquoise"
						"green"
						"null"
						"null"
					}
				}
				type = primitive
			}
			last_created_country = {
				set_graphical_culture = preindustrial_01
				random_list = {
					20 = {
						set_country_flag = stone_age
						set_primitive_age = stone_age
						change_government = {
							authority = random
							civics = {
								civic = civic_secret_of_fire
								civic = civic_the_wheel
							}
						}
					}
					20 = {
						set_country_flag = bronze_age
						set_primitive_age = bronze_age
						change_government = {
							authority = random
							civics = {
								civic = civic_secret_of_fire
								civic = civic_the_wheel
							}
						}
					}
					20 = {
						set_country_flag = iron_age
						set_primitive_age = iron_age
					}
					20 = {
						set_country_flag = late_medieval_age
						set_primitive_age = late_medieval_age
					}
					20 = {
						set_country_flag = renaissance_age
						set_primitive_age = renaissance_age
					}
					20 = {
						set_country_flag = steam_age
						set_primitive_age = steam_age
					}
				}
			}
			set_owner = last_created_country
			set_controller = last_created_country
			random_tile = {
				limit = {
					has_blocker = no
					has_grown_pop = no
					has_growing_pop = no
				}
				create_pop = {
					species = last_created
				}
			}
			if = {
				limit = {
					last_created_country = {
						OR = {
							has_country_flag = steam_age
							has_country_flag = renaissance_age
						}
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_grown_pop = no
						has_growing_pop = no
					}
					create_pop = {
						species = last_created
					}
				}
			}
			random_tile = {
				limit = { has_building = "building_colony_shelter" }
				remove_building = yes
			}
			while = {
				count = 2
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_farm"
				}
			}
			if = {
				limit = {
					last_created_country = {
						has_country_flag = stone_age
					}
				}
				every_tile = {
					limit = {
						has_building = "building_primitive_farm"
					}
					remove_building = yes
				}
			}
			if = {
				limit = {
					last_created_country = {
						OR = {
							has_country_flag = iron_age
							has_country_flag = late_medieval_age
							has_country_flag = renaissance_age
							has_country_flag = steam_age
						}
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_grown_pop = no
						has_growing_pop = no
					}
					create_pop = {
						species = last_created
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_farm"
				}
			}
			if = {
				limit = {
					last_created_country = {
						OR = {
							has_country_flag = steam_age
							has_country_flag = renaissance_age
						}
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_farm"
				}
			}
			if = {
				limit = {
					last_created_country = {
						has_country_flag = steam_age
					}
				}
				random_tile = {
					limit = {
						has_blocker = no
						has_building = no
						has_pop = yes
					}
					set_building = "building_primitive_factory"
				}
			}
			last_created_country = {
				if = {
					limit = { has_country_flag = stone_age }
					PREV = {
						create_army = {
							name = "Primitive Army"
							owner = last_created
							species = last_created
							type = "primitive_army"
						}
					}
				}
				if = {
					limit = { has_country_flag = bronze_age }
					PREV = {
						create_army = {
							name = "Primitive Army"
							owner = last_created
							species = last_created
							type = "primitive_army"
						}
					}
				}
				if = {
					limit = { has_country_flag = iron_age }
					PREV = {
						while = {
							count = 2
							create_army = {
								name = "Primitive Army"
								owner = last_created
								species = last_created
								type = "primitive_army"
							}
						}
					}
				}
				if = {
					limit = { has_country_flag = late_medieval_age }
					PREV = {
						while = {
							count = 3
							create_army = {
								name = "Primitive Army"
								owner = last_created
								species = last_created
								type = "primitive_army"
							}
						}
					}
				}
				if = {
					limit = { has_country_flag = renaissance_age }
					PREV = {
						while = {
							count = 4
							create_army = {
								name = "Primitive Army"
								owner = last_created
								species = last_created
								type = "primitive_army"
							}
						}
					}
				}
				if = {
					limit = { has_country_flag = steam_age }
					PREV = {
						while = {
							count = 3
							create_army = {
								name = "Industrial Army"
								owner = last_created
								species = last_created
								type = "industrial_army"
							}
						}
					}
				}
			}
		}
	}
	every_tile = {
		limit = {
			has_building = no
			exists = pop
		}
		kill_pop = yes
	}
	last_created_country = {
		every_owned_fleet = {
			destroy_fleet = this
		}
	}
	every_country = {
		establish_communications_no_message = last_created_country
	}
}

human_fallen_empires_effect_create_vassal = {
	add_threat = {
		who = root
		amount = 1 # scales to pops
	}
	if = {
		limit = {
			owner = {
				is_country = event_target:WarInHeavenLoserFE
			}
		}
		save_event_target_as = human_fallen_empires_planet
		if = {
			limit = {
				any_country = {
					has_country_flag = human_fallen_empires_liberated_country
					num_owned_planets < 4
				}
			}
			random_country = {
				limit = {
					has_country_flag = human_fallen_empires_liberated_country
					num_owned_planets < 64
				}
				event_target:human_fallen_empires_planet = {
					set_owner = prev
					set_controller = prev
				}
			}
			else = {
				create_country = {
					name = random
					authority = random
					civics = random
					released_by_country = root
					released_from_country = event_target:WarInHeavenLoserFE
					species = event_target:WarInHeavenLoserFE.species
					ethos = root
					flag = random
					type = default
					day_zero_contact = no
					effect = {
						set_timed_country_flag = { flag = human_fallen_empires_liberated_country days = 1 }
						establish_communications_no_message = root
						#establish_communications_no_message = fromfromfrom
						#establish_communications_no_message = parameter:planet.owner
						establish_contact = { who = root location = event_target:human_fallen_empires_planet }
						#establish_contact = { who = fromfromfrom location = parameter:planet }
						#establish_contact = { who = parameter:planet.owner location = parameter:planet }
						event_target:human_fallen_empires_planet = {
							set_owner = prev
							set_controller = prev
							solar_system = {
								every_system_planet = {
									limit = {
										exists = owner
										owner = {
											is_country = event_target:WarInHeavenLoserFE
										}
									}
									set_owner = prevprevprev
									set_controller = prevprevprev
								}
							}
						}
						if = {
							limit = {
								is_country_type = awakened_fallen_empire
							}
							if = {
								limit = {
									has_ethic = ethic_fanatic_spiritualist
								}
								set_subject_of = {
									who = root
									subject_type = dominion
								}
								else = {
									if = {
										limit = {
											has_ethic = ethic_fanatic_xenophile
										}
										set_subject_of = {
											who = root
											subject_type = signatory
										}
									}
								}
							}
							else = {
								if = {
									limit = {
										has_country_flag = human_fallen_empires_coalition_leader
									}
									set_subject_of = {
										who = root
										subject_type = human_fallen_empires_future_vassal
									}
									#country_remove_ethic = ethic_fanatic_militarist
									#country_add_ethic = ethic_militarist
									else = {
										set_subject_of = {
											who = root
											subject_type = vassal
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

# mutation event
# for pop
human_fallen_empires_effect_add_random_trait = {
	random_list = {
		1 = {
			modifier = {
				factor = 0
				pop_has_trait = trait_agrarian
			}
			modify_species = {
				species = this
				add_trait = trait_agrarian
			}
		}
		1 = {
			modifier = {
				factor = 0
				pop_has_trait = trait_thrifty
			}
			modify_species = {
				species = this
				add_trait = trait_thrifty
			}
		}
		1 = {
			modifier = {
				factor = 0
				pop_has_trait = trait_industrious
			}
			modify_species = {
				species = this
				add_trait = trait_industrious
			}
		}
		1 = {
			modifier = {
				factor = 0
				pop_has_trait = trait_intelligent
			}
			modify_species = {
				species = this
				add_trait = trait_intelligent
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_natural_engineers
					pop_has_trait = trait_natural_physicists
					pop_has_trait = trait_natural_sociologists
				}
			}
			modify_species = {
				species = this
				add_trait = trait_natural_engineers
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_natural_engineers
					pop_has_trait = trait_natural_physicists
					pop_has_trait = trait_natural_sociologists
				}
			}
			modify_species = {
				species = this
				add_trait = trait_natural_physicists
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_natural_engineers
					pop_has_trait = trait_natural_physicists
					pop_has_trait = trait_natural_sociologists
				}
			}
			modify_species = {
				species = this
				add_trait = trait_natural_sociologists
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_extremely_adaptive
					pop_has_trait = trait_adaptive
					pop_has_trait = trait_nonadaptive
				}
			}
			modify_species = {
				species = this
				add_trait = trait_extremely_adaptive
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_extremely_adaptive
					pop_has_trait = trait_adaptive
					pop_has_trait = trait_nonadaptive
				}
			}
			modify_species = {
				species = this
				add_trait = trait_adaptive
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_extremely_adaptive
					pop_has_trait = trait_adaptive
					pop_has_trait = trait_nonadaptive
				}
			}
			modify_species = {
				species = this
				add_trait = trait_nonadaptive
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_rapid_breeders
					pop_has_trait = trait_slow_breeders
				}
			}
			modify_species = {
				species = this
				add_trait = trait_rapid_breeders
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_rapid_breeders
					pop_has_trait = trait_slow_breeders
				}
			}
			modify_species = {
				species = this
				add_trait = trait_slow_breeders
			}
		}
		1 = {
			modifier = {
				factor = 0
				pop_has_trait = trait_talented
			}
			modify_species = {
				species = this
				add_trait = trait_talented
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_quick_learners
					pop_has_trait = trait_slow_learners
				}
			}
			modify_species = {
				species = this
				add_trait = trait_quick_learners
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_quick_learners
					pop_has_trait = trait_slow_learners
				}
			}
			modify_species = {
				species = this
				add_trait = trait_slow_learners
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_very_strong
					pop_has_trait = trait_strong
					pop_has_trait = trait_weak
				}
			}
			modify_species = {
				species = this
				add_trait = trait_very_strong
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_very_strong
					pop_has_trait = trait_strong
					pop_has_trait = trait_weak
				}
			}
			modify_species = {
				species = this
				add_trait = trait_strong
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_very_strong
					pop_has_trait = trait_strong
					pop_has_trait = trait_weak
				}
			}
			modify_species = {
				species = this
				add_trait = trait_weak
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_nomadic
					pop_has_trait = trait_sedentary
				}
			}
			modify_species = {
				species = this
				add_trait = trait_nomadic
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_nomadic
					pop_has_trait = trait_sedentary
				}
			}
			modify_species = {
				species = this
				add_trait = trait_sedentary
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_communal
					pop_has_trait = trait_solitary
				}
			}
			modify_species = {
				species = this
				add_trait = trait_communal
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_communal
					pop_has_trait = trait_solitary
				}
			}
			modify_species = {
				species = this
				add_trait = trait_solitary
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_charismatic
					pop_has_trait = trait_repugnant
				}
			}
			modify_species = {
				species = this
				add_trait = trait_charismatic
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_charismatic
					pop_has_trait = trait_repugnant
				}
			}
			modify_species = {
				species = this
				add_trait = trait_repugnant
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_conformists
					pop_has_trait = trait_deviants
				}
			}
			modify_species = {
				species = this
				add_trait = trait_conformists
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_conformists
					pop_has_trait = trait_deviants
				}
			}
			modify_species = {
				species = this
				add_trait = trait_deviants
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_venerable
					pop_has_trait = trait_enduring
					pop_has_trait = trait_fleeting
				}
			}
			modify_species = {
				species = this
				add_trait = trait_venerable
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_venerable
					pop_has_trait = trait_enduring
					pop_has_trait = trait_fleeting
				}
			}
			modify_species = {
				species = this
				add_trait = trait_enduring
			}
		}
		1 = {
			modifier = {
				factor = 0
				or = {
					pop_has_trait = trait_venerable
					pop_has_trait = trait_enduring
					pop_has_trait = trait_fleeting
				}
			}
			modify_species = {
				species = this
				add_trait = trait_fleeting
			}
		}
		1 = {
			modifier = {
				factor = 0
				pop_has_trait = trait_decadent
			}
			modify_species = {
				species = this
				add_trait = trait_decadent
			}
		}
		1 = {
			modifier = {
				factor = 0
				pop_has_trait = trait_resilient
			}
			modify_species = {
				species = this
				add_trait = trait_resilient
			}
		}
	}
}

# varelse fleen event
# for fleet
human_fallen_empires_effect_varelse_fleet_attack_home_of_light = {
	set_fleet_stance = aggressive
	clear_fleet_actions = this
	queue_actions = {
		find_closest_system = {
			trigger = {
				id = human_fallen_empires_effect_varelse_fleet_attack_home_of_light_trigger.0
				any_planet = {
					has_planet_flag = human_fallen_empires_home_of_light
				}
			}
			found_system = {
				move_to = this
				effect = {
					id = human_fallen_empires_effect_varelse_fleet_attack_home_of_light_effect.1
					if = {
						limit = {
							any_planet = {
								has_planet_flag = human_fallen_empires_home_of_light
								not = {
									and = {
										exists = owner
										owner = {
											has_country_flag = human_fallen_empires_egypt
										}
									}
								}
							}
						}
						event_target:human_fallen_empires_varelse_fleet = {
							human_fallen_empires_effect_varelse_fleet_find_new_home = yes
						}
						else = {
							event_target:human_fallen_empires_varelse_fleet = {
								owner = {
									set_faction_hostility = {
										set_hostile = yes
									}
								}
							}
						}
					}
				}
				find_closest_planet = {
					trigger = {
						id = human_fallen_empires_effect_varelse_fleet_attack_home_of_light_trigger.1
						has_planet_flag = human_fallen_empires_home_of_light
					}
					found_planet = {
						move_to = this
						repeat = {
							while = {
								id = human_fallen_empires.53.attact_trigger.2
								num_pops > 0
							}
							wait = {
								duration = 60
							}
						}
						effect = {
							id = human_fallen_empires_effect_varelse_fleet_attack_home_of_light_effect.2
							event_target:human_fallen_empires_varelse_fleet = {
								clear_fleet_actions = this
								human_fallen_empires_effect_varelse_fleet_find_new_home = yes
							}
						}
					}
				}
			}
			failed = {
				effect = {
					id = human_fallen_empires_effect_varelse_fleet_attack_home_of_light_effect.3
					event_target:human_fallen_empires_varelse_fleet = {
						clear_fleet_actions = this
						human_fallen_empires_effect_varelse_fleet_find_new_home = yes
					}
				}
			}
		}
	}
}

# for fleet
human_fallen_empires_effect_varelse_fleet_find_new_home = {
	clear_fleet_actions = this
	queue_actions = {
		find_closest_system = {
			trigger = {
				id = human_fallen_empires_find_new_home_trigger.0
				has_owner = no
				any_planet = {
					or = {
						is_planet_class = pc_gaia
						is_planet_class = pc_desert
					}
				}
			}
			found_system = {
				move_to = this
			}
			failed = {
				find_closest_system = {
					trigger = {
						id = human_fallen_empires_find_new_home_trigger.1
						any_planet = {
							has_owner = no
							or = {
								is_planet_class = pc_arid
								is_planet_class = pc_savannah
							}
						}
					}
					found_system = {
						move_to = this
					}
					failed = {
						find_closest_system = {
							trigger = {
								id = human_fallen_empires_find_new_home_trigger.2
								any_planet = {
									has_owner = no
									or = {
										is_planet_class = pc_tropical
										is_planet_class = pc_ocean
										is_planet_class = pc_tundra
										is_planet_class = pc_arctic
										is_planet_class = pc_continental
										is_planet_class = pc_alpine
									}
								}
							}
							found_system = {
								move_to = this
							}
							failed = {
								effect = {
									id = human_fallen_empires_find_new_home_effect.0
									human_fallen_empires_effect_varelse_fleet_attack_home_of_light = yes
								}
							}
						}
					}
				}
			}
		}
		find_closest_planet = {
			trigger = {
				id = human_fallen_empires_find_new_home_trigger.3
				has_owner = no
				or = {
					is_planet_class = pc_gaia
					is_planet_class = pc_desert
				}
			}
			found_planet = {
				move_to = this
				effect = {
					id = human_fallen_empires_find_new_home_effect.1
					create_country = {
						name = "Varelse Hegemony"
						type = default
						authority = random
						civics = random
						species = event_target:human_fallen_empires_varelse_species
						ethos = {
							ethic = ethic_xenophobe
							ethic = ethic_militarist
							ethic = ethic_materialist
						}
						flag = random
					}
					create_colony = {
						owner = last_created_country
						species = owner
						ethos = owner
					}
					event_target:human_fallen_empires_varelse_fleet = {
						set_owner = last_created_country
					}
				}
			}
			failed = {
				find_closest_planet = {
					trigger = {
						id = human_fallen_empires_find_new_home_trigger.4
						has_owner = no
						or = {
							is_planet_class = pc_arid
							is_planet_class = pc_savannah
						}
					}
					found_planet = {
						move_to = this
						effect = {
							id = human_fallen_empires_find_new_home_effect.2
							create_country = {
								name = "Varelse Hegemony"
								type = default
								authority = random
								civics = random
								species = event_target:human_fallen_empires_varelse_species
								ethos = {
									ethic = ethic_xenophobe
									ethic = ethic_militarist
									ethic = ethic_materialist
								}
								flag = random
							}
							create_colony = {
								owner = last_created_country
								species = owner
								ethos = owner
							}
							event_target:human_fallen_empires_varelse_fleet = {
								set_owner = last_created_country
							}
						}
					}
					failed = {
						find_closest_planet = {
							trigger = {
								id = human_fallen_empires_find_new_home_trigger.5
								has_owner = no
								or = {
									is_planet_class = pc_tropical
									is_planet_class = pc_ocean
									is_planet_class = pc_tundra
									is_planet_class = pc_arctic
									is_planet_class = pc_continental
									is_planet_class = pc_alpine
								}
							}
							found_planet = {
								move_to = this
								effect = {
									id = human_fallen_empires_find_new_home_effect.3
									create_country = {
										name = "Varelse Hegemony"
										type = default
										authority = random
										civics = random
										species = event_target:human_fallen_empires_varelse_species
										ethos = {
											ethic = ethic_xenophobe
											ethic = ethic_militarist
											ethic = ethic_materialist
										}
										flag = random
									}
									create_colony = {
										owner = last_created_country
										species = owner
										ethos = owner
									}
									event_target:human_fallen_empires_varelse_fleet = {
										set_owner = last_created_country
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

# for country return 6 event targets
human_fallen_empires_effect_save_event_target = {
	if = {
		limit = {
			not = {
				exists = event_target:human_fallen_empires_event_target_0
			}
		}
		save_event_target_as = human_fallen_empires_event_target_0
		else = {
			if = {
				limit = {
					nor = {
						is_same_value = event_target:human_fallen_empires_event_target_0
						exists = event_target:human_fallen_empires_event_target_1
					}
				}
				save_event_target_as = human_fallen_empires_event_target_1
				else = {
					if = {
						limit = {
							nor = {
								is_same_value = event_target:human_fallen_empires_event_target_0
								is_same_value = event_target:human_fallen_empires_event_target_1
								exists = event_target:human_fallen_empires_event_target_2
							}
						}
						save_event_target_as = human_fallen_empires_event_target_2
						else = {
							if = {
								limit = {
									nor = {
										is_same_value = event_target:human_fallen_empires_event_target_0
										is_same_value = event_target:human_fallen_empires_event_target_1
										is_same_value = event_target:human_fallen_empires_event_target_2
										exists = event_target:human_fallen_empires_event_target_3
									}
								}
								save_event_target_as = human_fallen_empires_event_target_3
								else = {
									if = {
										limit = {
											nor = {
												is_same_value = event_target:human_fallen_empires_event_target_0
												is_same_value = event_target:human_fallen_empires_event_target_1
												is_same_value = event_target:human_fallen_empires_event_target_2
												is_same_value = event_target:human_fallen_empires_event_target_3
												exists = event_target:human_fallen_empires_event_target_4
											}
										}
										save_event_target_as = human_fallen_empires_event_target_4
										else = {
											if = {
												limit = {
													nor = {
														is_same_value = event_target:human_fallen_empires_event_target_0
														is_same_value = event_target:human_fallen_empires_event_target_1
														is_same_value = event_target:human_fallen_empires_event_target_2
														is_same_value = event_target:human_fallen_empires_event_target_3
														is_same_value = event_target:human_fallen_empires_event_target_4
														exists = event_target:human_fallen_empires_event_target_5
													}
												}
												save_event_target_as = human_fallen_empires_event_target_5
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

human_fallen_empires_effect_clear_event_target = {
	clear_global_event_target = human_fallen_empires_event_target_0
	clear_global_event_target = human_fallen_empires_event_target_1
	clear_global_event_target = human_fallen_empires_event_target_2
	clear_global_event_target = human_fallen_empires_event_target_3
	clear_global_event_target = human_fallen_empires_event_target_4
	clear_global_event_target = human_fallen_empires_event_target_5
}

# drone
# for country
human_fallen_empires_effect_drone_calc_outpost = {
	remove_modifier = human_fallen_empires_drone_outpost_0
	remove_modifier = human_fallen_empires_drone_outpost_1
	remove_modifier = human_fallen_empires_drone_outpost_2
	remove_modifier = human_fallen_empires_drone_outpost_3
	remove_modifier = human_fallen_empires_drone_outpost_4
	remove_modifier = human_fallen_empires_drone_outpost_5
	remove_modifier = human_fallen_empires_drone_outpost_6
	remove_modifier = human_fallen_empires_drone_outpost_7
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value = 1
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_0
			days = -1
		}
	}
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value = 2
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_1
			days = -1
		}
	}
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value = 3
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_2
			days = -1
		}
	}
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value = 4
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_3
			days = -1
		}
	}
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value = 5
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_4
			days = -1
		}
	}
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value = 6
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_5
			days = -1
		}
	}
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value = 7
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_6
			days = -1
		}
	}
	if = {
		limit = {
			check_variable = {
				which = human_fallen_empires_drone_outpost
				value > 8
			}
		}
		add_modifier = {
			modifier = human_fallen_empires_drone_outpost_7
			days = -1
		}
	}
}

# total war cb, need 2 event targets
human_fallen_empires_effect_declare_total_war = {
	if = {
		limit = {
			not = {
				event_target:human_fallen_empires_war_attaker = {
					is_at_war_with = event_target:human_fallen_empires_war_defender
				}
			}
		}
		event_target:human_fallen_empires_war_attaker = {
			declare_war = {
				who = event_target:human_fallen_empires_war_defender
				major_war = yes
				name = "Total War"
			}
			add_war_demand = {
				type = total_defeat
				parameter:country = event_target:human_fallen_empires_war_defender
				warscore_cost = 100
				target = this
				enemy = event_target:human_fallen_empires_war_defender
			}
		}
		event_target:human_fallen_empires_war_defender = {
			add_war_demand = {
				type = total_defeat
				parameter:country = event_target:human_fallen_empires_war_attaker
				warscore_cost = 100
				target = this
				enemy = event_target:human_fallen_empires_war_attaker
			}
		}
	}
}

# rewards for dialogues and events, for country
human_fallen_empires_effect_add_unity.1 = {
	add_monthly_resource_mult = {
		resource = unity
		value = @tier1unityreward
		min = @tier1unitymin
		max = @tier1unitymax
	}
}

human_fallen_empires_effect_add_unity.2 = {
	add_monthly_resource_mult = {
		resource = unity
		value = @tier2unityreward
		min = @tier2unitymin
		max = @tier2unitymax
	}
}

human_fallen_empires_effect_add_unity.3 = {
	add_monthly_resource_mult = {
		resource = unity
		value = @tier3unityreward
		min = @tier3unitymin
		max = @tier3unitymax
	}
}

human_fallen_empires_effect_add_unity.4 = {
	add_monthly_resource_mult = {
		resource = unity
		value = @tier4unityreward
		min = @tier4unitymin
		max = @tier4unitymax
	}
}

human_fallen_empires_effect_add_unity.5 = {
	add_monthly_resource_mult = {
		resource = unity
		value = @tier5unityreward
		min = @tier5unitymin
		max = @tier5unitymax
	}
}

human_fallen_empires_effect_add_energy.1 = {
	add_monthly_resource_mult = {
		resource = energy
		value = @tier1materialreward
		min = @tier1materialmin
		max = @tier1materialmax
	}
}

human_fallen_empires_effect_add_energy.2 = {
	add_monthly_resource_mult = {
		resource = energy
		value = @tier2materialreward
		min = @tier2materialmin
		max = @tier2materialmax
	}
}

human_fallen_empires_effect_add_energy.3 = {
	add_monthly_resource_mult = {
		resource = energy
		value = @tier3materialreward
		min = @tier3materialmin
		max = @tier3materialmax
	}
}

human_fallen_empires_effect_add_energy.4 = {
	add_monthly_resource_mult = {
		resource = energy
		value = @tier4materialreward
		min = @tier4materialmin
		max = @tier4materialmax
	}
}

human_fallen_empires_effect_add_energy.5 = {
	add_monthly_resource_mult = {
		resource = energy
		value = @tier5materialreward
		min = @tier5materialmin
		max = @tier5materialmax
	}
}

human_fallen_empires_effect_add_minerals.1 = {
	add_monthly_resource_mult = {
		resource = minerals
		value = @tier1materialreward
		min = @tier1materialmin
		max = @tier1materialmax
	}
}

human_fallen_empires_effect_add_minerals.2 = {
	add_monthly_resource_mult = {
		resource = minerals
		value = @tier2materialreward
		min = @tier2materialmin
		max = @tier2materialmax
	}
}

human_fallen_empires_effect_add_minerals.3 = {
	add_monthly_resource_mult = {
		resource = minerals
		value = @tier3materialreward
		min = @tier3materialmin
		max = @tier3materialmax
	}
}

human_fallen_empires_effect_add_minerals.4 = {
	add_monthly_resource_mult = {
		resource = minerals
		value = @tier4materialreward
		min = @tier4materialmin
		max = @tier4materialmax
	}
}

human_fallen_empires_effect_add_minerals.5 = {
	add_monthly_resource_mult = {
		resource = minerals
		value = @tier5materialreward
		min = @tier5materialmin
		max = @tier5materialmax
	}
}

human_fallen_empires_effect_add_influence.1 = {
	add_monthly_resource_mult = {
		resource = influence
		value = @tier1influencereward
		min = @tier1influencemin
		max = @tier1influencemax
	}
}

human_fallen_empires_effect_add_influence.2 = {
	add_monthly_resource_mult = {
		resource = influence
		value = @tier2influencereward
		min = @tier2influencemin
		max = @tier2influencemax
	}
}

human_fallen_empires_effect_add_influence.3 = {
	add_monthly_resource_mult = {
		resource = influence
		value = @tier3influencereward
		min = @tier3influencemin
		max = @tier3influencemax
	}
}

human_fallen_empires_effect_add_influence.4 = {
	add_monthly_resource_mult = {
		resource = influence
		value = @tier4influencereward
		min = @tier4influencemin
		max = @tier4influencemax
	}
}

human_fallen_empires_effect_add_influence.5 = {
	add_monthly_resource_mult = {
		resource = influence
		value = @tier5influencereward
		min = @tier5influencemin
		max = @tier5influencemax
	}
}

human_fallen_empires_effect_add_physics_research.1 = {
	add_monthly_resource_mult = {
		resource = physics_research
		value = @tier1researchreward
		min = @tier1researchmin
		max = @tier1researchmax
	}
}

human_fallen_empires_effect_add_physics_research.2 = {
	add_monthly_resource_mult = {
		resource = physics_research
		value = @tier2researchreward
		min = @tier2researchmin
		max = @tier2researchmax
	}
}

human_fallen_empires_effect_add_physics_research.3 = {
	add_monthly_resource_mult = {
		resource = physics_research
		value = @tier3researchreward
		min = @tier3researchmin
		max = @tier3researchmax
	}
}

human_fallen_empires_effect_add_physics_research.4 = {
	add_monthly_resource_mult = {
		resource = physics_research
		value = @tier4researchreward
		min = @tier4researchmin
		max = @tier4researchmax
	}
}

human_fallen_empires_effect_add_physics_research.5 = {
	add_monthly_resource_mult = {
		resource = physics_research
		value = @tier5researchreward
		min = @tier5researchmin
		max = @tier5researchmax
	}
}

human_fallen_empires_effect_add_society_research.1 = {
	add_monthly_resource_mult = {
		resource = society_research
		value = @tier1researchreward
		min = @tier1researchmin
		max = @tier1researchmax
	}
}

human_fallen_empires_effect_add_society_research.2 = {
	add_monthly_resource_mult = {
		resource = society_research
		value = @tier2researchreward
		min = @tier2researchmin
		max = @tier2researchmax
	}
}

human_fallen_empires_effect_add_society_research.3 = {
	add_monthly_resource_mult = {
		resource = society_research
		value = @tier3researchreward
		min = @tier3researchmin
		max = @tier3researchmax
	}
}

human_fallen_empires_effect_add_society_research.4 = {
	add_monthly_resource_mult = {
		resource = society_research
		value = @tier4researchreward
		min = @tier4researchmin
		max = @tier4researchmax
	}
}

human_fallen_empires_effect_add_society_research.5 = {
	add_monthly_resource_mult = {
		resource = society_research
		value = @tier5researchreward
		min = @tier5researchmin
		max = @tier5researchmax
	}
}

human_fallen_empires_effect_add_engineering_research.1 = {
	add_monthly_resource_mult = {
		resource = engineering_research
		value = @tier1researchreward
		min = @tier1researchmin
		max = @tier1researchmax
	}
}

human_fallen_empires_effect_add_engineering_research.2 = {
	add_monthly_resource_mult = {
		resource = engineering_research
		value = @tier2researchreward
		min = @tier2researchmin
		max = @tier2researchmax
	}
}

human_fallen_empires_effect_add_engineering_research.3 = {
	add_monthly_resource_mult = {
		resource = engineering_research
		value = @tier3researchreward
		min = @tier3researchmin
		max = @tier3researchmax
	}
}

human_fallen_empires_effect_add_engineering_research.4 = {
	add_monthly_resource_mult = {
		resource = engineering_research
		value = @tier4researchreward
		min = @tier4researchmin
		max = @tier4researchmax
	}
}

human_fallen_empires_effect_add_engineering_research.5 = {
	add_monthly_resource_mult = {
		resource = engineering_research
		value = @tier5researchreward
		min = @tier5researchmin
		max = @tier5researchmax
	}
}

# for country need settle pop event target
human_fallen_empires_effect_settle_pop = {
	if = {
		limit = {
			any_owned_planet = {
				habitability = {
					who = event_target:human_fallen_empires_settle_pop_target
					value > 0.4
				}
				free_pop_tiles > 0
			}
		}
		random_owned_planet = {
			limit = {
				habitability = {
					who = event_target:human_fallen_empires_settle_pop_target
					value > 0.4
				}
				free_pop_tiles > 0
			}
			resettle_pop = {
				pop = event_target:human_fallen_empires_settle_pop_target
				planet = this
			}
		}
		else = {
			if = {
				limit = {
					any_owned_planet = {
						free_pop_tiles > 0
					}
				}
				random_owned_planet = {
					limit = {
						free_pop_tiles > 0
					}
					resettle_pop = {
						pop = event_target:human_fallen_empires_settle_pop_target
						planet = this
					}
				}
				else = {
					event_target:human_fallen_empires_settle_pop_target = {
						if = {
							limit = {
								is_valid_refugee_pop = yes
							}
							refugee_pop_effect = yes
							else = {
								kill_pop = yes
							}
						}
					}
				}
			}
		}
	}
}

# for country need settle pop event target, root saver country
human_fallen_empires_effect_settle_pop_from_slavery_buff = {
	event_target:human_fallen_empires_settle_pop_target = {
		if = {
			limit = {
				or = {
					has_citizenship_type = { country = root type = citizenship_full }
					has_citizenship_type = { country = root type = citizenship_limited }
					is_same_species = root
				}
			}
			add_modifier = {
				modifier = pop_saved_from_slavery
				days = 3650
			}
		}
	}
}

human_fallen_empires_effect_create_egypt_fleet = {
	event_target:human_fallen_empires_egypt_country = {
		create_leader = {
			type = admiral
			species = event_target:human_fallen_empires_egypt_species
			name = random
			skill = 1000
			traits = {
				trait = random_trait
				trait = random_trait
			}
		}
	}
	create_fleet = {
		effect = {
			set_owner = event_target:human_fallen_empires_egypt_country
			while = {
				count = 18
				create_ship = {
					name = random
					design = "Set"
					graphical_culture = "mammalian_01"
				}
			}
			while = {
				count = 32
				create_ship = {
					name = random
					design = "Inhert"
					graphical_culture = "mammalian_01"
				}
			}
			set_location = {
				target = event_target:human_fallen_empires_egypt_country.capital_scope
				distance = 90
				angle = random
			}
			assign_leader = last_created_leader
		}
	}
}

human_fallen_empires_effect_create_future_fleet = {
	event_target:human_fallen_empires_future_country = {
		create_leader = {
			type = admiral
			species = event_target:human_fallen_empires_future_species
			name = random
			skill = 1000
			traits = {
				trait = random_trait
				trait = random_trait
			}
		}
	}
	create_fleet = {
		effect = {
			set_owner = event_target:human_fallen_empires_future_country
			while = {
				count = 20
				create_ship = {
					name = random
					design = "Peacemaker"
					graphical_culture = "mammalian_01"
				}
			}
			while = {
				count = 60
				create_ship = {
					name = random
					design = "Peacekeeper"
					graphical_culture = "mammalian_01"
				}
			}
			set_location = {
				target = event_target:human_fallen_empires_future_country.capital_scope
				distance = 90
				angle = random
			}
			assign_leader = last_created_leader
		}
	}
}

human_fallen_empires_effect_authoritarian_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_authoritarian_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_authoritarian_attraction_middle
			}
			remove_modifier = human_fallen_empires_authoritarian_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_authoritarian_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_authoritarian_attraction_low
					}
					remove_modifier = human_fallen_empires_authoritarian_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_authoritarian_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_authoritarian_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}
human_fallen_empires_effect_egalitarian_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_egalitarian_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_egalitarian_attraction_middle
			}
			remove_modifier = human_fallen_empires_egalitarian_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_egalitarian_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_egalitarian_attraction_low
					}
					remove_modifier = human_fallen_empires_egalitarian_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_egalitarian_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_egalitarian_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}
human_fallen_empires_effect_xenophobe_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_xenophobe_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophobe_attraction_middle
			}
			remove_modifier = human_fallen_empires_xenophobe_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_xenophobe_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_xenophobe_attraction_low
					}
					remove_modifier = human_fallen_empires_xenophobe_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_xenophobe_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_xenophobe_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}
human_fallen_empires_effect_xenophile_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_xenophile_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophile_attraction_middle
			}
			remove_modifier = human_fallen_empires_xenophile_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_xenophile_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_xenophile_attraction_low
					}
					remove_modifier = human_fallen_empires_xenophile_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_xenophile_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_xenophile_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}
human_fallen_empires_effect_militarist_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_militarist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_militarist_attraction_middle
			}
			remove_modifier = human_fallen_empires_militarist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_militarist_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_militarist_attraction_low
					}
					remove_modifier = human_fallen_empires_militarist_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_militarist_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_militarist_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}
human_fallen_empires_effect_pacifist_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_pacifist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_pacifist_attraction_middle
			}
			remove_modifier = human_fallen_empires_pacifist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_pacifist_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_pacifist_attraction_low
					}
					remove_modifier = human_fallen_empires_pacifist_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_pacifist_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_pacifist_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}
human_fallen_empires_effect_spiritualist_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_spiritualist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_spiritualist_attraction_middle
			}
			remove_modifier = human_fallen_empires_spiritualist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_spiritualist_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_spiritualist_attraction_low
					}
					remove_modifier = human_fallen_empires_spiritualist_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_spiritualist_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_spiritualist_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}
human_fallen_empires_effect_materialist_attraction_low = {
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_materialist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_materialist_attraction_middle
			}
			remove_modifier = human_fallen_empires_materialist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_materialist_attraction_high
				days = 365
			}
			else = {
				if = {
					limit = {
						has_modifier = human_fallen_empires_materialist_attraction_low
					}
					remove_modifier = human_fallen_empires_materialist_attraction_low
					add_modifier = {
						modifier = human_fallen_empires_materialist_attraction_middle
						days = 365
					}
					else = {
						add_modifier = {
							modifier = human_fallen_empires_materialist_attraction_low
							days = 365
						}
					}
				}
			}
		}
	}
}

human_fallen_empires_effect_authoritarian_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_authoritarian_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_authoritarian_attraction_middle
			}
			remove_modifier = human_fallen_empires_authoritarian_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_authoritarian_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_authoritarian_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_authoritarian_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_authoritarian_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_authoritarian_attraction_low
			}
			remove_modifier = human_fallen_empires_authoritarian_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_authoritarian_attraction_middle
			}
			remove_modifier = human_fallen_empires_authoritarian_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_authoritarian_attraction_high
			days = 365
		}
	}
}

human_fallen_empires_effect_egalitarian_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_egalitarian_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_egalitarian_attraction_middle
			}
			remove_modifier = human_fallen_empires_egalitarian_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_egalitarian_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_egalitarian_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_egalitarian_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_egalitarian_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_egalitarian_attraction_low
			}
			remove_modifier = human_fallen_empires_egalitarian_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_egalitarian_attraction_middle
			}
			remove_modifier = human_fallen_empires_egalitarian_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_egalitarian_attraction_high
			days = 365
		}
	}
}

human_fallen_empires_effect_xenophobe_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_xenophobe_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophobe_attraction_middle
			}
			remove_modifier = human_fallen_empires_xenophobe_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_xenophobe_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_xenophobe_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_xenophobe_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_xenophobe_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophobe_attraction_low
			}
			remove_modifier = human_fallen_empires_xenophobe_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophobe_attraction_middle
			}
			remove_modifier = human_fallen_empires_xenophobe_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_xenophobe_attraction_high
			days = 365
		}
	}
}

human_fallen_empires_effect_xenophile_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_xenophile_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophile_attraction_middle
			}
			remove_modifier = human_fallen_empires_xenophile_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_xenophile_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_xenophile_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_xenophile_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_xenophile_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophile_attraction_low
			}
			remove_modifier = human_fallen_empires_xenophile_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_xenophile_attraction_middle
			}
			remove_modifier = human_fallen_empires_xenophile_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_xenophile_attraction_high
			days = 365
		}
	}
}

human_fallen_empires_effect_militarist_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_militarist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_militarist_attraction_middle
			}
			remove_modifier = human_fallen_empires_militarist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_militarist_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_militarist_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_militarist_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_militarist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_militarist_attraction_low
			}
			remove_modifier = human_fallen_empires_militarist_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_militarist_attraction_middle
			}
			remove_modifier = human_fallen_empires_militarist_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_militarist_attraction_high
			days = 365
		}
	}
}

human_fallen_empires_effect_pacifist_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_pacifist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_pacifist_attraction_middle
			}
			remove_modifier = human_fallen_empires_pacifist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_pacifist_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_pacifist_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_pacifist_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_pacifist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_pacifist_attraction_low
			}
			remove_modifier = human_fallen_empires_pacifist_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_pacifist_attraction_middle
			}
			remove_modifier = human_fallen_empires_pacifist_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_pacifist_attraction_high
			days = 365
		}
	}
}

human_fallen_empires_effect_spiritualist_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_spiritualist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_spiritualist_attraction_middle
			}
			remove_modifier = human_fallen_empires_spiritualist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_spiritualist_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_spiritualist_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_spiritualist_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_spiritualist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_spiritualist_attraction_low
			}
			remove_modifier = human_fallen_empires_spiritualist_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_spiritualist_attraction_middle
			}
			remove_modifier = human_fallen_empires_spiritualist_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_spiritualist_attraction_high
			days = 365
		}
	}
}

human_fallen_empires_effect_materialist_attraction_middle = {
	human_fallen_empires_effect_add_unity.3 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_materialist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_materialist_attraction_middle
			}
			remove_modifier = human_fallen_empires_materialist_attraction_middle
			add_modifier = {
				modifier = human_fallen_empires_materialist_attraction_high
				days = 365
			}
			else = {
				add_modifier = {
					modifier = human_fallen_empires_materialist_attraction_middle
					days = 365
				}
			}
		}
	}
}

human_fallen_empires_effect_materialist_attraction_high = {
	human_fallen_empires_effect_add_unity.5 = yes
	if = {
		limit = {
			not = {
				has_modifier = human_fallen_empires_materialist_attraction_high
			}
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_materialist_attraction_low
			}
			remove_modifier = human_fallen_empires_materialist_attraction_low
		}
		if = {
			limit = {
				has_modifier = human_fallen_empires_materialist_attraction_middle
			}
			remove_modifier = human_fallen_empires_materialist_attraction_middle
		}
		add_modifier = {
			modifier = human_fallen_empires_materialist_attraction_high
			days = 365
		}
	}
}

getname = {
	log = "[This.GetName]"
}

human_fallen_empires_effect_add_psionic_trait = {
	if = {
		limit = {
			nor = {
				has_trait = leader_trait_admiral_psionic
				has_trait = leader_trait_general_psionic
				has_trait = leader_trait_governor_psionic
				has_trait = leader_trait_scientist_psionic
				has_trait = leader_trait_ruler_psionic
				has_trait = leader_trait_admiral_chosen
				has_trait = leader_trait_general_chosen
				has_trait = leader_trait_governor_chosen
				has_trait = leader_trait_scientist_chosen
				has_trait = leader_trait_ruler_chosen
			}
		}
		if = {
			limit = { leader_class = admiral }
			add_trait = leader_trait_admiral_psionic
			add_ruler_trait = leader_trait_ruler_psionic
		}
		if = {
			limit = { leader_class = general }
			add_trait = leader_trait_general_psionic
			add_ruler_trait = leader_trait_ruler_psionic
		}
		if = {
			limit = { leader_class = governor }
			add_trait = leader_trait_governor_psionic
			add_ruler_trait = leader_trait_ruler_psionic
		}
		if = {
			limit = { leader_class = scientist }
			add_trait = leader_trait_scientist_psionic
			add_ruler_trait = leader_trait_ruler_psionic
		}
		if = {
			limit = { leader_class = ruler }
			add_trait = leader_trait_ruler_psionic
		}
	}
}
