#

# for country
human_fallen_empires_effect_discovery_diplomacy_remove_flags = {
	remove_country_flag = human_fallen_empires_discovery.151.1
	remove_country_flag = human_fallen_empires_discovery.151.2
	remove_country_flag = human_fallen_empires_discovery.151.3
	remove_country_flag = human_fallen_empires_discovery.151.4
	remove_country_flag = human_fallen_empires_discovery.151.crew_menu
	remove_country_flag = human_fallen_empires_discovery.151.contract_menu
}

# for country
human_fallen_empires_effect_discovery_clean_crew_modifier = {
	remove_modifier = human_fallen_empires_discovery_crew_1
	remove_modifier = human_fallen_empires_discovery_crew_2
	remove_modifier = human_fallen_empires_discovery_crew_3
	remove_modifier = human_fallen_empires_discovery_crew_4
}

human_fallen_empires_effect_discovery_diplomacy_start = {
	event_target:human_fallen_empires_discovery_owner = {
		random_owned_ship = {
			limit = {
				has_ship_flag = human_fallen_empires_discovery_ship
			}
			save_event_target_as = human_fallen_empires_discovery_docking_ship
		}
	}
	# embassy
	if = {
		limit = {
			event_target:human_fallen_empires_discovery_docking_planet = {
				has_planet_flag = human_fallen_empires_discovery_contract_embassy_target@event_target:human_fallen_empires_discovery_owner
			}
			#event_target:human_fallen_empires_discovery_owner = {
			#	has_event_chain = human_fallen_empires_discovery_contract_embassy
			#}
		}
		event_target:human_fallen_empires_discovery_docking_planet = {
			remove_planet_flag = human_fallen_empires_discovery_contract_embassy_target@event_target:human_fallen_empires_discovery_owner
		}
		event_target:human_fallen_empires_discovery_owner = {
			random_country = {
				limit = {
					has_country_flag = human_fallen_empires_discovery_contract_embassy_hirer@event_target:human_fallen_empires_discovery_owner
				}
				save_event_target_as = human_fallen_empires_discovery_contract_embassy_hirer
				add_energy = @human_fallen_empires_discovery_contract_embassy_reward_minus
				log = "embassy reward minus"
			}
			random_list = {
				1 = {
					set_timed_country_flag = { flag = human_fallen_empires_discovery_contract_embassy_success days = 1 }
					event_target:human_fallen_empires_discovery_contract_embassy_hirer = {
						add_opinion_modifier = {
							who = event_target:human_fallen_empires_discovery_docking_planet_owner
							modifier = human_fallen_empires_opinion_discovery_contract_embassy_success
						}
					}
					event_target:human_fallen_empires_discovery_docking_planet_owner = {
						add_opinion_modifier = {
							who = event_target:human_fallen_empires_discovery_contract_embassy_hirer
							modifier = human_fallen_empires_opinion_discovery_contract_embassy_success
						}
					}
				}
				1 = {
					set_timed_country_flag = { flag = human_fallen_empires_discovery_contract_embassy_fail days = 1 }
					event_target:human_fallen_empires_discovery_contract_embassy_hirer = {
						add_opinion_modifier = {
							who = event_target:human_fallen_empires_discovery_docking_planet_owner
							modifier = human_fallen_empires_opinion_discovery_contract_embassy_fail
						}
					}
					event_target:human_fallen_empires_discovery_docking_planet_owner = {
						add_opinion_modifier = {
							who = event_target:human_fallen_empires_discovery_contract_embassy_hirer
							modifier = human_fallen_empires_opinion_discovery_contract_embassy_fail
						}
					}
				}
			}
			end_event_chain = human_fallen_empires_discovery_contract_embassy
			add_energy = @human_fallen_empires_discovery_contract_embassy_reward
		}
	}
	# send menu event
	event_target:human_fallen_empires_discovery_owner = {
		country_event = { id = human_fallen_empires_discovery.151 }
	}
}
