
# exodus
hfe_decision_features_exodus = {
	owned_planets_only = yes
	sound = event_red_alert
	icon = decision_landing_ship
	resources = {
		category = decisions
		cost = {
			trigger = {
				num_pops < 10
			}
			consumer_goods = 100
		}
		cost = {
			trigger = {
				num_pops >= 10
				num_pops < 20
			}
			consumer_goods = 200
		}
		cost = {
			trigger = {
				num_pops >= 20
				num_pops < 30
			}
			consumer_goods = 300
		}
		cost = {
			trigger = {
				num_pops >= 30
				num_pops < 40
			}
			consumer_goods = 400
		}
		cost = {
			trigger = {
				num_pops >= 40
				num_pops < 50
			}
			consumer_goods = 500
		}
		cost = {
			trigger = {
				num_pops >= 50
				num_pops < 60
			}
			consumer_goods = 600
		}
		cost = {
			trigger = {
				num_pops >= 60
				num_pops < 70
			}
			consumer_goods = 700
		}
		cost = {
			trigger = {
				num_pops >= 70
				num_pops < 85
			}
			consumer_goods = 800
		}
		cost = {
			trigger = {
				num_pops >= 85
				num_pops < 100
			}
			consumer_goods = 900
		}
		cost = {
			trigger = {
				num_pops >= 100
			}
			consumer_goods = 1000
		}
	}
	prerequisites = {
		hfe_tech_features_exodus
	}
	allow = {
		exists = owner
		owner = {
			is_ai = no
			num_owned_planets = 1
			NOT = { num_owned_planets = 2 } # The Exodus is an emergency to deliver an OPM from death
		}
	}
	effect = {
		owner = {
			set_country_flag = chosen_to_exodus
			set_country_flag = is_government_in_exile # Used to check if a country is currently undergoing the Exodus
			set_country_flag = was_government_in_exile # Used to calculate flavor and special features once the Exodus ends
		}
		owner = {
			set_country_type = hfe_features_exodus
		}
		hidden_effect = {
			owner = {
				add_modifier = {
					modifier = tsp_hfe_features_exodus_game_over_prevention
					days = -1
				}
			}
		}
		hidden_effect = {
			every_owned_pop = {
				owner = {
					change_variable = {
						which = hfe_features_exodus_pop
						value = 1
					}
					add_resource = {
						energy = 50
						minerals = 50
						alloys = 25
						influence = 1000
					}
				}
				kill_pop = yes
			}
		}
		create_fleet = {
			effect = {
				set_owner = root.owner
				create_ship = {
					name = "New Hope"
					random_existing_design = colonizer
				}
				set_location = root
			}
		}

		set_planet_flag = exodus_happened_here
		hfe_effect_clear_buildings_and_destroy_colony = yes
	}
	ai_weight = {
		weight = 0
	}
}
